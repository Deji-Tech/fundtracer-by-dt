const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/features-DnZOhIfr.js","assets/wagmi-DcZqQoR7.js","assets/embedded-wallet-BAgYpYsg.js","assets/index-B08Z505Y.js","assets/vendor-DlsDZ-Ab.js","assets/firebase-CQEMoNG2.js","assets/index-C1TQLxJO.css","assets/email-BQ9Y9oEp.js","assets/index-Ca79JOpa.js","assets/socials-DK-Ok6GK.js","assets/swaps-cVhc2WJQ.js","assets/index-BthGtG4v.js","assets/send-D1OYHajq.js","assets/index-BpDsoN8i.js","assets/receive-vNm6C3MY.js","assets/onramp-BetThFTt.js","assets/pay-with-exchange-DzzdRWgZ.js","assets/transactions-D2tFYUel.js","assets/index-Bk5rgs9c.js","assets/index-DCu76pon.js","assets/data-capture-DIzcF0nK.js","assets/w3m-modal-uoSzwKP3.js","assets/index-CbJO_9Dw.js"])))=>i.map(i=>d[i]);
import{g as zo,c as wu,f as kf,_ as Xt,e as jc,a as Jw,b as Fp,h as Wc,t as Oa,d as Ov,i as Xo,j as Rv,k as kv,l as Pv,s as Dv,m as Uv,n as $v,o as jp,I as Wp,p as Un,A as Bv,q as fh,r as Lv,u as Mv,v as Fv,w as jv,x as Wv,y as Xw,z as Qw,S as ph,P as Hp,C as Hv,U as Ra,B as Ju,D as qv,E as zv,F as Vv,G as Kv,H as Gv,J as Yv,K as Zv,L as Jv,M as Xv,N as Qv,O as e_,Q as t_,R as n_,T as Xu,V as As,W as Qu,X as qp,Y as r_,Z as zp,$ as s_}from"./wagmi-DcZqQoR7.js";var i_={},Eu={};Eu.byteLength=c_;Eu.toByteArray=u_;Eu.fromByteArray=f_;var Lr=[],rr=[],o_=typeof Uint8Array<"u"?Uint8Array:Array,ed="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var io=0,a_=ed.length;io<a_;++io)Lr[io]=ed[io],rr[ed.charCodeAt(io)]=io;rr[45]=62;rr[95]=63;function e0(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function c_(t){var e=e0(t),n=e[0],r=e[1];return(n+r)*3/4-r}function l_(t,e,n){return(e+n)*3/4-n}function u_(t){var e,n=e0(t),r=n[0],s=n[1],i=new o_(l_(t,r,s)),o=0,a=s>0?r-4:r,c;for(c=0;c<a;c+=4)e=rr[t.charCodeAt(c)]<<18|rr[t.charCodeAt(c+1)]<<12|rr[t.charCodeAt(c+2)]<<6|rr[t.charCodeAt(c+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return s===2&&(e=rr[t.charCodeAt(c)]<<2|rr[t.charCodeAt(c+1)]>>4,i[o++]=e&255),s===1&&(e=rr[t.charCodeAt(c)]<<10|rr[t.charCodeAt(c+1)]<<4|rr[t.charCodeAt(c+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function d_(t){return Lr[t>>18&63]+Lr[t>>12&63]+Lr[t>>6&63]+Lr[t&63]}function h_(t,e,n){for(var r,s=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(d_(r));return s.join("")}function f_(t){for(var e,n=t.length,r=n%3,s=[],i=16383,o=0,a=n-r;o<a;o+=i)s.push(h_(t,o,o+i>a?a:o+i));return r===1?(e=t[n-1],s.push(Lr[e>>2]+Lr[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],s.push(Lr[e>>10]+Lr[e>>4&63]+Lr[e<<2&63]+"=")),s.join("")}var Pf={};Pf.read=function(t,e,n,r,s){var i,o,a=s*8-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?s-1:0,h=n?-1:1,p=t[e+d];for(d+=h,i=p&(1<<-u)-1,p>>=-u,u+=a;u>0;i=i*256+t[e+d],d+=h,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=r;u>0;o=o*256+t[e+d],d+=h,u-=8);if(i===0)i=1-l;else{if(i===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,r),i=i-l}return(p?-1:1)*o*Math.pow(2,i-r)};Pf.write=function(t,e,n,r,s,i){var o,a,c,l=i*8-s-1,u=(1<<l)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,m=r?1:-1,w=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,s),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[n+p]=a&255,p+=m,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[n+p]=o&255,p+=m,o/=256,l-=8);t[n+p-m]|=w*128};(function(t){const e=Eu,n=Pf,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=k,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const _=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(_,f),_.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(_){if(_>s)throw new RangeError('The value "'+_+'" is invalid for option "size"');const f=new Uint8Array(_);return Object.setPrototypeOf(f,a.prototype),f}function a(_,f,g){if(typeof _=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(_)}return c(_,f,g)}a.poolSize=8192;function c(_,f,g){if(typeof _=="string")return h(_,f);if(ArrayBuffer.isView(_))return m(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(Mn(_,ArrayBuffer)||_&&Mn(_.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Mn(_,SharedArrayBuffer)||_&&Mn(_.buffer,SharedArrayBuffer)))return w(_,f,g);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const I=_.valueOf&&_.valueOf();if(I!=null&&I!==_)return a.from(I,f,g);const B=b(_);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return a.from(_[Symbol.toPrimitive]("string"),f,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}a.from=function(_,f,g){return c(_,f,g)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function u(_,f,g){return l(_),_<=0?o(_):f!==void 0?typeof g=="string"?o(_).fill(f,g):o(_).fill(f):o(_)}a.alloc=function(_,f,g){return u(_,f,g)};function d(_){return l(_),o(_<0?0:R(_)|0)}a.allocUnsafe=function(_){return d(_)},a.allocUnsafeSlow=function(_){return d(_)};function h(_,f){if((typeof f!="string"||f==="")&&(f="utf8"),!a.isEncoding(f))throw new TypeError("Unknown encoding: "+f);const g=S(_,f)|0;let I=o(g);const B=I.write(_,f);return B!==g&&(I=I.slice(0,B)),I}function p(_){const f=_.length<0?0:R(_.length)|0,g=o(f);for(let I=0;I<f;I+=1)g[I]=_[I]&255;return g}function m(_){if(Mn(_,Uint8Array)){const f=new Uint8Array(_);return w(f.buffer,f.byteOffset,f.byteLength)}return p(_)}function w(_,f,g){if(f<0||_.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<f+(g||0))throw new RangeError('"length" is outside of buffer bounds');let I;return f===void 0&&g===void 0?I=new Uint8Array(_):g===void 0?I=new Uint8Array(_,f):I=new Uint8Array(_,f,g),Object.setPrototypeOf(I,a.prototype),I}function b(_){if(a.isBuffer(_)){const f=R(_.length)|0,g=o(f);return g.length===0||_.copy(g,0,0,f),g}if(_.length!==void 0)return typeof _.length!="number"||so(_.length)?o(0):p(_);if(_.type==="Buffer"&&Array.isArray(_.data))return p(_.data)}function R(_){if(_>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return _|0}function k(_){return+_!=_&&(_=0),a.alloc(+_)}a.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==a.prototype},a.compare=function(f,g){if(Mn(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),Mn(g,Uint8Array)&&(g=a.from(g,g.offset,g.byteLength)),!a.isBuffer(f)||!a.isBuffer(g))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===g)return 0;let I=f.length,B=g.length;for(let z=0,X=Math.min(I,B);z<X;++z)if(f[z]!==g[z]){I=f[z],B=g[z];break}return I<B?-1:B<I?1:0},a.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(f,g){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return a.alloc(0);let I;if(g===void 0)for(g=0,I=0;I<f.length;++I)g+=f[I].length;const B=a.allocUnsafe(g);let z=0;for(I=0;I<f.length;++I){let X=f[I];if(Mn(X,Uint8Array))z+X.length>B.length?(a.isBuffer(X)||(X=a.from(X)),X.copy(B,z)):Uint8Array.prototype.set.call(B,X,z);else if(a.isBuffer(X))X.copy(B,z);else throw new TypeError('"list" argument must be an Array of Buffers');z+=X.length}return B};function S(_,f){if(a.isBuffer(_))return _.length;if(ArrayBuffer.isView(_)||Mn(_,ArrayBuffer))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const g=_.length,I=arguments.length>2&&arguments[2]===!0;if(!I&&g===0)return 0;let B=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return Zo(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return Jo(_).length;default:if(B)return I?-1:Zo(_).length;f=(""+f).toLowerCase(),B=!0}}a.byteLength=S;function O(_,f,g){let I=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,f>>>=0,g<=f))return"";for(_||(_="utf8");;)switch(_){case"hex":return T(this,f,g);case"utf8":case"utf-8":return P(this,f,g);case"ascii":return A(this,f,g);case"latin1":case"binary":return N(this,f,g);case"base64":return D(this,f,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,f,g);default:if(I)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),I=!0}}a.prototype._isBuffer=!0;function U(_,f,g){const I=_[f];_[f]=_[g],_[g]=I}a.prototype.swap16=function(){const f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let g=0;g<f;g+=2)U(this,g,g+1);return this},a.prototype.swap32=function(){const f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let g=0;g<f;g+=4)U(this,g,g+3),U(this,g+1,g+2);return this},a.prototype.swap64=function(){const f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let g=0;g<f;g+=8)U(this,g,g+7),U(this,g+1,g+6),U(this,g+2,g+5),U(this,g+3,g+4);return this},a.prototype.toString=function(){const f=this.length;return f===0?"":arguments.length===0?P(this,0,f):O.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(f){if(!a.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:a.compare(this,f)===0},a.prototype.inspect=function(){let f="";const g=t.INSPECT_MAX_BYTES;return f=this.toString("hex",0,g).replace(/(.{2})/g,"$1 ").trim(),this.length>g&&(f+=" ... "),"<Buffer "+f+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(f,g,I,B,z){if(Mn(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),!a.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(g===void 0&&(g=0),I===void 0&&(I=f?f.length:0),B===void 0&&(B=0),z===void 0&&(z=this.length),g<0||I>f.length||B<0||z>this.length)throw new RangeError("out of range index");if(B>=z&&g>=I)return 0;if(B>=z)return-1;if(g>=I)return 1;if(g>>>=0,I>>>=0,B>>>=0,z>>>=0,this===f)return 0;let X=z-B,Fe=I-g;const vt=Math.min(X,Fe),ht=this.slice(B,z),_t=f.slice(g,I);for(let at=0;at<vt;++at)if(ht[at]!==_t[at]){X=ht[at],Fe=_t[at];break}return X<Fe?-1:Fe<X?1:0};function F(_,f,g,I,B){if(_.length===0)return-1;if(typeof g=="string"?(I=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,so(g)&&(g=B?0:_.length-1),g<0&&(g=_.length+g),g>=_.length){if(B)return-1;g=_.length-1}else if(g<0)if(B)g=0;else return-1;if(typeof f=="string"&&(f=a.from(f,I)),a.isBuffer(f))return f.length===0?-1:q(_,f,g,I,B);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(_,f,g):Uint8Array.prototype.lastIndexOf.call(_,f,g):q(_,[f],g,I,B);throw new TypeError("val must be string, number or Buffer")}function q(_,f,g,I,B){let z=1,X=_.length,Fe=f.length;if(I!==void 0&&(I=String(I).toLowerCase(),I==="ucs2"||I==="ucs-2"||I==="utf16le"||I==="utf-16le")){if(_.length<2||f.length<2)return-1;z=2,X/=2,Fe/=2,g/=2}function vt(_t,at){return z===1?_t[at]:_t.readUInt16BE(at*z)}let ht;if(B){let _t=-1;for(ht=g;ht<X;ht++)if(vt(_,ht)===vt(f,_t===-1?0:ht-_t)){if(_t===-1&&(_t=ht),ht-_t+1===Fe)return _t*z}else _t!==-1&&(ht-=ht-_t),_t=-1}else for(g+Fe>X&&(g=X-Fe),ht=g;ht>=0;ht--){let _t=!0;for(let at=0;at<Fe;at++)if(vt(_,ht+at)!==vt(f,at)){_t=!1;break}if(_t)return ht}return-1}a.prototype.includes=function(f,g,I){return this.indexOf(f,g,I)!==-1},a.prototype.indexOf=function(f,g,I){return F(this,f,g,I,!0)},a.prototype.lastIndexOf=function(f,g,I){return F(this,f,g,I,!1)};function V(_,f,g,I){g=Number(g)||0;const B=_.length-g;I?(I=Number(I),I>B&&(I=B)):I=B;const z=f.length;I>z/2&&(I=z/2);let X;for(X=0;X<I;++X){const Fe=parseInt(f.substr(X*2,2),16);if(so(Fe))return X;_[g+X]=Fe}return X}function L(_,f,g,I){return _s(Zo(f,_.length-g),_,g,I)}function Y(_,f,g,I){return _s(Zu(f),_,g,I)}function G(_,f,g,I){return _s(Jo(f),_,g,I)}function W(_,f,g,I){return _s(Lc(f,_.length-g),_,g,I)}a.prototype.write=function(f,g,I,B){if(g===void 0)B="utf8",I=this.length,g=0;else if(I===void 0&&typeof g=="string")B=g,I=this.length,g=0;else if(isFinite(g))g=g>>>0,isFinite(I)?(I=I>>>0,B===void 0&&(B="utf8")):(B=I,I=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const z=this.length-g;if((I===void 0||I>z)&&(I=z),f.length>0&&(I<0||g<0)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");let X=!1;for(;;)switch(B){case"hex":return V(this,f,g,I);case"utf8":case"utf-8":return L(this,f,g,I);case"ascii":case"latin1":case"binary":return Y(this,f,g,I);case"base64":return G(this,f,g,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,f,g,I);default:if(X)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),X=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function D(_,f,g){return f===0&&g===_.length?e.fromByteArray(_):e.fromByteArray(_.slice(f,g))}function P(_,f,g){g=Math.min(_.length,g);const I=[];let B=f;for(;B<g;){const z=_[B];let X=null,Fe=z>239?4:z>223?3:z>191?2:1;if(B+Fe<=g){let vt,ht,_t,at;switch(Fe){case 1:z<128&&(X=z);break;case 2:vt=_[B+1],(vt&192)===128&&(at=(z&31)<<6|vt&63,at>127&&(X=at));break;case 3:vt=_[B+1],ht=_[B+2],(vt&192)===128&&(ht&192)===128&&(at=(z&15)<<12|(vt&63)<<6|ht&63,at>2047&&(at<55296||at>57343)&&(X=at));break;case 4:vt=_[B+1],ht=_[B+2],_t=_[B+3],(vt&192)===128&&(ht&192)===128&&(_t&192)===128&&(at=(z&15)<<18|(vt&63)<<12|(ht&63)<<6|_t&63,at>65535&&at<1114112&&(X=at))}}X===null?(X=65533,Fe=1):X>65535&&(X-=65536,I.push(X>>>10&1023|55296),X=56320|X&1023),I.push(X),B+=Fe}return E(I)}const y=4096;function E(_){const f=_.length;if(f<=y)return String.fromCharCode.apply(String,_);let g="",I=0;for(;I<f;)g+=String.fromCharCode.apply(String,_.slice(I,I+=y));return g}function A(_,f,g){let I="";g=Math.min(_.length,g);for(let B=f;B<g;++B)I+=String.fromCharCode(_[B]&127);return I}function N(_,f,g){let I="";g=Math.min(_.length,g);for(let B=f;B<g;++B)I+=String.fromCharCode(_[B]);return I}function T(_,f,g){const I=_.length;(!f||f<0)&&(f=0),(!g||g<0||g>I)&&(g=I);let B="";for(let z=f;z<g;++z)B+=Mc[_[z]];return B}function x(_,f,g){const I=_.slice(f,g);let B="";for(let z=0;z<I.length-1;z+=2)B+=String.fromCharCode(I[z]+I[z+1]*256);return B}a.prototype.slice=function(f,g){const I=this.length;f=~~f,g=g===void 0?I:~~g,f<0?(f+=I,f<0&&(f=0)):f>I&&(f=I),g<0?(g+=I,g<0&&(g=0)):g>I&&(g=I),g<f&&(g=f);const B=this.subarray(f,g);return Object.setPrototypeOf(B,a.prototype),B};function M(_,f,g){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+f>g)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(f,g,I){f=f>>>0,g=g>>>0,I||M(f,g,this.length);let B=this[f],z=1,X=0;for(;++X<g&&(z*=256);)B+=this[f+X]*z;return B},a.prototype.readUintBE=a.prototype.readUIntBE=function(f,g,I){f=f>>>0,g=g>>>0,I||M(f,g,this.length);let B=this[f+--g],z=1;for(;g>0&&(z*=256);)B+=this[f+--g]*z;return B},a.prototype.readUint8=a.prototype.readUInt8=function(f,g){return f=f>>>0,g||M(f,1,this.length),this[f]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(f,g){return f=f>>>0,g||M(f,2,this.length),this[f]|this[f+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(f,g){return f=f>>>0,g||M(f,2,this.length),this[f]<<8|this[f+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(f,g){return f=f>>>0,g||M(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(f,g){return f=f>>>0,g||M(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},a.prototype.readBigUInt64LE=ur(function(f){f=f>>>0,Qe(f,"offset");const g=this[f],I=this[f+7];(g===void 0||I===void 0)&&Tt(f,this.length-8);const B=g+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24,z=this[++f]+this[++f]*2**8+this[++f]*2**16+I*2**24;return BigInt(B)+(BigInt(z)<<BigInt(32))}),a.prototype.readBigUInt64BE=ur(function(f){f=f>>>0,Qe(f,"offset");const g=this[f],I=this[f+7];(g===void 0||I===void 0)&&Tt(f,this.length-8);const B=g*2**24+this[++f]*2**16+this[++f]*2**8+this[++f],z=this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+I;return(BigInt(B)<<BigInt(32))+BigInt(z)}),a.prototype.readIntLE=function(f,g,I){f=f>>>0,g=g>>>0,I||M(f,g,this.length);let B=this[f],z=1,X=0;for(;++X<g&&(z*=256);)B+=this[f+X]*z;return z*=128,B>=z&&(B-=Math.pow(2,8*g)),B},a.prototype.readIntBE=function(f,g,I){f=f>>>0,g=g>>>0,I||M(f,g,this.length);let B=g,z=1,X=this[f+--B];for(;B>0&&(z*=256);)X+=this[f+--B]*z;return z*=128,X>=z&&(X-=Math.pow(2,8*g)),X},a.prototype.readInt8=function(f,g){return f=f>>>0,g||M(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},a.prototype.readInt16LE=function(f,g){f=f>>>0,g||M(f,2,this.length);const I=this[f]|this[f+1]<<8;return I&32768?I|4294901760:I},a.prototype.readInt16BE=function(f,g){f=f>>>0,g||M(f,2,this.length);const I=this[f+1]|this[f]<<8;return I&32768?I|4294901760:I},a.prototype.readInt32LE=function(f,g){return f=f>>>0,g||M(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},a.prototype.readInt32BE=function(f,g){return f=f>>>0,g||M(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},a.prototype.readBigInt64LE=ur(function(f){f=f>>>0,Qe(f,"offset");const g=this[f],I=this[f+7];(g===void 0||I===void 0)&&Tt(f,this.length-8);const B=this[f+4]+this[f+5]*2**8+this[f+6]*2**16+(I<<24);return(BigInt(B)<<BigInt(32))+BigInt(g+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24)}),a.prototype.readBigInt64BE=ur(function(f){f=f>>>0,Qe(f,"offset");const g=this[f],I=this[f+7];(g===void 0||I===void 0)&&Tt(f,this.length-8);const B=(g<<24)+this[++f]*2**16+this[++f]*2**8+this[++f];return(BigInt(B)<<BigInt(32))+BigInt(this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+I)}),a.prototype.readFloatLE=function(f,g){return f=f>>>0,g||M(f,4,this.length),n.read(this,f,!0,23,4)},a.prototype.readFloatBE=function(f,g){return f=f>>>0,g||M(f,4,this.length),n.read(this,f,!1,23,4)},a.prototype.readDoubleLE=function(f,g){return f=f>>>0,g||M(f,8,this.length),n.read(this,f,!0,52,8)},a.prototype.readDoubleBE=function(f,g){return f=f>>>0,g||M(f,8,this.length),n.read(this,f,!1,52,8)};function H(_,f,g,I,B,z){if(!a.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>B||f<z)throw new RangeError('"value" argument is out of bounds');if(g+I>_.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(f,g,I,B){if(f=+f,g=g>>>0,I=I>>>0,!B){const Fe=Math.pow(2,8*I)-1;H(this,f,g,I,Fe,0)}let z=1,X=0;for(this[g]=f&255;++X<I&&(z*=256);)this[g+X]=f/z&255;return g+I},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(f,g,I,B){if(f=+f,g=g>>>0,I=I>>>0,!B){const Fe=Math.pow(2,8*I)-1;H(this,f,g,I,Fe,0)}let z=I-1,X=1;for(this[g+z]=f&255;--z>=0&&(X*=256);)this[g+z]=f/X&255;return g+I},a.prototype.writeUint8=a.prototype.writeUInt8=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,1,255,0),this[g]=f&255,g+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,2,65535,0),this[g]=f&255,this[g+1]=f>>>8,g+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,2,65535,0),this[g]=f>>>8,this[g+1]=f&255,g+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,4,4294967295,0),this[g+3]=f>>>24,this[g+2]=f>>>16,this[g+1]=f>>>8,this[g]=f&255,g+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,4,4294967295,0),this[g]=f>>>24,this[g+1]=f>>>16,this[g+2]=f>>>8,this[g+3]=f&255,g+4};function ne(_,f,g,I,B){st(f,I,B,_,g,7);let z=Number(f&BigInt(4294967295));_[g++]=z,z=z>>8,_[g++]=z,z=z>>8,_[g++]=z,z=z>>8,_[g++]=z;let X=Number(f>>BigInt(32)&BigInt(4294967295));return _[g++]=X,X=X>>8,_[g++]=X,X=X>>8,_[g++]=X,X=X>>8,_[g++]=X,g}function Z(_,f,g,I,B){st(f,I,B,_,g,7);let z=Number(f&BigInt(4294967295));_[g+7]=z,z=z>>8,_[g+6]=z,z=z>>8,_[g+5]=z,z=z>>8,_[g+4]=z;let X=Number(f>>BigInt(32)&BigInt(4294967295));return _[g+3]=X,X=X>>8,_[g+2]=X,X=X>>8,_[g+1]=X,X=X>>8,_[g]=X,g+8}a.prototype.writeBigUInt64LE=ur(function(f,g=0){return ne(this,f,g,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=ur(function(f,g=0){return Z(this,f,g,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(f,g,I,B){if(f=+f,g=g>>>0,!B){const vt=Math.pow(2,8*I-1);H(this,f,g,I,vt-1,-vt)}let z=0,X=1,Fe=0;for(this[g]=f&255;++z<I&&(X*=256);)f<0&&Fe===0&&this[g+z-1]!==0&&(Fe=1),this[g+z]=(f/X>>0)-Fe&255;return g+I},a.prototype.writeIntBE=function(f,g,I,B){if(f=+f,g=g>>>0,!B){const vt=Math.pow(2,8*I-1);H(this,f,g,I,vt-1,-vt)}let z=I-1,X=1,Fe=0;for(this[g+z]=f&255;--z>=0&&(X*=256);)f<0&&Fe===0&&this[g+z+1]!==0&&(Fe=1),this[g+z]=(f/X>>0)-Fe&255;return g+I},a.prototype.writeInt8=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,1,127,-128),f<0&&(f=255+f+1),this[g]=f&255,g+1},a.prototype.writeInt16LE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,2,32767,-32768),this[g]=f&255,this[g+1]=f>>>8,g+2},a.prototype.writeInt16BE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,2,32767,-32768),this[g]=f>>>8,this[g+1]=f&255,g+2},a.prototype.writeInt32LE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,4,2147483647,-2147483648),this[g]=f&255,this[g+1]=f>>>8,this[g+2]=f>>>16,this[g+3]=f>>>24,g+4},a.prototype.writeInt32BE=function(f,g,I){return f=+f,g=g>>>0,I||H(this,f,g,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[g]=f>>>24,this[g+1]=f>>>16,this[g+2]=f>>>8,this[g+3]=f&255,g+4},a.prototype.writeBigInt64LE=ur(function(f,g=0){return ne(this,f,g,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=ur(function(f,g=0){return Z(this,f,g,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Q(_,f,g,I,B,z){if(g+I>_.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function pe(_,f,g,I,B){return f=+f,g=g>>>0,B||Q(_,f,g,4),n.write(_,f,g,I,23,4),g+4}a.prototype.writeFloatLE=function(f,g,I){return pe(this,f,g,!0,I)},a.prototype.writeFloatBE=function(f,g,I){return pe(this,f,g,!1,I)};function ye(_,f,g,I,B){return f=+f,g=g>>>0,B||Q(_,f,g,8),n.write(_,f,g,I,52,8),g+8}a.prototype.writeDoubleLE=function(f,g,I){return ye(this,f,g,!0,I)},a.prototype.writeDoubleBE=function(f,g,I){return ye(this,f,g,!1,I)},a.prototype.copy=function(f,g,I,B){if(!a.isBuffer(f))throw new TypeError("argument should be a Buffer");if(I||(I=0),!B&&B!==0&&(B=this.length),g>=f.length&&(g=f.length),g||(g=0),B>0&&B<I&&(B=I),B===I||f.length===0||this.length===0)return 0;if(g<0)throw new RangeError("targetStart out of bounds");if(I<0||I>=this.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),f.length-g<B-I&&(B=f.length-g+I);const z=B-I;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(g,I,B):Uint8Array.prototype.set.call(f,this.subarray(I,B),g),z},a.prototype.fill=function(f,g,I,B){if(typeof f=="string"){if(typeof g=="string"?(B=g,g=0,I=this.length):typeof I=="string"&&(B=I,I=this.length),B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!a.isEncoding(B))throw new TypeError("Unknown encoding: "+B);if(f.length===1){const X=f.charCodeAt(0);(B==="utf8"&&X<128||B==="latin1")&&(f=X)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(g<0||this.length<g||this.length<I)throw new RangeError("Out of range index");if(I<=g)return this;g=g>>>0,I=I===void 0?this.length:I>>>0,f||(f=0);let z;if(typeof f=="number")for(z=g;z<I;++z)this[z]=f;else{const X=a.isBuffer(f)?f:a.from(f,B),Fe=X.length;if(Fe===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(z=0;z<I-g;++z)this[z+g]=X[z%Fe]}return this};const Te={};function ue(_,f,g){Te[_]=class extends g{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(B){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:B,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}ue("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ue("ERR_INVALID_ARG_TYPE",function(_,f){return`The "${_}" argument must be of type number. Received type ${typeof f}`},TypeError),ue("ERR_OUT_OF_RANGE",function(_,f,g){let I=`The value of "${_}" is out of range.`,B=g;return Number.isInteger(g)&&Math.abs(g)>2**32?B=Ae(String(g)):typeof g=="bigint"&&(B=String(g),(g>BigInt(2)**BigInt(32)||g<-(BigInt(2)**BigInt(32)))&&(B=Ae(B)),B+="n"),I+=` It must be ${f}. Received ${B}`,I},RangeError);function Ae(_){let f="",g=_.length;const I=_[0]==="-"?1:0;for(;g>=I+4;g-=3)f=`_${_.slice(g-3,g)}${f}`;return`${_.slice(0,g)}${f}`}function qe(_,f,g){Qe(f,"offset"),(_[f]===void 0||_[f+g]===void 0)&&Tt(f,_.length-(g+1))}function st(_,f,g,I,B,z){if(_>g||_<f){const X=typeof f=="bigint"?"n":"";let Fe;throw f===0||f===BigInt(0)?Fe=`>= 0${X} and < 2${X} ** ${(z+1)*8}${X}`:Fe=`>= -(2${X} ** ${(z+1)*8-1}${X}) and < 2 ** ${(z+1)*8-1}${X}`,new Te.ERR_OUT_OF_RANGE("value",Fe,_)}qe(I,B,z)}function Qe(_,f){if(typeof _!="number")throw new Te.ERR_INVALID_ARG_TYPE(f,"number",_)}function Tt(_,f,g){throw Math.floor(_)!==_?(Qe(_,g),new Te.ERR_OUT_OF_RANGE("offset","an integer",_)):f<0?new Te.ERR_BUFFER_OUT_OF_BOUNDS:new Te.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,_)}const Zn=/[^+/0-9A-Za-z-_]/g;function ro(_){if(_=_.split("=")[0],_=_.trim().replace(Zn,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function Zo(_,f){f=f||1/0;let g;const I=_.length;let B=null;const z=[];for(let X=0;X<I;++X){if(g=_.charCodeAt(X),g>55295&&g<57344){if(!B){if(g>56319){(f-=3)>-1&&z.push(239,191,189);continue}else if(X+1===I){(f-=3)>-1&&z.push(239,191,189);continue}B=g;continue}if(g<56320){(f-=3)>-1&&z.push(239,191,189),B=g;continue}g=(B-55296<<10|g-56320)+65536}else B&&(f-=3)>-1&&z.push(239,191,189);if(B=null,g<128){if((f-=1)<0)break;z.push(g)}else if(g<2048){if((f-=2)<0)break;z.push(g>>6|192,g&63|128)}else if(g<65536){if((f-=3)<0)break;z.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((f-=4)<0)break;z.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return z}function Zu(_){const f=[];for(let g=0;g<_.length;++g)f.push(_.charCodeAt(g)&255);return f}function Lc(_,f){let g,I,B;const z=[];for(let X=0;X<_.length&&!((f-=2)<0);++X)g=_.charCodeAt(X),I=g>>8,B=g%256,z.push(B),z.push(I);return z}function Jo(_){return e.toByteArray(ro(_))}function _s(_,f,g,I){let B;for(B=0;B<I&&!(B+g>=f.length||B>=_.length);++B)f[B+g]=_[B];return B}function Mn(_,f){return _ instanceof f||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===f.name}function so(_){return _!==_}const Mc=function(){const _="0123456789abcdef",f=new Array(256);for(let g=0;g<16;++g){const I=g*16;for(let B=0;B<16;++B)f[I+B]=_[g]+_[B]}return f}();function ur(_){return typeof BigInt>"u"?Fc:_}function Fc(){throw new Error("BigInt not supported")}})(i_);const p_=Symbol(),Df=Symbol(),Aa="a",t0="f",Vp="p",n0="c",r0="t",Uf="h",ka="w",$f="o",Bf="k";let g_=(t,e)=>new Proxy(t,e);const gh=Object.getPrototypeOf,mh=new WeakMap,s0=t=>t&&(mh.has(t)?mh.get(t):gh(t)===Object.prototype||gh(t)===Array.prototype),Bl=t=>typeof t=="object"&&t!==null,m_=t=>Object.values(Object.getOwnPropertyDescriptors(t)).some(e=>!e.configurable&&!e.writable),y_=t=>{if(Array.isArray(t))return Array.from(t);const e=Object.getOwnPropertyDescriptors(t);return Object.values(e).forEach(n=>{n.configurable=!0}),Object.create(gh(t),e)},w_=(t,e)=>{const n={[t0]:e};let r=!1;const s=(a,c)=>{if(!r){let l=n[Aa].get(t);if(l||(l={},n[Aa].set(t,l)),a===ka)l[ka]=!0;else{let u=l[a];u||(u=new Set,l[a]=u),u.add(c)}}},i=()=>{r=!0,n[Aa].delete(t)},o={get(a,c){return c===Df?t:(s(Bf,c),E_(Reflect.get(a,c),n[Aa],n[n0],n[r0]))},has(a,c){return c===p_?(i(),!0):(s(Uf,c),Reflect.has(a,c))},getOwnPropertyDescriptor(a,c){return s($f,c),Reflect.getOwnPropertyDescriptor(a,c)},ownKeys(a){return s(ka),Reflect.ownKeys(a)}};return e&&(o.set=o.deleteProperty=()=>!1),[o,n]},Lf=t=>t[Df]||t,E_=(t,e,n,r)=>{if(!s0(t))return t;let s=r&&r.get(t);if(!s){const c=Lf(t);m_(c)?s=[c,y_(c)]:s=[c],r?.set(t,s)}const[i,o]=s;let a=n&&n.get(i);return(!a||a[1][t0]!==!!o)&&(a=w_(i,!!o),a[1][Vp]=g_(o||i,a[0]),n&&n.set(i,a)),a[1][Aa]=e,a[1][n0]=n,a[1][r0]=r,a[1][Vp]},b_=(t,e)=>{const n=Reflect.ownKeys(t),r=Reflect.ownKeys(e);return n.length!==r.length||n.some((s,i)=>s!==r[i])},C_=(t,e,n,r,s=Object.is)=>{if(s(t,e))return!1;if(!Bl(t)||!Bl(e))return!0;const i=n.get(Lf(t));if(!i)return!0;if(r){if(r.get(t)===e)return!1;r.set(t,e)}let o=null;for(const a of i[Uf]||[])if(o=Reflect.has(t,a)!==Reflect.has(e,a),o)return o;if(i[ka]===!0){if(o=b_(t,e),o)return o}else for(const a of i[$f]||[]){const c=!!Reflect.getOwnPropertyDescriptor(t,a),l=!!Reflect.getOwnPropertyDescriptor(e,a);if(o=c!==l,o)return o}for(const a of i[Bf]||[])if(o=C_(t[a],e[a],n,r,s),o)return o;if(o===null)throw new Error("invalid used");return o},v_=t=>s0(t)&&t[Df]||null,Kp=(t,e=!0)=>{mh.set(t,e)},U7=(t,e,n)=>{const r=[],s=new WeakSet,i=(o,a)=>{var c,l,u;if(s.has(o))return;Bl(o)&&s.add(o);const d=Bl(o)&&e.get(Lf(o));if(d){if((c=d[Uf])===null||c===void 0||c.forEach(h=>{const p=`:has(${String(h)})`;r.push(a?[...a,p]:[p])}),d[ka]===!0){const h=":ownKeys";r.push(a?[...a,h]:[h])}else(l=d[$f])===null||l===void 0||l.forEach(h=>{const p=`:hasOwn(${String(h)})`;r.push(a?[...a,p]:[p])});(u=d[Bf])===null||u===void 0||u.forEach(h=>{"value"in(Object.getOwnPropertyDescriptor(o,h)||{})&&i(o[h],a?[...a,h]:[h])})}else a&&r.push(a)};return i(t),r},Ll={},Mf=t=>typeof t=="object"&&t!==null,__=t=>Mf(t)&&!Cc.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),i0=(t,e)=>{const n=yh.get(t);if(n?.[0]===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return Kp(r,!0),yh.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(Cc.has(i))Kp(i,!1);else if(ni.has(i)){const[c,l]=ni.get(i);a.value=i0(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},A_=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Gp(l,o)||qa.has(o)&&Gp(l,qa.get(o))))return!0;n(i),Mf(o)&&(o=v_(o)||o);const u=!ni.has(o)&&I_(o)?tt(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),ni=new WeakMap,Cc=new WeakSet,yh=new WeakMap,vl=[1],qa=new WeakMap;let Gp=Object.is,S_=(t,e)=>new Proxy(t,e),I_=__,T_=i0,N_=A_;function tt(t={}){if(!Mf(t))throw new Error("object required");const e=qa.get(t);if(e)return e;let n=vl[0];const r=new Set,s=(b,R=++vl[0])=>{n!==R&&(i=n=R,r.forEach(k=>k(b,R)))};let i=n;const o=(b=vl[0])=>(i!==b&&(i=b,c.forEach(([R])=>{const k=R[1](b);k>n&&(n=k)})),n),a=b=>(R,k)=>{const S=[...R];S[1]=[b,...S[1]],s(S,k)},c=new Map,l=(b,R)=>{const k=!Cc.has(R)&&ni.get(R);if(k){if((Ll?"production":void 0)!=="production"&&c.has(b))throw new Error("prop listener already exists");if(r.size){const S=k[2](a(b));c.set(b,[k,S])}else c.set(b,[k])}},u=b=>{var R;const k=c.get(b);k&&(c.delete(b),(R=k[1])==null||R.call(k))},d=b=>(r.add(b),r.size===1&&c.forEach(([k,S],O)=>{if((Ll?"production":void 0)!=="production"&&S)throw new Error("remove already exists");const U=k[2](a(O));c.set(O,[k,U])}),()=>{r.delete(b),r.size===0&&c.forEach(([k,S],O)=>{S&&(S(),c.set(O,[k]))})});let h=!0;const p=N_(()=>h,l,u,s),m=S_(t,p);qa.set(t,m);const w=[t,o,d];return ni.set(m,w),Reflect.ownKeys(t).forEach(b=>{const R=Object.getOwnPropertyDescriptor(t,b);"value"in R&&R.writable&&(m[b]=t[b])}),h=!1,m}function xt(t,e,n){const r=ni.get(t);(Ll?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function za(t){const e=ni.get(t);(Ll?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return T_(n,r())}function Va(t){return Cc.add(t),t}function x_(){return{proxyStateMap:ni,refSet:Cc,snapCache:yh,versionHolder:vl,proxyCache:qa}}function It(t,e,n,r){let s=t[e];return xt(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:O_,snapCache:R_}=x_(),Hc=t=>O_.has(t);function k_(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=R_.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:e,index:n,epoch:0,get size(){return Hc(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!Hc(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!Hc(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!Hc(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=tt(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}const o0={isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()}};var a0={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(wu,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",c="hour",l="day",u="week",d="month",h="quarter",p="year",m="date",w="Invalid Date",b=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,R=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var y=["th","st","nd","rd"],E=P%100;return"["+P+(y[(E-20)%10]||y[E]||y[0])+"]"}},S=function(P,y,E){var A=String(P);return!A||A.length>=y?P:""+Array(y+1-A.length).join(E)+P},O={s:S,z:function(P){var y=-P.utcOffset(),E=Math.abs(y),A=Math.floor(E/60),N=E%60;return(y<=0?"+":"-")+S(A,2,"0")+":"+S(N,2,"0")},m:function P(y,E){if(y.date()<E.date())return-P(E,y);var A=12*(E.year()-y.year())+(E.month()-y.month()),N=y.clone().add(A,d),T=E-N<0,x=y.clone().add(A+(T?-1:1),d);return+(-(A+(E-N)/(T?N-x:x-N))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:p,w:u,d:l,D:m,h:c,m:a,s:o,ms:i,Q:h}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},U="en",F={};F[U]=k;var q="$isDayjsObject",V=function(P){return P instanceof W||!(!P||!P[q])},L=function P(y,E,A){var N;if(!y)return U;if(typeof y=="string"){var T=y.toLowerCase();F[T]&&(N=T),E&&(F[T]=E,N=T);var x=y.split("-");if(!N&&x.length>1)return P(x[0])}else{var M=y.name;F[M]=y,N=M}return!A&&N&&(U=N),N||!A&&U},Y=function(P,y){if(V(P))return P.clone();var E=typeof y=="object"?y:{};return E.date=P,E.args=arguments,new W(E)},G=O;G.l=L,G.i=V,G.w=function(P,y){return Y(P,{locale:y.$L,utc:y.$u,x:y.$x,$offset:y.$offset})};var W=function(){function P(E){this.$L=L(E.locale,null,!0),this.parse(E),this.$x=this.$x||E.x||{},this[q]=!0}var y=P.prototype;return y.parse=function(E){this.$d=function(A){var N=A.date,T=A.utc;if(N===null)return new Date(NaN);if(G.u(N))return new Date;if(N instanceof Date)return new Date(N);if(typeof N=="string"&&!/Z$/i.test(N)){var x=N.match(b);if(x){var M=x[2]-1||0,H=(x[7]||"0").substring(0,3);return T?new Date(Date.UTC(x[1],M,x[3]||1,x[4]||0,x[5]||0,x[6]||0,H)):new Date(x[1],M,x[3]||1,x[4]||0,x[5]||0,x[6]||0,H)}}return new Date(N)}(E),this.init()},y.init=function(){var E=this.$d;this.$y=E.getFullYear(),this.$M=E.getMonth(),this.$D=E.getDate(),this.$W=E.getDay(),this.$H=E.getHours(),this.$m=E.getMinutes(),this.$s=E.getSeconds(),this.$ms=E.getMilliseconds()},y.$utils=function(){return G},y.isValid=function(){return this.$d.toString()!==w},y.isSame=function(E,A){var N=Y(E);return this.startOf(A)<=N&&N<=this.endOf(A)},y.isAfter=function(E,A){return Y(E)<this.startOf(A)},y.isBefore=function(E,A){return this.endOf(A)<Y(E)},y.$g=function(E,A,N){return G.u(E)?this[A]:this.set(N,E)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(E,A){var N=this,T=!!G.u(A)||A,x=G.p(E),M=function(ue,Ae){var qe=G.w(N.$u?Date.UTC(N.$y,Ae,ue):new Date(N.$y,Ae,ue),N);return T?qe:qe.endOf(l)},H=function(ue,Ae){return G.w(N.toDate()[ue].apply(N.toDate("s"),(T?[0,0,0,0]:[23,59,59,999]).slice(Ae)),N)},ne=this.$W,Z=this.$M,Q=this.$D,pe="set"+(this.$u?"UTC":"");switch(x){case p:return T?M(1,0):M(31,11);case d:return T?M(1,Z):M(0,Z+1);case u:var ye=this.$locale().weekStart||0,Te=(ne<ye?ne+7:ne)-ye;return M(T?Q-Te:Q+(6-Te),Z);case l:case m:return H(pe+"Hours",0);case c:return H(pe+"Minutes",1);case a:return H(pe+"Seconds",2);case o:return H(pe+"Milliseconds",3);default:return this.clone()}},y.endOf=function(E){return this.startOf(E,!1)},y.$set=function(E,A){var N,T=G.p(E),x="set"+(this.$u?"UTC":""),M=(N={},N[l]=x+"Date",N[m]=x+"Date",N[d]=x+"Month",N[p]=x+"FullYear",N[c]=x+"Hours",N[a]=x+"Minutes",N[o]=x+"Seconds",N[i]=x+"Milliseconds",N)[T],H=T===l?this.$D+(A-this.$W):A;if(T===d||T===p){var ne=this.clone().set(m,1);ne.$d[M](H),ne.init(),this.$d=ne.set(m,Math.min(this.$D,ne.daysInMonth())).$d}else M&&this.$d[M](H);return this.init(),this},y.set=function(E,A){return this.clone().$set(E,A)},y.get=function(E){return this[G.p(E)]()},y.add=function(E,A){var N,T=this;E=Number(E);var x=G.p(A),M=function(Z){var Q=Y(T);return G.w(Q.date(Q.date()+Math.round(Z*E)),T)};if(x===d)return this.set(d,this.$M+E);if(x===p)return this.set(p,this.$y+E);if(x===l)return M(1);if(x===u)return M(7);var H=(N={},N[a]=r,N[c]=s,N[o]=n,N)[x]||1,ne=this.$d.getTime()+E*H;return G.w(ne,this)},y.subtract=function(E,A){return this.add(-1*E,A)},y.format=function(E){var A=this,N=this.$locale();if(!this.isValid())return N.invalidDate||w;var T=E||"YYYY-MM-DDTHH:mm:ssZ",x=G.z(this),M=this.$H,H=this.$m,ne=this.$M,Z=N.weekdays,Q=N.months,pe=N.meridiem,ye=function(Ae,qe,st,Qe){return Ae&&(Ae[qe]||Ae(A,T))||st[qe].slice(0,Qe)},Te=function(Ae){return G.s(M%12||12,Ae,"0")},ue=pe||function(Ae,qe,st){var Qe=Ae<12?"AM":"PM";return st?Qe.toLowerCase():Qe};return T.replace(R,function(Ae,qe){return qe||function(st){switch(st){case"YY":return String(A.$y).slice(-2);case"YYYY":return G.s(A.$y,4,"0");case"M":return ne+1;case"MM":return G.s(ne+1,2,"0");case"MMM":return ye(N.monthsShort,ne,Q,3);case"MMMM":return ye(Q,ne);case"D":return A.$D;case"DD":return G.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return ye(N.weekdaysMin,A.$W,Z,2);case"ddd":return ye(N.weekdaysShort,A.$W,Z,3);case"dddd":return Z[A.$W];case"H":return String(M);case"HH":return G.s(M,2,"0");case"h":return Te(1);case"hh":return Te(2);case"a":return ue(M,H,!0);case"A":return ue(M,H,!1);case"m":return String(H);case"mm":return G.s(H,2,"0");case"s":return String(A.$s);case"ss":return G.s(A.$s,2,"0");case"SSS":return G.s(A.$ms,3,"0");case"Z":return x}return null}(Ae)||x.replace(":","")})},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(E,A,N){var T,x=this,M=G.p(A),H=Y(E),ne=(H.utcOffset()-this.utcOffset())*r,Z=this-H,Q=function(){return G.m(x,H)};switch(M){case p:T=Q()/12;break;case d:T=Q();break;case h:T=Q()/3;break;case u:T=(Z-ne)/6048e5;break;case l:T=(Z-ne)/864e5;break;case c:T=Z/s;break;case a:T=Z/r;break;case o:T=Z/n;break;default:T=Z}return N?T:G.a(T)},y.daysInMonth=function(){return this.endOf(d).$D},y.$locale=function(){return F[this.$L]},y.locale=function(E,A){if(!E)return this.$L;var N=this.clone(),T=L(E,A,!0);return T&&(N.$L=T),N},y.clone=function(){return G.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},P}(),D=W.prototype;return Y.prototype=D,[["$ms",i],["$s",o],["$m",a],["$H",c],["$W",l],["$M",d],["$y",p],["$D",m]].forEach(function(P){D[P[1]]=function(y){return this.$g(y,P[0],P[1])}}),Y.extend=function(P,y){return P.$i||(P(y,W,Y),P.$i=!0),Y},Y.locale=L,Y.isDayjs=V,Y.unix=function(P){return Y(1e3*P)},Y.en=F[U],Y.Ls=F,Y.p={},Y})})(a0);var P_=a0.exports;const Io=zo(P_);var c0={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(wu,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var r=["th","st","nd","rd"],s=n%100;return"["+n+(r[(s-20)%10]||r[s]||r[0])+"]"}}})})(c0);var D_=c0.exports;const U_=zo(D_);var l0={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(wu,function(){return function(n,r,s){n=n||{};var i=r.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a(l,u,d,h){return i.fromToBase(l,u,d,h)}s.en.relativeTime=o,i.fromToBase=function(l,u,d,h,p){for(var m,w,b,R=d.$locale().relativeTime||o,k=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],S=k.length,O=0;O<S;O+=1){var U=k[O];U.d&&(m=h?s(l).diff(d,U.d,!0):d.diff(l,U.d,!0));var F=(n.rounding||Math.round)(Math.abs(m));if(b=m>0,F<=U.r||!U.r){F<=1&&O>0&&(U=k[O-1]);var q=R[U.l];p&&(F=p(""+F)),w=typeof q=="string"?q.replace("%d",F):q(F,u,U.l,b);break}}if(u)return w;var V=b?R.future:R.past;return typeof V=="function"?V(w):V.replace("%s",w)},i.to=function(l,u){return a(l,u,this,!0)},i.from=function(l,u){return a(l,u,this)};var c=function(l){return l.$u?s.utc():s()};i.toNow=function(l){return this.to(c(this),l)},i.fromNow=function(l){return this.from(c(this),l)}}})})(l0);var $_=l0.exports;const B_=zo($_);var u0={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(wu,function(){return function(n,r,s){s.updateLocale=function(i,o){var a=s.Ls[i];if(a)return(o?Object.keys(o):[]).forEach(function(c){a[c]=o[c]}),a}}})})(u0);var L_=u0.exports;const M_=zo(L_);Io.extend(B_);Io.extend(M_);const F_={...U_,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},j_=["January","February","March","April","May","June","July","August","September","October","November","December"];Io.locale("en-web3-modal",F_);const Yp={getMonthNameByIndex(t){return j_[t]},getYear(t=new Date().toISOString()){return Io(t).year()},getRelativeDateFromNow(t){return Io(t).locale("en-web3-modal").fromNow(!0)},formatDate(t,e="DD MMM"){return Io(t).format(e)}};var Zp={};const $={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",BASE_ACCOUNT:"baseAccount",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122",TON:"ton"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks",ton:"TON"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",TON:"ton"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},NATIVE_IMAGE_IDS_BY_NAMESPACE:{eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"3e8119e5-2a6f-4818-c50c-1937011d5900",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00"},TOKEN_SYMBOLS_BY_ADDRESS:{"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48":"USDC","0x833589fcd6edb6e08f4c7c32d4f71b54bda02913":"USDC","0x0b2c639c533813f4aa9d7837caf62653d097ff85":"USDC","0xaf88d065e77c8cc2239327c5edb3a432268e5831":"USDC","0x3c499c542cef5e3811e1192ce70d8cc03d5c3359":"USDC","0x2791bca1f2de4661ed88a30c99a7a9449aa84174":"USDC",EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v:"USDC","0xdac17f958d2ee523a2206206994597c13d831ec7":"USDT","0x94b008aa00579c1307b0ef2c499ad98a8ce58e58":"USDT","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9":"USDT","0xc2132d05d31c914a87c6611c10748aeb04b58e8f":"USDT",Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB:"USDT"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Zp<"u"?Zp.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}},HEADLESS_NOT_ENABLED:{DEFAULT:{displayMessage:"",debugMessage:"Headless support is not enabled. Please enable it with the features.headless option in the AppKit configuration and make sure your current plan supports it."}}},IS_DEVELOPMENT:typeof process<"u"&&!1,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"],METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH"},Ka={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return t?.filter(n=>n.chainNamespace===e)||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){if(!e)return;const n=t.find(s=>s.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return $.CHAIN_NAME_MAP?.[r]||void 0}},d0=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var W_=20,H_=1,$i=1e6,Jp=1e6,q_=-7,z_=21,V_=!1,vc="[big.js] ",Gi=vc+"Invalid ",bu=Gi+"decimal places",K_=Gi+"rounding mode",h0=vc+"Division by zero",rt={},Hr=void 0,G_=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function f0(){function t(e){var n=this;if(!(n instanceof t))return e===Hr?f0():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Gi+"value");e=e===0&&1/e<0?"-0":String(e)}Y_(n,e)}n.constructor=t}return t.prototype=rt,t.DP=W_,t.RM=H_,t.NE=q_,t.PE=z_,t.strict=V_,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function Y_(t,e){var n,r,s;if(!G_.test(e))throw Error(Gi+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function Yi(t,e,n,r){var s=t.c;if(n===Hr&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(K_);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==Hr))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==Hr||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function Zi(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}rt.abs=function(){var t=new this.constructor(this);return t.s=1,t};rt.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};rt.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>$i)throw Error(bu);if(!s[0])throw Error(h0);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),p=a=s.length,m=r.length,w=r.slice(0,a),b=w.length,R=t,k=R.c=[],S=0,O=o+(R.e=e.e-t.e)+1;for(R.s=i,i=O<0?0:O,h.unshift(0);b++<a;)w.push(0);do{for(l=0;l<10;l++){if(a!=(b=w.length))u=a>b?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=w[d]){u=s[d]>w[d]?1:-1;break}if(u<0){for(c=b==a?s:h;b;){if(w[--b]<c[b]){for(d=b;d&&!w[--d];)w[d]=9;--w[d],w[b]+=10}w[b]-=c[b]}for(;!w[0];)w.shift()}else break}k[S++]=u?l:++l,w[0]&&u?w[b]=r[p]||0:w=[r[p]]}while((p++<m||w[0]!==Hr)&&i--);return!k[0]&&S!=1&&(k.shift(),R.e--,O--),S>O&&Yi(R,O,n.RM,w[0]!==Hr),R};rt.eq=function(t){return this.cmp(t)===0};rt.gt=function(t){return this.cmp(t)>0};rt.gte=function(t){return this.cmp(t)>-1};rt.lt=function(t){return this.cmp(t)<0};rt.lte=function(t){return this.cmp(t)<1};rt.minus=rt.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>a;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};rt.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(h0);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};rt.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};rt.plus=rt.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+l[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};rt.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-Jp||t>Jp)throw Error(Gi+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};rt.prec=function(t,e){if(t!==~~t||t<1||t>$i)throw Error(Gi+"precision");return Yi(new this.constructor(this),t,e)};rt.round=function(t,e){if(t===Hr)t=0;else if(t!==~~t||t<-$i||t>$i)throw Error(bu);return Yi(new this.constructor(this),t+this.e+1,e)};rt.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(vc+"No square root");i=Math.sqrt(+Zi(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return Yi(t,(s.DP-=4)+t.e+1,s.RM)};rt.times=rt.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};rt.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==Hr){if(t!==~~t||t<0||t>$i)throw Error(bu);for(n=Yi(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return Zi(n,!0,!!r)};rt.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==Hr){if(t!==~~t||t<0||t>$i)throw Error(bu);for(n=Yi(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return Zi(n,!1,!!r)};rt[Symbol.for("nodejs.util.inspect.custom")]=rt.toJSON=rt.toString=function(){var t=this,e=t.constructor;return Zi(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};rt.toNumber=function(){var t=+Zi(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(vc+"Imprecise conversion");return t};rt.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==Hr){if(t!==~~t||t<1||t>$i)throw Error(Gi+"precision");for(n=Yi(new r(n),t,e);n.c.length<t;)n.c.push(0)}return Zi(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};rt.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(vc+"valueOf disallowed");return Zi(t,t.e<=e.NE||t.e>=e.PE,!0)};var Nr=f0();const bt={bigNumber(t,e={safe:!1}){try{return t?new Nr(t):new Nr(0)}catch(n){if(e.safe)return new Nr(0);throw n}},formatNumber(t,e){const{decimals:n,round:r=8,safe:s=!0}=e;return bt.bigNumber(t,{safe:s}).div(new Nr(10).pow(n)).round(r)},multiply(t,e){if(t===void 0||e===void 0)return new Nr(0);const n=new Nr(t),r=new Nr(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new Nr(0).toFixed(e):new Nr(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new Nr(e).toNumber()}},$7={numericInputKeyDown(t,e,n){const r=["Backspace","Meta","Ctrl","a","A","c","C","x","X","v","V","ArrowLeft","ArrowRight","Tab"],s=t.metaKey||t.ctrlKey,i=t.key,o=i.toLocaleLowerCase(),a=o==="a",c=o==="c",l=o==="v",u=o==="x",d=i===",",h=i===".",p=i>="0"&&i<="9";!s&&(a||c||l||u)&&t.preventDefault(),e==="0"&&!d&&!h&&i==="0"&&t.preventDefault(),e==="0"&&p&&(n(i),t.preventDefault()),(d||h)&&(e||(n("0."),t.preventDefault()),(e?.includes(".")||e?.includes(","))&&t.preventDefault()),!p&&!r.includes(i)&&!h&&!d&&t.preventDefault()}},Z_=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],J_=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],X_=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Q_={getERC20Abi:t=>$.USDT_CONTRACT_ADDRESSES.includes(t)?X_:Z_,getSwapAbi:()=>J_},B7={URLS:{FAQ:"https://walletconnect.com/faq"}},pn={ConnectorExplorerIds:{[$.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[$.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[$.CONNECTOR_ID.BASE_ACCOUNT]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[$.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[$.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[$.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[$.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[$.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[$.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[$.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[$.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[$.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[$.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[$.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[$.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[$.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[$.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[$.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[$.BINANCE_CONNECTOR_NAME]:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25"},ConnectorImageIds:{[$.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[$.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[$.CONNECTOR_ID.BASE_ACCOUNT]:"bba2c8be-7fd1-463e-42b1-796ecb0ad200",[$.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[$.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[$.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[$.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[$.CONNECTOR_ID.INJECTED]:"Browser Wallet",[$.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[$.CONNECTOR_ID.COINBASE]:"Coinbase",[$.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[$.CONNECTOR_ID.BASE_ACCOUNT]:"Base Account",[$.CONNECTOR_ID.LEDGER]:"Ledger",[$.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[$.CONNECTOR_ID.INJECTED]:"INJECTED",[$.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[$.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[$.CONNECTOR_ID.AUTH]:"AUTH"}},Lt={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},br={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001,USER_REJECTED_METHODS:5002,USER_REJECTED:5e3,SEND_TRANSACTION_ERROR:5001},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError",SEND_TRANSACTION_ERROR:"SendTransactionError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){if(br.isRpcProviderError(t)){const e=t.code===br.RPC_ERROR_CODE.USER_REJECTED_REQUEST,n=t.code===br.RPC_ERROR_CODE.USER_REJECTED_METHODS;return e||n||br.isUserRejectedMessage(t.message)}return t instanceof Error?br.isUserRejectedMessage(t.message):!1}};class eA extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=br.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}}class Co extends eA{constructor(e){super(e,{code:br.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=br.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}}const Ce={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version",TON_WALLETS_CACHE:"@appkit/ton_wallets_cache"};function td(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const be={setItem(t,e){Sa()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(Sa())return localStorage.getItem(t)||void 0},removeItem(t){Sa()&&localStorage.removeItem(t)},clear(){Sa()&&localStorage.clear()}};function Sa(){return typeof window<"u"&&typeof localStorage<"u"}function Ga(t,e){const n=t?.["--apkt-accent"]??t?.["--w3m-accent"];return e==="light"?{"--w3m-accent":n||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":n||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var Xp={};const nd=(typeof process<"u"&&typeof Xp<"u"?Xp.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",p0=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],tA="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Pe={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:nd,SECURE_SITE_DASHBOARD:`${nd}/dashboard`,SECURE_SITE_FAVICON:`${nd}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],SUGGESTED_TOKENS_BY_CHAIN:{"eip155:42161":["USD0"]},BALANCE_SUPPORTED_CHAINS:[$.CHAIN.EVM,$.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[$.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[$.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[$.CHAIN.EVM,$.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[$.CHAIN.EVM,$.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[$.CHAIN.EVM,$.CHAIN.TON],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x",ton:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[$.CHAIN.EVM,$.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1,headless:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1,headless:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1,headless:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa",ton:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0},MANDATORY_WALLET_IDS_ON_MOBILE:[pn.ConnectorExplorerIds[$.CONNECTOR_ID.COINBASE],pn.ConnectorExplorerIds[$.CONNECTOR_ID.COINBASE_SDK],pn.ConnectorExplorerIds[$.CONNECTOR_ID.BASE_ACCOUNT],pn.ConnectorExplorerIds[$.SOLFLARE_CONNECTOR_NAME],pn.ConnectorExplorerIds[$.PHANTOM_CONNECTOR_NAME],pn.ConnectorExplorerIds[$.BINANCE_CONNECTOR_NAME]],DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"]},J={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5,tonWallets:864e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=J.getActiveNamespace(),e=J.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{be.setItem(Ce.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=be.getItem(Ce.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{be.removeItem(Ce.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{be.setItem(Ce.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{be.setItem(Ce.ACTIVE_CAIP_NETWORK_ID,t),J.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return be.getItem(Ce.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{be.removeItem(Ce.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=td(t);be.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=J.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),be.setItem(Ce.RECENT_WALLETS,JSON.stringify(e)),be.setItem(Ce.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=be.getItem(Ce.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=be.getItem(Ce.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{be.removeItem(Ce.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const n=td(t);be.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return be.getItem(Ce.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=td(t);return be.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{be.setItem(Ce.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return be.getItem(Ce.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{be.removeItem(Ce.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return be.getItem(Ce.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return be.getItem(Ce.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(t){try{be.setItem(Ce.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return be.getItem(Ce.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=be.getItem(Ce.CONNECTED_NAMESPACES);return t?.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));be.setItem(Ce.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=J.getConnectedNamespaces();e.includes(t)||(e.push(t),J.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=J.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),J.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return be.getItem(Ce.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{be.setItem(Ce.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{be.removeItem(Ce.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=be.getItem(Ce.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=J.getBalanceCache();be.setItem(Ce.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=J.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;J.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=J.getBalanceCache();e[t.caipAddress]=t,be.setItem(Ce.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=be.getItem(Ce.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=J.getBalanceCache();be.setItem(Ce.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=J.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),J.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=J.getNativeBalanceCache();e[t.caipAddress]=t,be.setItem(Ce.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=be.getItem(Ce.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=J.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;J.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=J.getEnsCache();e[t.address]=t,be.setItem(Ce.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=J.getEnsCache();be.setItem(Ce.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=be.getItem(Ce.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=J.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;J.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=J.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},be.setItem(Ce.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=J.getIdentityCache();be.setItem(Ce.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},getTonWalletsCache(){try{const t=be.getItem(Ce.TON_WALLETS_CACHE),e=t?JSON.parse(t):void 0;if(e&&!this.isCacheExpired(e.timestamp,this.cacheExpiry.tonWallets))return e;J.removeTonWalletsCache()}catch{console.info("Unable to get ton wallets cache")}},updateTonWalletsCache(t){try{const e=J.getTonWalletsCache()||{timestamp:0,wallets:[]};e.timestamp=new Date().getTime(),e.wallets=t,be.setItem(Ce.TON_WALLETS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ton wallets cache",t)}},removeTonWalletsCache(){try{be.removeItem(Ce.TON_WALLETS_CACHE)}catch{console.info("Unable to remove ton wallets cache")}},clearAddressCache(){try{be.removeItem(Ce.PORTFOLIO_CACHE),be.removeItem(Ce.NATIVE_BALANCE_CACHE),be.removeItem(Ce.ENS_CACHE),be.removeItem(Ce.IDENTITY_CACHE),be.removeItem(Ce.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{be.setItem(Ce.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=be.getItem(Ce.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=J.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===$.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};be.setItem(Ce.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=be.getItem(Ce.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=J.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),be.setItem(Ce.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=be.getItem(Ce.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=J.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),be.setItem(Ce.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=J.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),be.setItem(Ce.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(J.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=be.getItem(Ce.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){try{const r=J.getTransactionsCache()[t]?.[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;J.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=J.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},be.setItem(Ce.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=J.getTransactionsCache(),r=n?.[t]||{},{[e]:s,...i}=r;be.setItem(Ce.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=be.getItem(Ce.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=J.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;J.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=J.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},be.setItem(Ce.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=J.getTokenPriceCache();be.setItem(Ce.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t?.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=be.getItem(Ce.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=J.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,be.setItem(Ce.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},se={getWindow(){if(!(typeof window>"u"))return window},isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return se.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Pe.TEN_SEC_MS:!0},isAllowedRetry(t,e=Pe.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(se.isClient()&&window.self!==window.top)try{const t=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(t){const n=new URL(t),r=new URL(e);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Pe.FOUR_MINUTES_MS},getNetworkId(t){return t?.split(":")[1]},getPlainAddress(t){return t?.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(se.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!se.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?J.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const t=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,se.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const c=Number(t);if(!isNaN(c)){const l=(Math.floor(c*1e3)/1e3).toFixed(3);l&&(n=l)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return $.W3M_API_URL},getBlockchainApiUrl(){return $.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return $.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){return typeof t=="string"?t:typeof t?.issues?.[0]?.message=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);case"bip122":{const n=/^[1][a-km-zA-HJ-NP-Z1-9]{25,34}$/u.test(t),r=/^[3][a-km-zA-HJ-NP-Z1-9]{25,34}$/u.test(t),s=/^bc1[a-z0-9]{39,87}$/u.test(t),i=/^bc1p[a-z0-9]{58}$/u.test(t);return n||r||s||i}default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Pe.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in $.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window?.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),l=t.substring(s),u=c+n;return a+u+l},isNumber(t){return typeof t!="number"&&typeof t!="string"?!1:!isNaN(Number(t))},appendPayToUri(t,e){return e?`${t}&pay=${encodeURIComponent(e)}`:t}};var $o={};const nA="https://secure.walletconnect.org/sdk",rA=(typeof process<"u"&&typeof $o<"u"?$o.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||nA,sA=(typeof process<"u"&&typeof $o<"u"?$o.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",iA=(typeof process<"u"&&typeof $o<"u"?$o.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",Ee={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},yt={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Qp={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},$t={set(t,e){Kn.isClient&&localStorage.setItem(`${Ee.STORAGE_KEY}${t}`,e)},get(t){return Kn.isClient?localStorage.getItem(`${Ee.STORAGE_KEY}${t}`):null},delete(t,e){Kn.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${Ee.STORAGE_KEY}${t}`))}},qc=30*1e3,Kn={checkIfAllowedToTriggerEmail(){const t=$t.get(Ee.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<qc){const n=Math.ceil((qc-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=$t.get(Ee.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<qc)return Math.ceil((qc-e)/1e3)}return 0},checkIfRequestExists(t){return yt.NOT_SAFE_RPC_METHODS.includes(t.method)||yt.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&(t?.match(Qp.transactionHash)||t?.match(Qp.signedMessage))?Ee.RPC_RESPONSE_TYPE_TX:Ee.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return yt.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Je;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Je||(Je={}));var wh;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(wh||(wh={}));const fe=Je.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Hs=t=>{switch(typeof t){case"undefined":return fe.undefined;case"string":return fe.string;case"number":return isNaN(t)?fe.nan:fe.number;case"boolean":return fe.boolean;case"function":return fe.function;case"bigint":return fe.bigint;case"symbol":return fe.symbol;case"object":return Array.isArray(t)?fe.array:t===null?fe.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?fe.promise:typeof Map<"u"&&t instanceof Map?fe.map:typeof Set<"u"&&t instanceof Set?fe.set:typeof Date<"u"&&t instanceof Date?fe.date:fe.object;default:return fe.unknown}},ie=Je.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),oA=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class _r extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Je.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}_r.create=t=>new _r(t);const Ya=(t,e)=>{let n;switch(t.code){case ie.invalid_type:t.received===fe.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ie.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Je.jsonStringifyReplacer)}`;break;case ie.unrecognized_keys:n=`Unrecognized key(s) in object: ${Je.joinValues(t.keys,", ")}`;break;case ie.invalid_union:n="Invalid input";break;case ie.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Je.joinValues(t.options)}`;break;case ie.invalid_enum_value:n=`Invalid enum value. Expected ${Je.joinValues(t.options)}, received '${t.received}'`;break;case ie.invalid_arguments:n="Invalid function arguments";break;case ie.invalid_return_type:n="Invalid function return type";break;case ie.invalid_date:n="Invalid date";break;case ie.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Je.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ie.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ie.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ie.custom:n="Invalid input";break;case ie.invalid_intersection_types:n="Intersection results could not be merged";break;case ie.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ie.not_finite:n="Number must be finite";break;default:n=e.defaultError,Je.assertNever(t)}return{message:n}};let g0=Ya;function aA(t){g0=t}function Ml(){return g0}const Fl=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},cA=[];function we(t,e){const n=Fl({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ml(),Ya].filter(r=>!!r)});t.common.issues.push(n)}class dn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return ke;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return dn.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return ke;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const ke=Object.freeze({status:"aborted"}),m0=t=>({status:"dirty",value:t}),bn=t=>({status:"valid",value:t}),Eh=t=>t.status==="aborted",bh=t=>t.status==="dirty",Za=t=>t.status==="valid",jl=t=>typeof Promise<"u"&&t instanceof Promise;var Ie;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(Ie||(Ie={}));class Vr{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const eg=(t,e)=>{if(Za(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new _r(t.common.issues);return this._error=n,this._error}}};function Ue(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class Me{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Hs(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Hs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new dn,ctx:{common:e.parent.common,data:e.data,parsedType:Hs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(jl(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Hs(e)},i=this._parseSync({data:e,path:s.path,parent:s});return eg(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Hs(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(jl(s)?s:Promise.resolve(s));return eg(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:ie.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Ir({schema:this,typeName:Oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return gs.create(this,this._def)}nullable(){return Mi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ar.create(this,this._def)}promise(){return Lo.create(this,this._def)}or(e){return ec.create([this,e],this._def)}and(e){return tc.create(this,e,this._def)}transform(e){return new Ir({...Ue(this._def),schema:this,typeName:Oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new oc({...Ue(this._def),innerType:this,defaultValue:n,typeName:Oe.ZodDefault})}brand(){return new w0({typeName:Oe.ZodBranded,type:this,...Ue(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new zl({...Ue(this._def),innerType:this,catchValue:n,typeName:Oe.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return _c.create(this,e)}readonly(){return Kl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const lA=/^c[^\s-]{8,}$/i,uA=/^[a-z][a-z0-9]*$/,dA=/^[0-9A-HJKMNP-TV-Z]{26}$/,hA=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,fA=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,pA="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let rd;const gA=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,mA=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,yA=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function wA(t,e){return!!((e==="v4"||!e)&&gA.test(t)||(e==="v6"||!e)&&mA.test(t))}class vr extends Me{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==fe.string){const i=this._getOrReturnCtx(e);return we(i,{code:ie.invalid_type,expected:fe.string,received:i.parsedType}),ke}const r=new dn;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),we(s,{code:ie.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),we(s,{code:ie.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?we(s,{code:ie.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&we(s,{code:ie.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")fA.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"email",code:ie.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")rd||(rd=new RegExp(pA,"u")),rd.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"emoji",code:ie.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")hA.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"uuid",code:ie.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")lA.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"cuid",code:ie.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")uA.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"cuid2",code:ie.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")dA.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"ulid",code:ie.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),we(s,{validation:"url",code:ie.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"regex",code:ie.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),we(s,{code:ie.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),we(s,{code:ie.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),we(s,{code:ie.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?yA(i).test(e.data)||(s=this._getOrReturnCtx(e,s),we(s,{code:ie.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?wA(e.data,i.version)||(s=this._getOrReturnCtx(e,s),we(s,{validation:"ip",code:ie.invalid_string,message:i.message}),r.dirty()):Je.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:ie.invalid_string,...Ie.errToObj(r)})}_addCheck(e){return new vr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ie.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,...Ie.errToObj(e?.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Ie.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...Ie.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Ie.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Ie.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Ie.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Ie.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Ie.errToObj(n)})}nonempty(e){return this.min(1,Ie.errToObj(e))}trim(){return new vr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}vr.create=t=>{var e;return new vr({checks:[],typeName:Oe.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Ue(t)})};function EA(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class ri extends Me{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==fe.number){const i=this._getOrReturnCtx(e);return we(i,{code:ie.invalid_type,expected:fe.number,received:i.parsedType}),ke}let r;const s=new dn;for(const i of this._def.checks)i.kind==="int"?Je.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),we(r,{code:ie.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:ie.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:ie.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?EA(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),we(r,{code:ie.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),we(r,{code:ie.not_finite,message:i.message}),s.dirty()):Je.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ie.toString(n))}setLimit(e,n,r,s){return new ri({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ie.toString(s)}]})}_addCheck(e){return new ri({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ie.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Je.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}ri.create=t=>new ri({checks:[],typeName:Oe.ZodNumber,coerce:t?.coerce||!1,...Ue(t)});class si extends Me{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==fe.bigint){const i=this._getOrReturnCtx(e);return we(i,{code:ie.invalid_type,expected:fe.bigint,received:i.parsedType}),ke}let r;const s=new dn;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:ie.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),we(r,{code:ie.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),we(r,{code:ie.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Je.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ie.toString(n))}setLimit(e,n,r,s){return new si({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ie.toString(s)}]})}_addCheck(e){return new si({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}si.create=t=>{var e;return new si({checks:[],typeName:Oe.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Ue(t)})};class Ja extends Me{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==fe.boolean){const r=this._getOrReturnCtx(e);return we(r,{code:ie.invalid_type,expected:fe.boolean,received:r.parsedType}),ke}return bn(e.data)}}Ja.create=t=>new Ja({typeName:Oe.ZodBoolean,coerce:t?.coerce||!1,...Ue(t)});class Bi extends Me{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==fe.date){const i=this._getOrReturnCtx(e);return we(i,{code:ie.invalid_type,expected:fe.date,received:i.parsedType}),ke}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return we(i,{code:ie.invalid_date}),ke}const r=new dn;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),we(s,{code:ie.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),we(s,{code:ie.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Je.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Bi({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Ie.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Ie.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Bi.create=t=>new Bi({checks:[],coerce:t?.coerce||!1,typeName:Oe.ZodDate,...Ue(t)});class Wl extends Me{_parse(e){if(this._getType(e)!==fe.symbol){const r=this._getOrReturnCtx(e);return we(r,{code:ie.invalid_type,expected:fe.symbol,received:r.parsedType}),ke}return bn(e.data)}}Wl.create=t=>new Wl({typeName:Oe.ZodSymbol,...Ue(t)});class Xa extends Me{_parse(e){if(this._getType(e)!==fe.undefined){const r=this._getOrReturnCtx(e);return we(r,{code:ie.invalid_type,expected:fe.undefined,received:r.parsedType}),ke}return bn(e.data)}}Xa.create=t=>new Xa({typeName:Oe.ZodUndefined,...Ue(t)});class Qa extends Me{_parse(e){if(this._getType(e)!==fe.null){const r=this._getOrReturnCtx(e);return we(r,{code:ie.invalid_type,expected:fe.null,received:r.parsedType}),ke}return bn(e.data)}}Qa.create=t=>new Qa({typeName:Oe.ZodNull,...Ue(t)});class Bo extends Me{constructor(){super(...arguments),this._any=!0}_parse(e){return bn(e.data)}}Bo.create=t=>new Bo({typeName:Oe.ZodAny,...Ue(t)});class Pi extends Me{constructor(){super(...arguments),this._unknown=!0}_parse(e){return bn(e.data)}}Pi.create=t=>new Pi({typeName:Oe.ZodUnknown,...Ue(t)});class Cs extends Me{_parse(e){const n=this._getOrReturnCtx(e);return we(n,{code:ie.invalid_type,expected:fe.never,received:n.parsedType}),ke}}Cs.create=t=>new Cs({typeName:Oe.ZodNever,...Ue(t)});class Hl extends Me{_parse(e){if(this._getType(e)!==fe.undefined){const r=this._getOrReturnCtx(e);return we(r,{code:ie.invalid_type,expected:fe.void,received:r.parsedType}),ke}return bn(e.data)}}Hl.create=t=>new Hl({typeName:Oe.ZodVoid,...Ue(t)});class Ar extends Me{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==fe.array)return we(n,{code:ie.invalid_type,expected:fe.array,received:n.parsedType}),ke;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(we(n,{code:o?ie.too_big:ie.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(we(n,{code:ie.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(we(n,{code:ie.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Vr(n,o,n.path,a)))).then(o=>dn.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Vr(n,o,n.path,a)));return dn.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Ar({...this._def,minLength:{value:e,message:Ie.toString(n)}})}max(e,n){return new Ar({...this._def,maxLength:{value:e,message:Ie.toString(n)}})}length(e,n){return new Ar({...this._def,exactLength:{value:e,message:Ie.toString(n)}})}nonempty(e){return this.min(1,e)}}Ar.create=(t,e)=>new Ar({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Oe.ZodArray,...Ue(e)});function wo(t){if(t instanceof Ct){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=gs.create(wo(r))}return new Ct({...t._def,shape:()=>e})}else return t instanceof Ar?new Ar({...t._def,type:wo(t.element)}):t instanceof gs?gs.create(wo(t.unwrap())):t instanceof Mi?Mi.create(wo(t.unwrap())):t instanceof Kr?Kr.create(t.items.map(e=>wo(e))):t}class Ct extends Me{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Je.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==fe.object){const l=this._getOrReturnCtx(e);return we(l,{code:ie.invalid_type,expected:fe.object,received:l.parsedType}),ke}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Cs&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Vr(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Cs){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(we(s,{code:ie.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Vr(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>dn.mergeObjectSync(r,l)):dn.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return Ie.errToObj,new Ct({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=Ie.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new Ct({...this._def,unknownKeys:"strip"})}passthrough(){return new Ct({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ct({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ct({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Oe.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Ct({...this._def,catchall:e})}pick(e){const n={};return Je.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Ct({...this._def,shape:()=>n})}omit(e){const n={};return Je.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Ct({...this._def,shape:()=>n})}deepPartial(){return wo(this)}partial(e){const n={};return Je.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new Ct({...this._def,shape:()=>n})}required(e){const n={};return Je.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof gs;)i=i._def.innerType;n[r]=i}}),new Ct({...this._def,shape:()=>n})}keyof(){return y0(Je.objectKeys(this.shape))}}Ct.create=(t,e)=>new Ct({shape:()=>t,unknownKeys:"strip",catchall:Cs.create(),typeName:Oe.ZodObject,...Ue(e)});Ct.strictCreate=(t,e)=>new Ct({shape:()=>t,unknownKeys:"strict",catchall:Cs.create(),typeName:Oe.ZodObject,...Ue(e)});Ct.lazycreate=(t,e)=>new Ct({shape:t,unknownKeys:"strip",catchall:Cs.create(),typeName:Oe.ZodObject,...Ue(e)});class ec extends Me{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new _r(a.ctx.common.issues));return we(n,{code:ie.invalid_union,unionErrors:o}),ke}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new _r(c));return we(n,{code:ie.invalid_union,unionErrors:a}),ke}}get options(){return this._def.options}}ec.create=(t,e)=>new ec({options:t,typeName:Oe.ZodUnion,...Ue(e)});const _l=t=>t instanceof rc?_l(t.schema):t instanceof Ir?_l(t.innerType()):t instanceof sc?[t.value]:t instanceof ii?t.options:t instanceof ic?Object.keys(t.enum):t instanceof oc?_l(t._def.innerType):t instanceof Xa?[void 0]:t instanceof Qa?[null]:null;class Cu extends Me{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.object)return we(n,{code:ie.invalid_type,expected:fe.object,received:n.parsedType}),ke;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(we(n,{code:ie.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ke)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=_l(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Cu({typeName:Oe.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...Ue(r)})}}function Ch(t,e){const n=Hs(t),r=Hs(e);if(t===e)return{valid:!0,data:t};if(n===fe.object&&r===fe.object){const s=Je.objectKeys(e),i=Je.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=Ch(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===fe.array&&r===fe.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=Ch(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===fe.date&&r===fe.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class tc extends Me{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(Eh(i)||Eh(o))return ke;const a=Ch(i.value,o.value);return a.valid?((bh(i)||bh(o))&&n.dirty(),{status:n.value,value:a.data}):(we(r,{code:ie.invalid_intersection_types}),ke)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}tc.create=(t,e,n)=>new tc({left:t,right:e,typeName:Oe.ZodIntersection,...Ue(n)});class Kr extends Me{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.array)return we(r,{code:ie.invalid_type,expected:fe.array,received:r.parsedType}),ke;if(r.data.length<this._def.items.length)return we(r,{code:ie.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ke;!this._def.rest&&r.data.length>this._def.items.length&&(we(r,{code:ie.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Vr(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>dn.mergeArray(n,o)):dn.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Kr({...this._def,rest:e})}}Kr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kr({items:t,typeName:Oe.ZodTuple,rest:null,...Ue(e)})};class nc extends Me{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.object)return we(r,{code:ie.invalid_type,expected:fe.object,received:r.parsedType}),ke;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Vr(r,a,r.path,a)),value:o._parse(new Vr(r,r.data[a],r.path,a))});return r.common.async?dn.mergeObjectAsync(n,s):dn.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Me?new nc({keyType:e,valueType:n,typeName:Oe.ZodRecord,...Ue(r)}):new nc({keyType:vr.create(),valueType:e,typeName:Oe.ZodRecord,...Ue(n)})}}class ql extends Me{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.map)return we(r,{code:ie.invalid_type,expected:fe.map,received:r.parsedType}),ke;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Vr(r,a,r.path,[l,"key"])),value:i._parse(new Vr(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return ke;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return ke;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}ql.create=(t,e,n)=>new ql({valueType:e,keyType:t,typeName:Oe.ZodMap,...Ue(n)});class Li extends Me{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==fe.set)return we(r,{code:ie.invalid_type,expected:fe.set,received:r.parsedType}),ke;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(we(r,{code:ie.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(we(r,{code:ie.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return ke;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Vr(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new Li({...this._def,minSize:{value:e,message:Ie.toString(n)}})}max(e,n){return new Li({...this._def,maxSize:{value:e,message:Ie.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Li.create=(t,e)=>new Li({valueType:t,minSize:null,maxSize:null,typeName:Oe.ZodSet,...Ue(e)});class To extends Me{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.function)return we(n,{code:ie.invalid_type,expected:fe.function,received:n.parsedType}),ke;function r(a,c){return Fl({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Ml(),Ya].filter(l=>!!l),issueData:{code:ie.invalid_arguments,argumentsError:c}})}function s(a,c){return Fl({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Ml(),Ya].filter(l=>!!l),issueData:{code:ie.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Lo){const a=this;return bn(async function(...c){const l=new _r([]),u=await a._def.args.parseAsync(c,i).catch(p=>{throw l.addIssue(r(c,p)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(p=>{throw l.addIssue(s(d,p)),l})})}else{const a=this;return bn(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new _r([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new _r([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new To({...this._def,args:Kr.create(e).rest(Pi.create())})}returns(e){return new To({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new To({args:e||Kr.create([]).rest(Pi.create()),returns:n||Pi.create(),typeName:Oe.ZodFunction,...Ue(r)})}}class rc extends Me{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}rc.create=(t,e)=>new rc({getter:t,typeName:Oe.ZodLazy,...Ue(e)});class sc extends Me{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return we(n,{received:n.data,code:ie.invalid_literal,expected:this._def.value}),ke}return{status:"valid",value:e.data}}get value(){return this._def.value}}sc.create=(t,e)=>new sc({value:t,typeName:Oe.ZodLiteral,...Ue(e)});function y0(t,e){return new ii({values:t,typeName:Oe.ZodEnum,...Ue(e)})}class ii extends Me{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return we(n,{expected:Je.joinValues(r),received:n.parsedType,code:ie.invalid_type}),ke}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return we(n,{received:n.data,code:ie.invalid_enum_value,options:r}),ke}return bn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return ii.create(e)}exclude(e){return ii.create(this.options.filter(n=>!e.includes(n)))}}ii.create=y0;class ic extends Me{_parse(e){const n=Je.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==fe.string&&r.parsedType!==fe.number){const s=Je.objectValues(n);return we(r,{expected:Je.joinValues(s),received:r.parsedType,code:ie.invalid_type}),ke}if(n.indexOf(e.data)===-1){const s=Je.objectValues(n);return we(r,{received:r.data,code:ie.invalid_enum_value,options:s}),ke}return bn(e.data)}get enum(){return this._def.values}}ic.create=(t,e)=>new ic({values:t,typeName:Oe.ZodNativeEnum,...Ue(e)});class Lo extends Me{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==fe.promise&&n.common.async===!1)return we(n,{code:ie.invalid_type,expected:fe.promise,received:n.parsedType}),ke;const r=n.parsedType===fe.promise?n.data:Promise.resolve(n.data);return bn(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Lo.create=(t,e)=>new Lo({type:t,typeName:Oe.ZodPromise,...Ue(e)});class Ir extends Me{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{we(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?ke:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?ke:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Za(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Za(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);Je.assertNever(s)}}Ir.create=(t,e,n)=>new Ir({schema:t,typeName:Oe.ZodEffects,effect:e,...Ue(n)});Ir.createWithPreprocess=(t,e,n)=>new Ir({schema:e,effect:{type:"preprocess",transform:t},typeName:Oe.ZodEffects,...Ue(n)});class gs extends Me{_parse(e){return this._getType(e)===fe.undefined?bn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}gs.create=(t,e)=>new gs({innerType:t,typeName:Oe.ZodOptional,...Ue(e)});class Mi extends Me{_parse(e){return this._getType(e)===fe.null?bn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Mi.create=(t,e)=>new Mi({innerType:t,typeName:Oe.ZodNullable,...Ue(e)});class oc extends Me{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===fe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}oc.create=(t,e)=>new oc({innerType:t,typeName:Oe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ue(e)});class zl extends Me{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return jl(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new _r(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new _r(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}zl.create=(t,e)=>new zl({innerType:t,typeName:Oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ue(e)});class Vl extends Me{_parse(e){if(this._getType(e)!==fe.nan){const r=this._getOrReturnCtx(e);return we(r,{code:ie.invalid_type,expected:fe.nan,received:r.parsedType}),ke}return{status:"valid",value:e.data}}}Vl.create=t=>new Vl({typeName:Oe.ZodNaN,...Ue(t)});const bA=Symbol("zod_brand");class w0 extends Me{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class _c extends Me{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ke:i.status==="dirty"?(n.dirty(),m0(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?ke:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new _c({in:e,out:n,typeName:Oe.ZodPipeline})}}class Kl extends Me{_parse(e){const n=this._def.innerType._parse(e);return Za(n)&&(n.value=Object.freeze(n.value)),n}}Kl.create=(t,e)=>new Kl({innerType:t,typeName:Oe.ZodReadonly,...Ue(e)});const E0=(t,e={},n)=>t?Bo.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):Bo.create(),CA={object:Ct.lazycreate};var Oe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Oe||(Oe={}));const vA=(t,e={message:`Input not instance of ${t.name}`})=>E0(n=>n instanceof t,e),b0=vr.create,C0=ri.create,_A=Vl.create,AA=si.create,v0=Ja.create,SA=Bi.create,IA=Wl.create,TA=Xa.create,NA=Qa.create,xA=Bo.create,OA=Pi.create,RA=Cs.create,kA=Hl.create,PA=Ar.create,DA=Ct.create,UA=Ct.strictCreate,$A=ec.create,BA=Cu.create,LA=tc.create,MA=Kr.create,FA=nc.create,jA=ql.create,WA=Li.create,HA=To.create,qA=rc.create,zA=sc.create,VA=ii.create,KA=ic.create,GA=Lo.create,tg=Ir.create,YA=gs.create,ZA=Mi.create,JA=Ir.createWithPreprocess,XA=_c.create,QA=()=>b0().optional(),e1=()=>C0().optional(),t1=()=>v0().optional(),n1={string:t=>vr.create({...t,coerce:!0}),number:t=>ri.create({...t,coerce:!0}),boolean:t=>Ja.create({...t,coerce:!0}),bigint:t=>si.create({...t,coerce:!0}),date:t=>Bi.create({...t,coerce:!0})},r1=ke;var C=Object.freeze({__proto__:null,defaultErrorMap:Ya,setErrorMap:aA,getErrorMap:Ml,makeIssue:Fl,EMPTY_PATH:cA,addIssueToContext:we,ParseStatus:dn,INVALID:ke,DIRTY:m0,OK:bn,isAborted:Eh,isDirty:bh,isValid:Za,isAsync:jl,get util(){return Je},get objectUtil(){return wh},ZodParsedType:fe,getParsedType:Hs,ZodType:Me,ZodString:vr,ZodNumber:ri,ZodBigInt:si,ZodBoolean:Ja,ZodDate:Bi,ZodSymbol:Wl,ZodUndefined:Xa,ZodNull:Qa,ZodAny:Bo,ZodUnknown:Pi,ZodNever:Cs,ZodVoid:Hl,ZodArray:Ar,ZodObject:Ct,ZodUnion:ec,ZodDiscriminatedUnion:Cu,ZodIntersection:tc,ZodTuple:Kr,ZodRecord:nc,ZodMap:ql,ZodSet:Li,ZodFunction:To,ZodLazy:rc,ZodLiteral:sc,ZodEnum:ii,ZodNativeEnum:ic,ZodPromise:Lo,ZodEffects:Ir,ZodTransformer:Ir,ZodOptional:gs,ZodNullable:Mi,ZodDefault:oc,ZodCatch:zl,ZodNaN:Vl,BRAND:bA,ZodBranded:w0,ZodPipeline:_c,ZodReadonly:Kl,custom:E0,Schema:Me,ZodSchema:Me,late:CA,get ZodFirstPartyTypeKind(){return Oe},coerce:n1,any:xA,array:PA,bigint:AA,boolean:v0,date:SA,discriminatedUnion:BA,effect:tg,enum:VA,function:HA,instanceof:vA,intersection:LA,lazy:qA,literal:zA,map:jA,nan:_A,nativeEnum:KA,never:RA,null:NA,nullable:ZA,number:C0,object:DA,oboolean:t1,onumber:e1,optional:YA,ostring:QA,pipeline:XA,preprocess:JA,promise:GA,record:FA,set:WA,strictObject:UA,string:b0,symbol:IA,transformer:tg,tuple:MA,undefined:TA,union:$A,unknown:OA,void:kA,NEVER:r1,ZodIssueCode:ie,quotelessJson:oA,ZodError:_r});const At=C.object({message:C.string()});function ge(t){return C.literal(Ee[t])}const vu=C.object({serializedMessage:C.string().optional(),accountAddress:C.string(),chainId:C.string(),notBefore:C.string().optional(),domain:C.string(),uri:C.string(),version:C.string(),nonce:C.string(),statement:C.string().optional(),resources:C.array(C.string()).optional(),requestId:C.string().optional(),issuedAt:C.string().optional(),expirationTime:C.string().optional()});C.object({accessList:C.array(C.string()),blockHash:C.string().nullable(),blockNumber:C.string().nullable(),chainId:C.string().or(C.number()),from:C.string(),gas:C.string(),hash:C.string(),input:C.string().nullable(),maxFeePerGas:C.string(),maxPriorityFeePerGas:C.string(),nonce:C.string(),r:C.string(),s:C.string(),to:C.string(),transactionIndex:C.string().nullable(),type:C.string(),v:C.string(),value:C.string()});const s1=C.object({chainId:C.string().or(C.number()),rpcUrl:C.optional(C.string())}),i1=C.object({email:C.string().email()}),o1=C.object({otp:C.string()}),a1=C.object({uri:C.string(),preferredAccountType:C.optional(C.string()),chainId:C.optional(C.string().or(C.number())),siwxMessage:C.optional(vu),rpcUrl:C.optional(C.string())}),c1=C.object({chainId:C.optional(C.string().or(C.number())),preferredAccountType:C.optional(C.string()),socialUri:C.optional(C.string()),siwxMessage:C.optional(vu),rpcUrl:C.optional(C.string())}),l1=C.object({provider:C.enum(["google","github","apple","facebook","x","discord"])}),u1=C.object({email:C.string().email()}),d1=C.object({otp:C.string()}),h1=C.object({otp:C.string()}),f1=C.object({themeMode:C.optional(C.enum(["light","dark"])),themeVariables:C.optional(C.record(C.string(),C.string().or(C.number()))),w3mThemeVariables:C.optional(C.record(C.string(),C.string()))}),p1=C.object({metadata:C.object({name:C.string(),description:C.string(),url:C.string(),icons:C.array(C.string())}).optional(),sdkVersion:C.string().optional(),sdkType:C.string().optional(),projectId:C.string()}),g1=C.object({type:C.string()}),m1=C.object({action:C.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),y1=C.object({url:C.string()}),w1=C.object({userName:C.string()}),E1=C.object({email:C.string().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),accounts:C.array(C.object({address:C.string(),type:C.enum([yt.ACCOUNT_TYPES.EOA,yt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:C.string().optional().nullable(),preferredAccountType:C.optional(C.string()),signature:C.string().optional(),message:C.string().optional(),siwxMessage:C.optional(vu)}),b1=C.object({action:C.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),C1=C.object({email:C.string().email().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),smartAccountDeployed:C.optional(C.boolean()),accounts:C.array(C.object({address:C.string(),type:C.enum([yt.ACCOUNT_TYPES.EOA,yt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:C.optional(C.string()),signature:C.string().optional(),message:C.string().optional(),siwxMessage:C.optional(vu)}),v1=C.object({uri:C.string()}),_1=C.object({isConnected:C.boolean()}),A1=C.object({chainId:C.string().or(C.number())}),S1=C.object({chainId:C.string().or(C.number())}),I1=C.object({newEmail:C.string().email()}),T1=C.object({smartAccountEnabledNetworks:C.array(C.number())});C.object({address:C.string(),isDeployed:C.boolean()});const N1=C.object({version:C.string().optional()}),x1=C.object({type:C.string(),address:C.string()}),O1=C.any(),R1=C.object({method:C.literal("eth_accounts")}),k1=C.object({method:C.literal("eth_blockNumber")}),P1=C.object({method:C.literal("eth_call"),params:C.array(C.any())}),D1=C.object({method:C.literal("eth_chainId")}),U1=C.object({method:C.literal("eth_estimateGas"),params:C.array(C.any())}),$1=C.object({method:C.literal("eth_feeHistory"),params:C.array(C.any())}),B1=C.object({method:C.literal("eth_gasPrice")}),L1=C.object({method:C.literal("eth_getAccount"),params:C.array(C.any())}),M1=C.object({method:C.literal("eth_getBalance"),params:C.array(C.any())}),F1=C.object({method:C.literal("eth_getBlockByHash"),params:C.array(C.any())}),j1=C.object({method:C.literal("eth_getBlockByNumber"),params:C.array(C.any())}),W1=C.object({method:C.literal("eth_getBlockReceipts"),params:C.array(C.any())}),H1=C.object({method:C.literal("eth_getBlockTransactionCountByHash"),params:C.array(C.any())}),q1=C.object({method:C.literal("eth_getBlockTransactionCountByNumber"),params:C.array(C.any())}),z1=C.object({method:C.literal("eth_getCode"),params:C.array(C.any())}),V1=C.object({method:C.literal("eth_getFilterChanges"),params:C.array(C.any())}),K1=C.object({method:C.literal("eth_getFilterLogs"),params:C.array(C.any())}),G1=C.object({method:C.literal("eth_getLogs"),params:C.array(C.any())}),Y1=C.object({method:C.literal("eth_getProof"),params:C.array(C.any())}),Z1=C.object({method:C.literal("eth_getStorageAt"),params:C.array(C.any())}),J1=C.object({method:C.literal("eth_getTransactionByBlockHashAndIndex"),params:C.array(C.any())}),X1=C.object({method:C.literal("eth_getTransactionByBlockNumberAndIndex"),params:C.array(C.any())}),Q1=C.object({method:C.literal("eth_getTransactionByHash"),params:C.array(C.any())}),eS=C.object({method:C.literal("eth_getTransactionCount"),params:C.array(C.any())}),tS=C.object({method:C.literal("eth_getTransactionReceipt"),params:C.array(C.any())}),nS=C.object({method:C.literal("eth_getUncleCountByBlockHash"),params:C.array(C.any())}),rS=C.object({method:C.literal("eth_getUncleCountByBlockNumber"),params:C.array(C.any())}),sS=C.object({method:C.literal("eth_maxPriorityFeePerGas")}),iS=C.object({method:C.literal("eth_newBlockFilter")}),oS=C.object({method:C.literal("eth_newFilter"),params:C.array(C.any())}),aS=C.object({method:C.literal("eth_newPendingTransactionFilter")}),cS=C.object({method:C.literal("eth_sendRawTransaction"),params:C.array(C.any())}),lS=C.object({method:C.literal("eth_syncing"),params:C.array(C.any())}),uS=C.object({method:C.literal("eth_uninstallFilter"),params:C.array(C.any())}),ng=C.object({method:C.literal("personal_sign"),params:C.array(C.any())}),dS=C.object({method:C.literal("eth_signTypedData_v4"),params:C.array(C.any())}),hS=C.object({method:C.literal("eth_sendTransaction"),params:C.array(C.any())}),fS=C.object({method:C.literal("solana_signMessage"),params:C.object({message:C.string(),pubkey:C.string()})}),pS=C.object({method:C.literal("solana_signTransaction"),params:C.object({transaction:C.string()})}),gS=C.object({method:C.literal("solana_signAllTransactions"),params:C.object({transactions:C.array(C.string())})}),mS=C.object({method:C.literal("solana_signAndSendTransaction"),params:C.object({transaction:C.string(),options:C.object({skipPreflight:C.boolean().optional(),preflightCommitment:C.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:C.number().optional(),minContextSlot:C.number().optional()}).optional()})}),yS=C.object({method:C.literal("wallet_sendCalls"),params:C.array(C.object({chainId:C.string().or(C.number()).optional(),from:C.string().optional(),version:C.string().optional(),capabilities:C.any().optional(),calls:C.array(C.object({to:C.string().startsWith("0x"),data:C.string().startsWith("0x").optional(),value:C.string().optional()}))}))}),wS=C.object({method:C.literal("wallet_getCallsStatus"),params:C.array(C.string())}),ES=C.object({method:C.literal("wallet_getCapabilities"),params:C.array(C.string().or(C.number()).optional()).optional()}),bS=C.object({method:C.literal("wallet_grantPermissions"),params:C.array(C.any())}),CS=C.object({method:C.literal("wallet_revokePermissions"),params:C.any()}),vS=C.object({method:C.literal("wallet_getAssets"),params:C.any()}),rg=C.object({token:C.string()}),me=C.object({id:C.string().optional()}),sd={appEvent:me.extend({type:ge("APP_SWITCH_NETWORK"),payload:s1}).or(me.extend({type:ge("APP_CONNECT_EMAIL"),payload:i1})).or(me.extend({type:ge("APP_CONNECT_DEVICE")})).or(me.extend({type:ge("APP_CONNECT_OTP"),payload:o1})).or(me.extend({type:ge("APP_CONNECT_SOCIAL"),payload:a1})).or(me.extend({type:ge("APP_GET_FARCASTER_URI")})).or(me.extend({type:ge("APP_CONNECT_FARCASTER")})).or(me.extend({type:ge("APP_GET_USER"),payload:C.optional(c1)})).or(me.extend({type:ge("APP_GET_SOCIAL_REDIRECT_URI"),payload:l1})).or(me.extend({type:ge("APP_SIGN_OUT")})).or(me.extend({type:ge("APP_IS_CONNECTED"),payload:C.optional(rg)})).or(me.extend({type:ge("APP_GET_CHAIN_ID")})).or(me.extend({type:ge("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(me.extend({type:ge("APP_INIT_SMART_ACCOUNT")})).or(me.extend({type:ge("APP_SET_PREFERRED_ACCOUNT"),payload:g1})).or(me.extend({type:ge("APP_RPC_REQUEST"),payload:ng.or(vS).or(R1).or(k1).or(P1).or(D1).or(U1).or($1).or(B1).or(L1).or(M1).or(F1).or(j1).or(W1).or(H1).or(q1).or(z1).or(V1).or(K1).or(G1).or(Y1).or(Z1).or(J1).or(X1).or(Q1).or(eS).or(tS).or(nS).or(rS).or(sS).or(iS).or(oS).or(aS).or(cS).or(lS).or(uS).or(ng).or(dS).or(hS).or(fS).or(pS).or(gS).or(mS).or(wS).or(yS).or(ES).or(bS).or(CS).and(C.object({chainId:C.string().or(C.number()).optional(),chainNamespace:C.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:C.string().optional()}))})).or(me.extend({type:ge("APP_UPDATE_EMAIL"),payload:u1})).or(me.extend({type:ge("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:d1})).or(me.extend({type:ge("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:h1})).or(me.extend({type:ge("APP_SYNC_THEME"),payload:f1})).or(me.extend({type:ge("APP_SYNC_DAPP_DATA"),payload:p1})).or(me.extend({type:ge("APP_RELOAD")})).or(me.extend({type:ge("APP_RPC_ABORT")})),frameEvent:me.extend({type:ge("FRAME_SWITCH_NETWORK_ERROR"),payload:At}).or(me.extend({type:ge("FRAME_SWITCH_NETWORK_SUCCESS"),payload:S1})).or(me.extend({type:ge("FRAME_CONNECT_EMAIL_SUCCESS"),payload:m1})).or(me.extend({type:ge("FRAME_CONNECT_EMAIL_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:y1})).or(me.extend({type:ge("FRAME_GET_FARCASTER_URI_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:w1})).or(me.extend({type:ge("FRAME_CONNECT_FARCASTER_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_CONNECT_OTP_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_CONNECT_OTP_SUCCESS")})).or(me.extend({type:ge("FRAME_CONNECT_DEVICE_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_CONNECT_DEVICE_SUCCESS")})).or(me.extend({type:ge("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:E1})).or(me.extend({type:ge("FRAME_CONNECT_SOCIAL_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_GET_USER_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_GET_USER_SUCCESS"),payload:C1})).or(me.extend({type:ge("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:v1})).or(me.extend({type:ge("FRAME_SIGN_OUT_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_SIGN_OUT_SUCCESS")})).or(me.extend({type:ge("FRAME_IS_CONNECTED_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_IS_CONNECTED_SUCCESS"),payload:_1})).or(me.extend({type:ge("FRAME_GET_CHAIN_ID_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_GET_CHAIN_ID_SUCCESS"),payload:A1})).or(me.extend({type:ge("FRAME_RPC_REQUEST_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_RPC_REQUEST_SUCCESS"),payload:O1})).or(me.extend({type:ge("FRAME_SESSION_UPDATE"),payload:rg})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_SUCCESS"),payload:b1})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:I1})).or(me.extend({type:ge("FRAME_SYNC_THEME_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_SYNC_THEME_SUCCESS")})).or(me.extend({type:ge("FRAME_SYNC_DAPP_DATA_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(me.extend({type:ge("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:T1})).or(me.extend({type:ge("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:x1})).or(me.extend({type:ge("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_READY"),payload:N1})).or(me.extend({type:ge("FRAME_RELOAD_ERROR"),payload:At})).or(me.extend({type:ge("FRAME_RELOAD_SUCCESS")}))};function id(t,e={}){return typeof e?.type=="string"&&e?.type?.includes(t)}function _S({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=$.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(rA);i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",iA),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r);const o=$t.get("dapp_smart_account_version");return o&&(o==="v6"||o==="v7")&&(console.warn(">> AppKit - Forcing smart account version",o),i.searchParams.set("smartAccountVersion",o)),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class AS{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=$.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:d}){if(!id(Ee.FRAME_EVENT_KEY,d))return;const h=sd.frameEvent.safeParse(d);if(!h.success){console.warn("W3mFrame: invalid frame event",h.error.message);return}h.data?.id===a&&(c(h.data),window.removeEventListener("message",u))}Kn.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{Kn.isClient&&window.addEventListener("message",({data:c})=>{if(!id(Ee.FRAME_EVENT_KEY,c))return;const l=sd.frameEvent.safeParse(c);l.success?a(l.data):console.warn("W3mFrame: invalid frame event",l.error.message)})},onAppEvent:a=>{Kn.isClient&&window.addEventListener("message",({data:c})=>{if(!id(Ee.APP_EVENT_KEY,c))return;const l=sd.appEvent.safeParse(c);l.success||console.warn("W3mFrame: invalid app event",l.error.message),a(c)})},postAppEvent:a=>{if(Kn.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(Kn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),Kn.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=_S({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}var Mr={exports:{}};function SS(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var IS=TS;function TS(t,e,n){var r=n&&n.stringify||SS,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-s,d=-1,h=t&&t.length||0,p=0;p<h;){if(t.charCodeAt(p)===37&&p+1<h){switch(d=d>-1?d:0,t.charCodeAt(p+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<p&&(l+=t.slice(d,p)),l+=Number(e[u]),d=p+2,p++;break;case 105:if(u>=c||e[u]==null)break;d<p&&(l+=t.slice(d,p)),l+=Math.floor(Number(e[u])),d=p+2,p++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<p&&(l+=t.slice(d,p));var m=typeof e[u];if(m==="string"){l+="'"+e[u]+"'",d=p+2,p++;break}if(m==="function"){l+=e[u].name||"<anonymous>",d=p+2,p++;break}l+=r(e[u]),d=p+2,p++;break;case 115:if(u>=c)break;d<p&&(l+=t.slice(d,p)),l+=String(e[u]),d=p+2,p++;break;case 37:d<p&&(l+=t.slice(d,p)),l+="%",d=p+2,p++,u--;break}++u}++p}return d===-1?t:(d<h&&(l+=t.slice(d)),l)}const sg=IS;Mr.exports=ms;const ac=WS().console||{},NS={mapHttpRequest:zc,mapHttpResponse:zc,wrapRequestSerializer:od,wrapResponseSerializer:od,wrapErrorSerializer:od,req:zc,res:zc,err:og,errWithCause:og};function Ys(t,e){return t==="silent"?1/0:e.levels.values[t]}const Ff=Symbol("pino.logFuncs"),vh=Symbol("pino.hierarchy"),xS={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function ig(t,e){const n={logger:e,parent:t[vh]};e[vh]=n}function OS(t,e,n){const r={};e.forEach(s=>{r[s]=n[s]?n[s]:ac[s]||ac[xS[s]||"log"]||No}),t[Ff]=r}function RS(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function ms(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||ac;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=RS(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=Object.keys(t.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof n=="function"&&a.forEach(function(w){n[w]=n}),(t.enabled===!1||t.browser.disabled)&&(t.level="silent");const c=t.level||"info",l=Object.create(n);l.log||(l.log=No),OS(l,a,n),ig({},l),Object.defineProperty(l,"levelVal",{get:d}),Object.defineProperty(l,"level",{get:h,set:p});const u={transmit:e,serialize:s,asObject:t.browser.asObject,asObjectBindingsOnly:t.browser.asObjectBindingsOnly,formatters:t.browser.formatters,levels:a,timestamp:MS(t),messageKey:t.messageKey||"msg",onChild:t.onChild||No};l.levels=kS(t),l.level=c,l.isLevelEnabled=function(w){return this.levels.values[w]?this.levels.values[w]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=No,l.serializers=r,l._serialize=s,l._stdErrSerialize=i,l.child=function(...w){return m.call(this,u,...w)},e&&(l._logEvent=_h());function d(){return Ys(this.level,this)}function h(){return this._level}function p(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,ui(this,u,l,"error"),ui(this,u,l,"fatal"),ui(this,u,l,"warn"),ui(this,u,l,"info"),ui(this,u,l,"debug"),ui(this,u,l,"trace"),o.forEach(b=>{ui(this,u,l,b)})}function m(w,b,R){if(!b)throw new Error("missing bindings for child Pino");R=R||{},s&&b.serializers&&(R.serializers=b.serializers);const k=R.serializers;if(s&&k){var S=Object.assign({},r,k),O=t.browser.serialize===!0?Object.keys(S):s;delete b.serializers,jf([b],O,S,this._stdErrSerialize)}function U(q){this._childLevel=(q._childLevel|0)+1,this.bindings=b,S&&(this.serializers=S,this._serialize=O),e&&(this._logEvent=_h([].concat(q._logEvent.bindings,b)))}U.prototype=this;const F=new U(this);return ig(this,F),F.child=function(...q){return m.call(this,w,...q)},F.level=R.level||this.level,w.onChild(F),F}return l}function kS(t){const e=t.customLevels||{},n=Object.assign({},ms.levels.values,e),r=Object.assign({},ms.levels.labels,PS(e));return{values:n,labels:r}}function PS(t){const e={};return Object.keys(t).forEach(function(n){e[t[n]]=n}),e}ms.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},ms.stdSerializers=NS,ms.stdTimeFunctions=Object.assign({},{nullTime:_0,epochTime:A0,unixTime:FS,isoTime:jS});function DS(t){const e=[];t.bindings&&e.push(t.bindings);let n=t[vh];for(;n.parent;)n=n.parent,n.logger.bindings&&e.push(n.logger.bindings);return e.reverse()}function ui(t,e,n,r){if(Object.defineProperty(t,r,{value:Ys(t.level,n)>Ys(r,n)?No:n[Ff][r],writable:!0,enumerable:!0,configurable:!0}),t[r]===No){if(!e.transmit)return;const i=e.transmit.level||t.level,o=Ys(i,n);if(Ys(r,n)<o)return}t[r]=$S(t,e,n,r);const s=DS(t);s.length!==0&&(t[r]=US(s,t[r]))}function US(t,e){return function(){return e.apply(this,[...t,...arguments])}}function $S(t,e,n,r){return function(s){return function(){const i=e.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ac?ac:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];var l=!1;if(e.serialize&&(jf(o,this._serialize,this.serializers,this._stdErrSerialize),l=!0),e.asObject||e.formatters?s.call(a,...BS(this,r,o,i,e)):s.apply(a,o),e.transmit){const u=e.transmit.level||t._level,d=Ys(u,n),h=Ys(r,n);if(h<d)return;LS(this,{ts:i,methodLevel:r,methodValue:h,transmitValue:n.levels.values[e.transmit.level||t._level],send:e.transmit.send,val:Ys(t._level,n)},o,l)}}}(t[Ff][r])}function BS(t,e,n,r,s){const{level:i,log:o=d=>d}=s.formatters||{},a=n.slice();let c=a[0];const l={};let u=(t._childLevel|0)+1;if(u<1&&(u=1),r&&(l.time=r),i){const d=i(e,t.levels.values[e]);Object.assign(l,d)}else l.level=t.levels.values[e];if(s.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?sg(a.shift(),a):void 0}else typeof c=="string"&&(c=sg(a.shift(),a));return c!==void 0&&(l[s.messageKey]=c),[o(l)]}}function jf(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=ms.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s])&&e)for(const i in t[s])e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function LS(t,e,n,r=!1){const s=e.send,i=e.ts,o=e.methodLevel,a=e.methodValue,c=e.val,l=t._logEvent.bindings;r||jf(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=n.filter(function(u){return l.indexOf(u)===-1}),t._logEvent.level.label=o,t._logEvent.level.value=a,s(o,t._logEvent,c),t._logEvent=_h(l)}function _h(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function og(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function MS(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?_0:A0}function zc(){return{}}function od(t){return t}function No(){}function _0(){return!1}function A0(){return Date.now()}function FS(){return Math.round(Date.now()/1e3)}function jS(){return new Date(Date.now()).toISOString()}function WS(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}Mr.exports.default=ms;Mr.exports.pino=ms;const HS={level:"info"},_u="custom_context",Wf=1e3*1024;var qS=Object.defineProperty,zS=(t,e,n)=>e in t?qS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qs=(t,e,n)=>zS(t,typeof e!="symbol"?e+"":e,n);let VS=class{constructor(e){qs(this,"nodeValue"),qs(this,"sizeInBytes"),qs(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},ag=class{constructor(e){qs(this,"lengthInNodes"),qs(this,"sizeInBytes"),qs(this,"head"),qs(this,"tail"),qs(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new VS(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}};const KS=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n);function cg(t){return typeof t=="string"?t:KS(t)||""}var GS=Object.defineProperty,YS=(t,e,n)=>e in t?GS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vc=(t,e,n)=>YS(t,typeof e!="symbol"?e+"":e,n);let S0=class{constructor(e,n=Wf){Vc(this,"logs"),Vc(this,"level"),Vc(this,"levelValue"),Vc(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Mr.exports.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new ag(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===Mr.exports.levels.values.error?console.error(e):n===Mr.exports.levels.values.warn?console.warn(e):n===Mr.exports.levels.values.debug?console.debug(e):n===Mr.exports.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(cg({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new ag(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(cg({extraMetadata:e})),new Blob(n,{type:"application/json"})}};var ZS=Object.defineProperty,JS=(t,e,n)=>e in t?ZS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,XS=(t,e,n)=>JS(t,e+"",n);let QS=class{constructor(e,n=Wf){XS(this,"baseChunkLogger"),this.baseChunkLogger=new S0(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}};var eI=Object.defineProperty,tI=(t,e,n)=>e in t?eI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nI=(t,e,n)=>tI(t,e+"",n);let rI=class{constructor(e,n=Wf){nI(this,"baseChunkLogger"),this.baseChunkLogger=new S0(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var sI=Object.defineProperty,iI=Object.defineProperties,oI=Object.getOwnPropertyDescriptors,lg=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,cI=Object.prototype.propertyIsEnumerable,ug=(t,e,n)=>e in t?sI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xs=(t,e)=>{for(var n in e||(e={}))aI.call(e,n)&&ug(t,n,e[n]);if(lg)for(var n of lg(e))cI.call(e,n)&&ug(t,n,e[n]);return t},Qs=(t,e)=>iI(t,oI(e));function Hf(t){return Qs(Xs({},t),{level:t?.level||HS.level})}function lI(t,e,n=_u){return t[n]=e,t}function $n(t,e=_u){return t[e]||""}function uI(t,e,n=_u){const r=$n(t,n);return r.trim()?`${r}/${e}`:e}function Bn(t,e,n=_u){const r=uI(t,e,n),s=t.child({context:r});return lI(s,r,n)}function dI(t){var e,n;const r=new QS((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Mr.exports(Qs(Xs({},t.opts),{level:"trace",browser:Qs(Xs({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function hI(t){var e,n;const r=new rI((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Mr.exports(Qs(Xs({},t.opts),{level:"trace",browser:Qs(Xs({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})}),r),chunkLoggerController:r}}function Au(t){var e;if(typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string")return{logger:t.loggerOverride,chunkLoggerController:null};const n=Qs(Xs({},t.opts),{level:typeof t.loggerOverride=="string"?t.loggerOverride:(e=t.opts)==null?void 0:e.level});return typeof window<"u"?dI(Qs(Xs({},t),{opts:n})):hI(Qs(Xs({},t),{opts:n}))}class fI{constructor(e){const n=Hf({level:sA}),{logger:r,chunkLoggerController:s}=Au({opts:n});this.logger=Bn(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class pI{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c,metadata:l,sdkVersion:u,sdkType:d}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new fI(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const h=this.getRpcUrl(n);this.projectId=e,this.sdkVersion=u,this.sdkType=d,this.metadata=l,this.w3mFrame=new AS({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:h,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===Ee.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,await this.syncDappData({metadata:this.metadata,projectId:this.projectId,sdkVersion:this.sdkVersion,sdkType:this.sdkType}),await this.getSmartAccountEnabledNetworks(),this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!$t.get(Ee.EMAIL_LOGIN_USED_KEY)}getEmail(){return $t.get(Ee.EMAIL)}getUsername(){return $t.get(Ee.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:Ee.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{Kn.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:Ee.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){try{return this.appEvent({type:Ee.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:Ee.APP_CONNECT_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:Ee.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:Ee.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:Ee.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){try{const n=await this.appEvent({type:Ee.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:Ee.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){try{const n=await this.appEvent({type:Ee.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){try{return this.appEvent({type:Ee.APP_SYNC_THEME,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){try{return this.appEvent({type:Ee.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:Ee.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:Ee.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){if(e?.socialUri)try{await this.init();const n=this.getRpcUrl(e.chainId),r=await this.appEvent({type:Ee.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:n}});return r.userName&&this.setSocialLoginSuccess(r.userName),this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting social"),n}else try{const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.getUser({chainId:n,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(n)});return this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async getUser(e){try{await this.init();const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.appEvent({type:Ee.APP_GET_USER,payload:{...e,chainId:n,rpcUrl:this.getRpcUrl(n)}});return this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){try{await this.init();const s=this.getRpcUrl(n),i=await this.appEvent({type:Ee.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:s,preferredAccountType:r}});return i.userName&&this.setSocialLoginSuccess(i.userName),i}catch(s){throw this.w3mLogger?.logger.error({error:s},"Error connecting social"),s}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:Ee.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:Ee.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const n=this.getRpcUrl(e),r=await this.appEvent({type:Ee.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:n}});return this.setLastUsedChainId(r.chainId),r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error switching network"),n}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const r=setTimeout(()=>{n()},3e3);await this.appEvent({type:Ee.APP_SIGN_OUT}),clearTimeout(r),n()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const n=e;try{if(yt.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const r=e.chainNamespace||"eip155",s=this.getActiveCaipNetwork(r)?.id;n.chainNamespace=r,n.chainId=s,n.rpcUrl=this.getRpcUrl(s),this.rpcRequestHandler?.(e);const i=await this.appEvent({type:Ee.APP_RPC_REQUEST,payload:n});return this.rpcSuccessHandler?.(i,n),i}catch(r){throw this.rpcErrorHandler?.(r,n),this.w3mLogger?.logger.error({error:r},"Error requesting"),r}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ee.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ee.FRAME_IS_CONNECTED_ERROR&&e(),n.type===Ee.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ee.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ee.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ee.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===Ee.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:yt.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:e,method:n})=>{yt.SAFE_RPC_METHODS.includes(n)||e.abort(),await this.appEvent({type:Ee.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[Ee.APP_SYNC_DAPP_DATA,Ee.APP_SYNC_THEME,Ee.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[Ee.APP_CONNECT_EMAIL,Ee.APP_CONNECT_DEVICE,Ee.APP_CONNECT_OTP,Ee.APP_CONNECT_SOCIAL,Ee.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{const u=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const p=e;this.openRpcRequests.set(u,{...p.payload,abortController:d})}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});const h=(p,m)=>{p.id===u&&(m?.logger.info?.({framEvent:p,id:u},"Received frame response"),this.openRpcRequests.delete(p.id),p.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in p&&c(p.payload),c(void 0)):p.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in p&&l(new Error(p.payload?.message||"An error occurred")),l(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,p=>h(p,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){$t.set(Ee.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){$t.set(Ee.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&$t.set(Ee.EMAIL,e),$t.set(Ee.EMAIL_LOGIN_USED_KEY,"true"),$t.delete(Ee.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){$t.delete(Ee.EMAIL_LOGIN_USED_KEY),$t.delete(Ee.EMAIL),$t.delete(Ee.LAST_USED_CHAIN_KEY),$t.delete(Ee.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&$t.set(Ee.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=$t.get(Ee.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){$t.set(Ee.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=Lt.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n);return(e?r.find(i=>String(i.id)===String(e)||i.caipNetworkId===e):r[0])?.rpcUrls.default.http?.[0]}}async function Qo(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Ac{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Qo(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await Qo(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Qo(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Qo(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Qo(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const Ah={getFeatureValue(t,e){const n=e?.[t];return n===void 0?Pe.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;let e=t;return se.isTelegram()&&(se.isIos()&&(e=e.filter(n=>n!=="google")),se.isMac()&&(e=e.filter(n=>n!=="x")),se.isAndroid()&&(e=e.filter(n=>!["facebook","x"].includes(n)))),se.isMobile()&&(e=e.filter(n=>n!=="facebook")),e},isSocialsEnabled(){return Array.isArray(K.state.features?.socials)&&K.state.features?.socials.length>0||Array.isArray(K.state.remoteFeatures?.socials)&&K.state.remoteFeatures?.socials.length>0},isEmailEnabled(){return!!(K.state.features?.email||K.state.remoteFeatures?.email)}},ve=tt({features:Pe.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Pe.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1,coinbasePreference:"all"}),K={state:ve,subscribeKey(t,e){return It(ve,t,e)},setOptions(t){Object.assign(ve,t)},setRemoteFeatures(t){if(!t)return;const e={...ve.remoteFeatures,...t};ve.remoteFeatures=e,ve.remoteFeatures?.socials&&(ve.remoteFeatures.socials=Ah.filterSocialsByPlatform(ve.remoteFeatures.socials)),ve.features?.pay&&(ve.remoteFeatures.email=!1,ve.remoteFeatures.socials=!1)},setFeatures(t){if(!t)return;ve.features||(ve.features=Pe.DEFAULT_FEATURES);const e={...ve.features,...t};ve.features=e,ve.features?.pay&&ve.remoteFeatures&&(ve.remoteFeatures.email=!1,ve.remoteFeatures.socials=!1)},setProjectId(t){ve.projectId=t},setCustomRpcUrls(t){ve.customRpcUrls=t},setAllWallets(t){ve.allWallets=t},setIncludeWalletIds(t){ve.includeWalletIds=t},setExcludeWalletIds(t){ve.excludeWalletIds=t},setFeaturedWalletIds(t){ve.featuredWalletIds=t},setTokens(t){ve.tokens=t},setTermsConditionsUrl(t){ve.termsConditionsUrl=t},setPrivacyPolicyUrl(t){ve.privacyPolicyUrl=t},setCustomWallets(t){ve.customWallets=t},setIsSiweEnabled(t){ve.isSiweEnabled=t},setIsUniversalProvider(t){ve.isUniversalProvider=t},setSdkVersion(t){ve.sdkVersion=t},setMetadata(t){ve.metadata=t},setDisableAppend(t){ve.disableAppend=t},setEIP6963Enabled(t){ve.enableEIP6963=t},setDebug(t){ve.debug=t},setEnableWalletGuide(t){ve.enableWalletGuide=t},setEnableAuthLogger(t){ve.enableAuthLogger=t},setEnableWallets(t){ve.enableWallets=t},setPreferUniversalLinks(t){ve.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Pe.SIWX_DEFAULTS))t[e]??(t[e]=n);ve.siwx=t},setConnectMethodsOrder(t){ve.features={...ve.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){ve.features={...ve.features,walletFeaturesOrder:t}},setSocialsOrder(t){ve.remoteFeatures={...ve.remoteFeatures,socials:t}},setCollapseWallets(t){ve.features={...ve.features,collapseWallets:t}},setEnableEmbedded(t){ve.enableEmbedded=t},setAllowUnsupportedChain(t){ve.allowUnsupportedChain=t},setManualWCControl(t){ve.manualWCControl=t},setEnableNetworkSwitch(t){ve.enableNetworkSwitch=t},setEnableMobileFullScreen(t){ve.enableMobileFullScreen=se.isMobile()&&t},setEnableReconnect(t){ve.enableReconnect=t},setCoinbasePreference(t){ve.coinbasePreference=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(ve.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){ve.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return ve.universalProviderConfigOverride},getSnapshot(){return za(ve)}},bi=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Dt=tt({...bi}),gI={state:Dt,subscribeKey(t,e){return It(Dt,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=se.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Dt.message=bi.message,Dt.variant=bi.variant,Dt.svg=bi.svg,Dt.open=bi.open,Dt.autoClose=bi.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=bi.autoClose}){Dt.open?(Dt.open=!1,setTimeout(()=>{Dt.message=t,Dt.variant=n,Dt.svg=e,Dt.open=!0,Dt.autoClose=r},150)):(Dt.message=t,Dt.variant=n,Dt.svg=e,Dt.open=!0,Dt.autoClose=r)}},pt=gI,mI={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},I0=se.getBlockchainApiUrl(),hn=tt({clientId:null,api:new Ac({baseUrl:I0,clientId:null}),supportedChains:{http:[],ws:[]}}),_e={state:hn,async get(t){const{st:e,sv:n}=_e.getSdkProperties(),r=K.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return hn.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=K.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{hn.supportedChains.http.length||await _e.getSupportedNetworks()}catch{return!1}return hn.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await _e.get({path:"v1/supported-chains"});return hn.supportedChains=t,t}catch{return hn.supportedChains}},async fetchIdentity({address:t}){const e=J.getIdentityFromCacheForAddress(t);if(e)return e;const n=await _e.get({path:`/v1/identity/${t}`,params:{sender:v.state.activeCaipAddress?se.getPlainAddress(v.state.activeCaipAddress):void 0}});return J.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=J.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await _e.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return J.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?_e.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?_e.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async getAddressBalance({caipNetworkId:t,address:e}){return hn.api.post({path:`/v1?chainId=${t}&projectId=${K.state.projectId}`,body:{id:"1",jsonrpc:"2.0",method:"getAddressBalance",params:{address:e}}}).then(n=>n.result)},async fetchTokenPrice({addresses:t,caipNetworkId:e=v.state.activeCaipNetwork?.caipNetworkId}){if(!await _e.isNetworkSupported(e))return{fungibles:[]};const r=J.getTokenPriceCacheForAddresses(t);if(r)return r;const s=await hn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:K.state.projectId},headers:{"Content-Type":"application/json"}});return J.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:s}),s},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?_e.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){const{st:e,sv:n}=_e.getSdkProperties();if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return _e.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return hn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Pe.CONVERT_SLIPPAGE_TOLERANCE},projectId:K.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){const{st:r,sv:s}=_e.getSdkProperties();if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return _e.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){const{st:r,sv:s}=_e.getSdkProperties();if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))return pt.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=J.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await _e.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return J.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?_e.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))return[];const n=v.getAccountData()?.address;return _e.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?_e.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?hn.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?(await hn.api.post({path:"/v1/generators/onrampurl",params:{projectId:K.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await _e.get({path:"/v1/onramp/options"})}catch{return mI}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){try{return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?await hn.api.post({path:"/v1/onramp/quote",params:{projectId:K.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?_e.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){return await _e.isNetworkSupported(v.state.activeCaipNetwork?.caipNetworkId)?hn.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:K.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){hn.clientId=t,hn.api=new Ac({baseUrl:I0,clientId:t})}},yI=Object.freeze({enabled:!0,events:[]}),wI=new Ac({baseUrl:se.getAnalyticsUrl(),clientId:null}),EI=5,bI=60*1e3,Ss=tt({...yI}),CI={state:Ss,subscribeKey(t,e){return It(Ss,t,e)},async sendError(t,e){if(!Ss.enabled)return;const n=Date.now();if(Ss.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<bI}).length>=EI)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};Ss.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=K.state;await wI.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:se.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){Ss.enabled=!0},disable(){Ss.enabled=!1},clearEvents(){Ss.events=[]}};class Fi extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,Fi.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,Fi):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function dg(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=t?.message||JSON.stringify(t):n=String(t)}catch(s){n="Unknown error",console.error("Error parsing error message",s)}const r=t instanceof Fi?t:new Fi(n,e,t);throw CI.sendError(r,r.category),r}function Ln(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return dg(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return dg(a,e)}},n[r]=i}else n[r]=s}),n}const Fn=tt({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),vI={state:Fn,subscribeNetworkImages(t){return xt(Fn.networkImages,()=>t(Fn.networkImages))},subscribeKey(t,e){return It(Fn,t,e)},subscribe(t){return xt(Fn,()=>t(Fn))},setWalletImage(t,e){Fn.walletImages[t]=e},setNetworkImage(t,e){Fn.networkImages[t]=e},setChainImage(t,e){Fn.chainImages[t]=e},setConnectorImage(t,e){Fn.connectorImages={...Fn.connectorImages,[t]:e}},setTokenImage(t,e){Fn.tokenImages[t]=e},setCurrencyImage(t,e){Fn.currencyImages[t]=e}},Vn=Ln(vI),hg={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:"",ton:"20f673c0-095e-49b2-07cf-eb5049dcf600"},oo=tt({networkImagePromises:{},tokenImagePromises:{}}),Gl={async fetchWalletImage(t){if(t)return await de._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(oo.networkImagePromises[t]||(oo.networkImagePromises[t]=de._fetchNetworkImage(t)),await oo.networkImagePromises[t],this.getNetworkImageById(t))},async fetchTokenImage(t){if(t)return oo.tokenImagePromises[t]||(oo.tokenImagePromises[t]=de._fetchTokenImage(t)),await oo.tokenImagePromises[t],this.getTokenImage(t)},getWalletImageById(t){if(t)return Vn.state.walletImages[t]},getWalletImage(t){if(t?.image_url)return t?.image_url;if(t?.image_id)return Vn.state.walletImages[t.image_id]},getNetworkImage(t){if(t?.assets?.imageUrl)return t?.assets?.imageUrl;if(t?.assets?.imageId)return Vn.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Vn.state.networkImages[t]},getConnectorImage(t){if(t?.imageUrl)return t.imageUrl;if(t?.info?.icon)return t.info.icon;if(t?.imageId)return Vn.state.connectorImages[t.imageId]},getChainImage(t){return Vn.state.networkImages[hg[t]]},getTokenImage(t){if(t)return Vn.state.tokenImages[t]},getWalletImageUrl(t){if(!t)return"";const{projectId:e,sdkType:n,sdkVersion:r}=K.state,s=new URL(`${$.W3M_API_URL}/getWalletImage/${t}`);return s.searchParams.set("projectId",e),s.searchParams.set("st",n),s.searchParams.set("sv",r),s.toString()},getAssetImageUrl(t){if(!t)return"";const{projectId:e,sdkType:n,sdkVersion:r}=K.state,s=new URL(`${$.W3M_API_URL}/public/getAssetImage/${t}`);return s.searchParams.set("projectId",e),s.searchParams.set("st",n),s.searchParams.set("sv",r),s.toString()},getChainNamespaceImageUrl(t){return this.getAssetImageUrl(hg[t])},async getImageByToken(t,e){if(t==="native"){const r=$.NATIVE_IMAGE_IDS_BY_NAMESPACE[e]??null;return r?Gl.fetchNetworkImage(r):void 0}const[,n]=Object.entries($.TOKEN_SYMBOLS_BY_ADDRESS).find(([r])=>r.toLowerCase()===t.toLowerCase())??[];if(n)return Gl.fetchTokenImage(n)}},tr={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},_I={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===tr.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${tr.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===tr.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${tr.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===$.CHAIN.SOLANA&&t===tr.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${tr.COINBASE.url}/dapp?cb_url=${r}`),e===$.CHAIN.BITCOIN&&t===tr.BINANCE.id&&!("binancew3w"in window)){const s=v.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${s?.id??1}`),a=new URL(tr.BINANCE.deeplink);a.searchParams.set("appId",tr.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(tr.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},AI=se.getAnalyticsUrl(),SI=new Ac({baseUrl:AI,clientId:null}),II=["MODAL_CREATED"],TI=45,fg=1e3*10,St=tt({timestamp:Date.now(),lastFlush:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1,walletImpressions:[]}),xe={state:St,subscribe(t){return xt(St,()=>t(St))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=K.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},shouldFlushEvents(){const t=JSON.stringify(St.pendingEvents).length/1024>TI,e=St.lastFlush+fg<Date.now();return t||e},_setPendingEvent(t){try{let e=v.getAccountData()?.address;if("address"in t.data&&t.data.address&&(e=t.data.address),II.includes(t.data.event)||typeof window>"u")return;const n=v.getActiveCaipNetwork()?.caipNetworkId;this.state.pendingEvents.push({eventId:se.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:n}}}),St.reportedErrors.FORBIDDEN=!1,xe.shouldFlushEvents()&&xe._submitPendingEvents()}catch(e){console.warn("_setPendingEvent",e)}},sendEvent(t){St.timestamp=Date.now(),St.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];(K.state.features?.analytics||e.includes(t.event))&&xe._setPendingEvent(St),this.subscribeToFlushTriggers()},sendWalletImpressionEvent(t){St.walletImpressions.push(t)},_transformPendingEventsForBatch(t){try{return t.filter(e=>e.props.event!=="WALLET_IMPRESSION_V2")}catch{return t}},_submitPendingEvents(){if(St.lastFlush=Date.now(),!(St.pendingEvents.length===0&&St.walletImpressions.length===0))try{const t=xe._transformPendingEventsForBatch(St.pendingEvents);St.walletImpressions.length&&t.push({eventId:se.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:Date.now(),props:{type:"track",event:"WALLET_IMPRESSION_V2",items:[...St.walletImpressions]}}),SI.sendBeacon({path:"/batch",params:xe.getSdkProperties(),body:t}),St.reportedErrors.FORBIDDEN=!1,St.pendingEvents=[],St.walletImpressions=[]}catch{St.reportedErrors.FORBIDDEN=!0}},subscribeToFlushTriggers(){St.subscribedToVisibilityChange||typeof document>"u"||(St.subscribedToVisibilityChange=!0,document?.addEventListener?.("visibilitychange",()=>{document.visibilityState==="hidden"&&xe._submitPendingEvents()}),document?.addEventListener?.("freeze",()=>{xe._submitPendingEvents()}),window?.addEventListener?.("pagehide",()=>{xe._submitPendingEvents()}),setInterval(()=>{xe._submitPendingEvents()},fg))}},NI=se.getApiUrl(),fn=new Ac({baseUrl:NI,clientId:null}),xI=40,pg=4,OI=20,Re=tt({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[],plan:{tier:"none",hasExceededUsageLimit:!1,limits:{isAboveRpcLimit:!1,isAboveMauLimit:!1}}}),de={state:Re,subscribeKey(t,e){return It(Re,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=K.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return K.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${fn.baseUrl}/getWalletImage/${t}`,n=await fn.getBlob({path:e,params:de._getSdkProperties()});Vn.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${fn.baseUrl}/public/getAssetImage/${t}`,n=await fn.getBlob({path:e,params:de._getSdkProperties()});Vn.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${fn.baseUrl}/public/getAssetImage/${t}`,n=await fn.getBlob({path:e,params:de._getSdkProperties()});Vn.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${fn.baseUrl}/public/getCurrencyImage/${t}`,n=await fn.getBlob({path:e,params:de._getSdkProperties()});Vn.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${fn.baseUrl}/public/getTokenImage/${t}`,n=await fn.getBlob({path:e,params:de._getSdkProperties()});Vn.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=se.isMobile()?t?.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(tr).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await fn.get({path:"/appkit/v1/config",params:de._getSdkProperties()})).features},async fetchUsage(){try{const t=await fn.get({path:"/appkit/v1/project-limits",params:de._getSdkProperties()}),{tier:e,isAboveMauLimit:n,isAboveRpcLimit:r}=t.planLimits,s=e==="starter",i=n||r;de.state.plan={tier:e,hasExceededUsageLimit:s&&i,limits:{isAboveRpcLimit:r,isAboveMauLimit:n}}}catch(t){console.warn("Failed to fetch usage",t)}},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await fn.get({path:"/projects/v1/origins",params:de._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===$.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=$.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const e=v.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!Gl.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>de._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=te.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>de._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>de._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>de._fetchTokenImage(e)))},async fetchWallets(t){const e=t.exclude??[];de._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(tr).map(o=>o.id));const r=await fn.get({path:"/getWallets",params:{...de._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:t.include?.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=de._filterWalletsByPlatform(r?.data);return{data:s||[],count:r?.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=te.state.connectors;if(!t?.length)return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),v.state.activeChain===$.CHAIN.EVM){const s=[...t.flatMap(i=>i.connectors?.map(o=>o.info?.rdns)||[]),...t.map(i=>i.info?.rdns)].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await de.fetchWallets(e);Re.explorerWallets=n,te.extendConnectorsWithExplorerWallets(n);const r=v.getRequestedCaipNetworkIds().join(",");Re.explorerFilteredWallets=n.filter(s=>s.chains?.some(i=>r.includes(i)))},async fetchFeaturedWallets(){const{featuredWalletIds:t}=K.state;if(t?.length){const e={...de._getSdkProperties(),page:1,entries:t?.length??pg,include:t},{data:n}=await de.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>de._fetchWalletImage(i))),Re.featured=r,Re.allFeatured=r}},async fetchRecommendedWallets(){try{Re.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=K.state,r=[...e??[],...n??[]].filter(Boolean),s=v.getRequestedCaipNetworkIds().join(","),i={page:1,entries:pg,include:t,exclude:r,chains:s},{data:o,count:a}=await de.fetchWallets(i),c=J.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>de._fetchWalletImage(d))),Re.recommended=o,Re.allRecommended=o,Re.count=a??0}catch{}finally{Re.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=K.state,s=v.getRequestedCaipNetworkIds().join(","),i=[...Re.recommended.map(({id:d})=>d),...n??[],...r??[]].filter(Boolean),o={page:t,entries:xI,include:e,exclude:i,chains:s},{data:a,count:c,mobileFilteredOutWalletsLength:l}=await de.fetchWallets(o);Re.mobileFilteredOutWalletsLength=l+(Re.mobileFilteredOutWalletsLength??0);const u=a.slice(0,OI).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(u.map(d=>de._fetchWalletImage(d))),Re.wallets=se.uniqueBy([...Re.wallets,...de._filterOutExtensions(a)],"id").filter(d=>d.chains?.some(h=>s.includes(h))),Re.count=c>Re.count?c:Re.count,Re.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await de.fetchWallets(e);n&&n.forEach(r=>{Re.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=K.state,s=v.getRequestedCaipNetworkIds().join(",");Re.search=[];const i={page:1,entries:100,search:t?.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await de.fetchWallets(i);xe.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>de._fetchWalletImage(c)),se.wait(300)]),Re.search=de._filterOutExtensions(o)},initPromise(t,e){const n=Re.promises[t];return n||(Re.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&de.initPromise("connectorImages",de.fetchConnectorImages),e&&de.initPromise("featuredWallets",de.fetchFeaturedWallets),n&&de.initPromise("recommendedWallets",de.fetchRecommendedWallets),r&&de.initPromise("networkImages",de.fetchNetworkImages),s&&de.initPromise("walletRanks",de.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){K.state.features?.analytics&&de.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await fn.get({path:"/getAnalyticsConfig",params:de._getSdkProperties()});K.setFeatures({analytics:t})}catch{K.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!t?.length){Re.featured=Re.allFeatured,Re.recommended=Re.allRecommended;return}const e=v.getRequestedCaipNetworkIds().join(",");Re.featured=Re.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Re.recommended=Re.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Re.filteredWallets=Re.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))},clearFilterByNamespaces(){Re.filteredWallets=[]},setFilterByNamespace(t){if(!t){Re.featured=Re.allFeatured,Re.recommended=Re.allRecommended;return}const e=v.getRequestedCaipNetworkIds().join(",");Re.featured=Re.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),Re.recommended=Re.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),Re.filteredWallets=Re.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))}},Zs={filterOutDuplicatesByRDNS(t){const e=K.state.enableEIP6963?te.state.connectors:[],n=J.getRecentWallets(),r=e.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&se.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=te.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"||a.type==="MULTI_CHAIN"),n=J.getRecentWallets(),r=e.map(a=>a.explorerId||a.explorerWallet?.id||a.id),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=te.state,{featuredWalletIds:n}=K.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){const n=t?.connectMethodsOrder||K.state.features?.connectMethodsOrder,r=e||te.state.connectors;if(n)return n;const{injected:s,announced:i}=gn.getConnectorsByType(r,de.state.recommended,de.state.featured),o=s.filter(gn.showConnector),a=i.filter(gn.showConnector);return o.length||a.length?["wallet","email","social"]:Pe.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&de.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&de.state.excludedWallets.some(r=>o0.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))},filterWalletsByWcSupport(t){return re.state.wcBasic?t.filter(e=>e.supports_wc):se.isMobile()?t.filter(e=>e.supports_wc||Pe.MANDATORY_WALLET_IDS_ON_MOBILE.includes(e.id)):t},getWalletConnectWallets(t){const e=[...de.state.featured,...de.state.recommended];de.state.filteredWallets?.length>0?e.push(...de.state.filteredWallets):e.push(...t);const n=se.uniqueBy(e,"id"),r=Zs.markWalletsAsInstalled(n),s=Zs.filterWalletsByWcSupport(r);return Zs.markWalletsWithDisplayIndex(s)}},gn={getConnectorsByType(t,e,n){const{customWallets:r}=K.state,s=J.getRecentWallets(),i=Zs.filterOutDuplicateWallets(e),o=Zs.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){const e=t.info?.rdns,n=!!e&&de.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===e),r=!!t.name&&de.state.excludedWallets.some(s=>o0.isLowerCaseMatch(s.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!se.isMobile()||se.isMobile()&&!e&&!re.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(v.state.chains.values()).some(n=>te.getConnectorId(n.namespace)===$.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=K.state.features?.connectorTypeOrder??[]}){const u=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(m=>m.isEnabled),d=new Set(u.map(m=>m.type)),h=c.filter(m=>d.has(m)).map(m=>({type:m,isEnabled:!0})),p=u.filter(({type:m})=>!h.some(({type:b})=>b===m));return Array.from(new Set([...h,...p].map(({type:m})=>m)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getPriority(t){return t.id===$.CONNECTOR_ID.BASE_ACCOUNT?0:t.id===$.CONNECTOR_ID.COINBASE||t.id===$.CONNECTOR_ID.COINBASE_SDK?1:2},sortConnectorsByPriority(t){return[...t].sort((e,n)=>gn.getPriority(e)-gn.getPriority(n))},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){try{if(t.name==="Browser Wallet"&&!se.isMobile())return{accounts:[],chainId:void 0};if(t.id===$.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,n]=await Promise.all([t.provider?.request({method:"eth_accounts"}),t.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:e,chainId:n}}catch(e){return console.warn(`Failed to fetch provider data for ${t.name}`,e),{accounts:[],chainId:void 0}}},getFilteredCustomWallets(t){const e=J.getRecentWallets(),n=te.state.connectors.map(o=>o.info?.rdns).filter(Boolean),r=e.map(o=>o.rdns).filter(Boolean),s=n.concat(r);if(s.includes("io.metamask.mobile")&&se.isMobile()){const o=s.indexOf("io.metamask.mobile");s[o]="io.metamask"}return t.filter(o=>!s.includes(String(o?.rdns)))},hasWalletConnector(t){return te.state.connectors.some(e=>e.id===t.id||e.name===t.name)},isWalletCompatibleWithCurrentChain(t){const e=v.state.activeChain;return e&&t.chains?t.chains.some(n=>{const r=n.split(":")[0];return e===r}):!0},getFilteredRecentWallets(){return J.getRecentWallets().filter(n=>!Zs.isExcluded(n)).filter(n=>!this.hasWalletConnector(n)).filter(n=>this.isWalletCompatibleWithCurrentChain(n))},getCappedRecommendedWallets(t){const{connectors:e}=te.state,{customWallets:n,featuredWalletIds:r}=K.state,s=e.find(k=>k.id==="walletConnect"),i=e.filter(k=>k.type==="INJECTED"||k.type==="ANNOUNCED"||k.type==="MULTI_CHAIN");if(!s&&!i.length&&!n?.length)return[];const o=Ah.isEmailEnabled(),a=Ah.isSocialsEnabled(),c=i.filter(k=>k.name!=="Browser Wallet"&&k.name!=="WalletConnect"),l=r?.length||0,u=n?.length||0,d=c.length||0,h=o?1:0,p=a?1:0,m=l+u+d+h+p,b=Math.max(0,4-m);return b<=0?[]:Zs.filterOutDuplicateWallets(t).slice(0,b)},processConnectorsByType(t,e=!0){const n=gn.sortConnectorsByExplorerWallet([...t]);return e?n.filter(gn.showConnector):n},connectorList(){const t=gn.getConnectorsByType(te.state.connectors,de.state.recommended,de.state.featured),e=this.processConnectorsByType(t.announced.filter(p=>p.id!=="walletConnect")),n=this.processConnectorsByType(t.injected),r=this.processConnectorsByType(t.multiChain.filter(p=>p.name!=="WalletConnect"),!1),s=t.custom,i=t.recent,o=this.processConnectorsByType(t.external.filter(p=>p.id!==$.CONNECTOR_ID.COINBASE_SDK&&p.id!==$.CONNECTOR_ID.BASE_ACCOUNT)),a=t.recommended,c=t.featured,l=gn.getConnectorTypeOrder({custom:s,recent:i,announced:e,injected:n,multiChain:r,recommended:a,featured:c,external:o}),u=te.state.connectors.find(p=>p.id==="walletConnect"),d=se.isMobile(),h=[];for(const p of l)switch(p){case"walletConnect":{!d&&u&&h.push({kind:"connector",subtype:"walletConnect",connector:u});break}case"recent":{gn.getFilteredRecentWallets().forEach(w=>h.push({kind:"wallet",subtype:"recent",wallet:w}));break}case"injected":{r.forEach(m=>h.push({kind:"connector",subtype:"multiChain",connector:m})),e.forEach(m=>h.push({kind:"connector",subtype:"announced",connector:m})),n.forEach(m=>h.push({kind:"connector",subtype:"injected",connector:m}));break}case"featured":{c.forEach(m=>h.push({kind:"wallet",subtype:"featured",wallet:m}));break}case"custom":{gn.getFilteredCustomWallets(s??[]).forEach(w=>h.push({kind:"wallet",subtype:"custom",wallet:w}));break}case"external":{o.forEach(m=>h.push({kind:"connector",subtype:"external",connector:m}));break}case"recommended":{gn.getCappedRecommendedWallets(a).forEach(w=>h.push({kind:"wallet",subtype:"recommended",wallet:w}));break}default:console.warn(`Unknown connector type: ${p}`)}return h},hasInjectedConnectors(){return te.state.connectors.filter(t=>(t.type==="INJECTED"||t.type==="ANNOUNCED"||t.type==="MULTI_CHAIN")&&t.name!=="Browser Wallet"&&t.name!=="WalletConnect").length}},RI=["ConnectingExternal","ConnectingMultiChain","ConnectingSocial","ConnectingFarcaster"],et=tt({view:"Connect",history:["Connect"],transactionStack:[]}),kI={state:et,subscribeKey(t,e){return It(et,t,e)},pushTransactionStack(t){et.transactionStack.push(t)},popTransactionStack(t){const e=et.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n?.();break;case"error":r?.(),he.goBack();break;case"cancel":s?.(),he.goBack();break}},push(t,e){let n=t,r=e;de.state.plan.hasExceededUsageLimit&&RI.includes(t)&&(n="UsageExceeded",r=void 0),n!==et.view&&(et.view=n,et.history.push(n),et.data=r)},reset(t,e){et.view=t,et.history=[t],et.data=e},replace(t,e){et.history.at(-1)===t||(et.view=t,et.history[et.history.length-1]=t,et.data=e)},goBack(){const t=v.state.activeCaipAddress,e=he.state.view==="ConnectingFarcaster",n=!t&&e;if(et.history.length>1){et.history.pop();const[r]=et.history.slice(-1);r&&(t&&r==="Connect"?et.view="Account":et.view=r)}else $e.close();et.data?.wallet&&(et.data.wallet=void 0),et.data?.redirectView&&(et.data.redirectView=void 0),setTimeout(()=>{if(n){v.setAccountProp("farcasterUrl",void 0,v.state.activeChain);const r=te.getAuthConnector();r?.provider?.reload();const s=za(K.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(t){if(et.history.length>1){et.history=et.history.slice(0,t+1);const[e]=et.history.slice(-1);e&&(et.view=e)}},goBackOrCloseModal(){he.state.history.length>1?he.goBack():$e.close()}},he=Ln(kI),Zr=tt({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Sh={state:Zr,subscribe(t){return xt(Zr,()=>t(Zr))},setThemeMode(t){Zr.themeMode=t;try{const e=te.getAuthConnector();if(e){const n=Sh.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Ga(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){Zr.themeVariables={...Zr.themeVariables,...t};try{const e=te.getAuthConnector();if(e){const n=Sh.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Ga(Zr.themeVariables,Zr.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return za(Zr)}},Tn=Ln(Sh),T0=Object.fromEntries(d0.map(t=>[t,void 0])),PI=Object.fromEntries(d0.map(t=>[t,!0])),ze=tt({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:T0,filterByNamespaceMap:PI}),DI={state:ze,subscribe(t){return xt(ze,()=>{t(ze)})},subscribeKey(t,e){return It(ze,t,e)},initialize(t){t.forEach(e=>{const n=J.getConnectedConnectorId(e);n&&te.setConnectorId(n,e)})},setActiveConnector(t){t&&(ze.activeConnector=Va(t))},setConnectors(t){t.filter(s=>!ze.allConnectors.some(i=>i.id===s.id&&te.getConnectorName(i.name)===te.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&ze.allConnectors.push(Va(s))});const n=te.getEnabledNamespaces(),r=te.getEnabledConnectors(n);ze.connectors=te.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(ze.filterByNamespaceMap).forEach(e=>{ze.filterByNamespaceMap[e]=!1}),t.forEach(e=>{ze.filterByNamespaceMap[e]=!0}),te.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){ze.filterByNamespaceMap[t]=e,te.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=te.getEnabledNamespaces(),e=te.getEnabledConnectors(t),n=te.areAllNamespacesEnabled();ze.connectors=te.mergeMultiChainConnectors(e),n?de.clearFilterByNamespaces():de.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(ze.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return ze.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(ze.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=te.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=s?.id===$.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=te.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){if(t.id===$.CONNECTOR_ID.AUTH){const e=t,n=za(K.state),r=Tn.getSnapshot().themeMode,s=Tn.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Ga(s,r)}),te.setConnectors([t])}else te.setConnectors([t])},getAuthConnector(t){const e=t||v.state.activeChain,n=ze.connectors.find(r=>r.id===$.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===e):n},getAnnouncedConnectorRdns(){return ze.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>t.info?.rdns)},getConnectorById(t){return gn.sortConnectorsByPriority(ze.allConnectors).find(n=>n.id===t)},getConnector({id:t,namespace:e}){const n=e||v.state.activeChain,r=ze.allConnectors.filter(o=>o.chain===n);return gn.sortConnectorsByPriority(r).find(o=>o.id===t||o.explorerId===t)},syncIfAuthConnector(t){if(t.id!=="AUTH")return;const e=t,n=za(K.state),r=Tn.getSnapshot().themeMode,s=Tn.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Ga(s,r)})},getConnectorsByNamespace(t){const e=ze.allConnectors.filter(n=>n.chain===t);return te.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return v.checkIfSmartAccountEnabled()&&zt(t)===yt.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=he.state.data?.redirectView,n=v.state.activeChain,r=n?te.getConnector({id:t.id,namespace:n}):void 0;_I.handleMobileDeeplinkRedirect(r?.explorerId||t.id,v.state.activeChain),r?he.push("ConnectingExternal",{connector:r,wallet:t,redirectView:e}):he.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?te.getConnectorsByNamespace(t):te.mergeMultiChainConnectors(ze.allConnectors)},setFilterByNamespace(t){ze.filterByNamespace=t,ze.connectors=te.getConnectors(t),de.setFilterByNamespace(t)},setConnectorId(t,e){t&&(ze.activeConnectorIds={...ze.activeConnectorIds,[e]:t},J.setConnectedConnectorId(e,t))},removeConnectorId(t){ze.activeConnectorIds={...ze.activeConnectorIds,[t]:void 0},J.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return ze.activeConnectorIds[t]},isConnected(t){return t?!!ze.activeConnectorIds[t]:Object.values(ze.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){ze.activeConnectorIds={...T0}},extendConnectorsWithExplorerWallets(t){ze.allConnectors.forEach(r=>{const s=t.find(i=>i.id===r.id||i.rdns&&i.rdns===r.info?.rdns);s&&(r.explorerWallet=s)});const e=te.getEnabledNamespaces(),n=te.getEnabledConnectors(e);ze.connectors=te.mergeMultiChainConnectors(n)},async connect(t={}){const{namespace:e}=t;return te.setFilterByNamespace(e),he.push("Connect",{addWalletForNamespace:e}),new Promise((n,r)=>{if(e){const s=v.subscribeChainProp("accountState",o=>{o?.caipAddress&&(n({caipAddress:o?.caipAddress}),s())},e),i=$e.subscribeKey("open",o=>{o||(r(new Error("Modal closed")),i())})}else{const s=v.subscribeKey("activeCaipAddress",o=>{o&&(n({caipAddress:o}),s())}),i=$e.subscribeKey("open",o=>{o||(r(new Error("Modal closed")),i())})}})}},te=Ln(DI),UI=1e3,ea={checkNamespaceConnectorId(t,e){return te.getConnectorId(t)===e},isSocialProvider(t){return Pe.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&te.setActiveConnector(e),s?.(se.isMobile()&&t),r){const l=$e.subscribeKey("open",u=>{u||(he.state.view!==r&&he.replace(r),l(),a(new Error("Modal closed")))})}const c=v.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),n&&$e.close(),c(),o(Lt.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,n)=>{const r=v.subscribeKey("activeCaipAddress",s=>{s&&($e.close(),r(),e(Lt.parseCaipAddress(s)))});re.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i,o=!1,a=null;const c=e||v.state.activeChain,l=v.subscribeKey("activeCaipAddress",u=>{u&&(n&&$e.close(),l())});return new Promise((u,d)=>{async function h(m){if(m.data?.resultUri)if(m.origin===$.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",h,!1);try{const w=te.getAuthConnector(c);if(w&&!o){i&&i.close(),o=!0;const b=m.data.resultUri;xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:t}}),J.setConnectedSocialProvider(t),await re.connectExternal({id:w.id,type:w.type,socialUri:b},w.chain);const R=v.state.activeCaipAddress;if(!R){d(new Error("Failed to connect"));return}u(Lt.parseCaipAddress(R)),xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}})}}catch(w){xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:se.parseError(w)}}),d(new Error("Failed to connect"))}}else xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:"Untrusted Origin"}})}async function p(){if(xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:t}}),t==="farcaster"){r?.();const m=$e.subscribeKey("open",b=>{!b&&t==="farcaster"&&(d(new Error("Popup closed")),s?.(),m())}),w=te.getAuthConnector();if(w&&!v.getAccountData(c)?.farcasterUrl)try{const{url:R}=await w.provider.getFarcasterUri();v.setAccountProp("farcasterUrl",R,c)}catch{d(new Error("Failed to connect to farcaster"))}}else{const m=te.getAuthConnector();a=se.returnOpenHref(`${$.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(m){const{uri:w}=await m.provider.getSocialRedirectUri({provider:t});if(a&&w){a.location.href=w,i=a;const b=setInterval(()=>{i?.closed&&!o&&(d(new Error("Popup closed")),clearInterval(b))},1e3);window.addEventListener("message",h,!1)}else a?.close(),d(new Error("Failed to initiate social connection"))}}catch{d(new Error("Failed to initiate social connection")),a?.close()}}}p()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),e){const a=$e.subscribeKey("open",c=>{c||(he.state.view!==e&&he.replace(e),a(),i(new Error("Modal closed")))})}const o=v.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),t&&$e.close(),o(),s(Lt.parseCaipAddress(a)))})})},async updateEmail(){const t=J.getConnectedConnectorId(v.state.activeChain),e=te.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==$.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await $e.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&($e.close(),clearInterval(i),o(),r({email:a}))},UI),o=$e.subscribeKey("open",a=>{a||(he.state.view!=="Connect"&&he.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return v.checkIfSmartAccountEnabled()&&zt(t)===yt.ACCOUNT_TYPES.EOA}};function cc(){const t=v.state.activeCaipNetwork?.chainNamespace||"eip155",e=v.state.activeCaipNetwork?.id||1,n=Pe.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function H7(t){return Pe.NATIVE_TOKEN_ADDRESS[t]}function zt(t){return v.getAccountData(t)?.preferredAccountType}function hs(t){return t?v.state.chains.get(t)?.networkState?.caipNetwork:v.state.activeCaipNetwork}const Yl={getConnectionStatus(t,e){const n=te.state.activeConnectorIds[e],r=re.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){const e=!!K.state.remoteFeatures?.multiWallet,n=te.state.activeConnectorIds[t],r=re.getConnections(t),i=(re.state.recentConnections.get(t)??[]).filter(a=>te.getConnectorById(a.connectorId)),o=Yl.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}},onConnectMobile(t,e){const n=re.state.wcUri;if(t?.mobile_link&&n)try{re.setWcError(!1);const{mobile_link:r,link_mode:s,name:i}=t,o=se.appendPayToUri(n,e),{redirect:a,redirectUniversalLink:c,href:l}=se.formatNativeUrl(r,o,s),u=a,d=c,h=se.isIframe()?"_top":"_self";re.setWcLinking({name:i,href:l}),re.setRecentWallet(t),K.state.experimental_preferUniversalLinks&&d?se.openHref(d,h):se.openHref(u,h)}catch(r){xe.sendEvent({type:"track",event:"CONNECT_PROXY_ERROR",properties:{message:r instanceof Error?r.message:"Error parsing the deep link",uri:n,mobile_link:t.mobile_link,name:t.name}}),re.setWcError(!0)}}},ao=tt({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1,connectingWallet:void 0}),Gn={state:ao,subscribe(t){return xt(ao,()=>t(ao))},subscribeOpen(t){return It(ao,"open",t)},set(t){Object.assign(ao,{...ao,...t})}},ft=tt({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),$I={state:ft,subscribe(t){return xt(ft,()=>t(ft))},setLastNetworkInView(t){ft.lastNetworkInView=t},async fetchTransactions(t){if(!t)throw new Error("Transactions can't be fetched without an accountAddress");ft.loading=!0;try{const e=await _e.fetchTransactions({account:t,cursor:ft.next,chainId:v.state.activeCaipNetwork?.caipNetworkId}),n=Al.filterSpamTransactions(e.data),r=Al.filterByConnectedChain(n),s=[...ft.transactions,...r];ft.loading=!1,ft.transactions=s,ft.transactionsByYear=Al.groupTransactionsByYearAndMonth(ft.transactionsByYear,r),ft.empty=s.length===0,ft.next=e.next?e.next:void 0}catch{const n=v.state.activeChain;xe.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:K.state.projectId,cursor:ft.next,isSmartAccount:zt(n)===yt.ACCOUNT_TYPES.SMART_ACCOUNT}}),pt.showError("Failed to fetch transactions"),ft.loading=!1,ft.empty=!0,ft.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers?.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(t){const e=v.state.activeCaipNetwork?.caipNetworkId;return t.filter(r=>r.metadata.chain===e)},clearCursor(){ft.next=void 0},resetTransactions(){ft.transactions=[],ft.transactionsByYear={},ft.lastNetworkInView=void 0,ft.loading=!1,ft.empty=!1,ft.next=void 0}},Al=Ln($I,"API_ERROR"),je=tt({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,wcFetchingUri:!1,buffering:!1,status:"disconnected"});let di;const BI={state:je,subscribe(t){return xt(je,()=>t(je))},subscribeKey(t,e){return It(je,t,e)},_getClient(){return je._client},setClient(t){je._client=Va(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);re.syncStorageConnections(e)},syncStorageConnections(t){const e=J.getConnections(),n=t??Array.from(v.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(je.recentConnections);i.set(r,s),je.recentConnections=i}},getConnections(t){return t?je.connections.get(t)??[]:[]},hasAnyConnection(t){const e=re.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){je.wcFetchingUri=!0;const e=se.isTelegram()||se.isSafari()&&se.isIos();if(t==="always"||t==="auto"&&e){if(di){await di,di=void 0;return}if(!se.isPairingExpired(je?.wcPairingExpiry)){const n=je.wcUri;je.wcUri=n;return}di=re._getClient()?.connectWalletConnect?.().catch(()=>{}),re.state.status="connecting",await di,di=void 0,je.wcPairingExpiry=void 0,re.state.status="connected"}else await re._getClient()?.connectWalletConnect?.()},async connectExternal(t,e,n=!0){const r=await re._getClient()?.connectExternal?.(t);n&&v.setActiveNamespace(e);const s=te.state.allConnectors.find(o=>o.id===t?.id),i=t.type==="AUTH"?"email":"browser";return xe.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:i,name:s?.name||"Unknown",view:he.state.view,walletRank:s?.explorerWallet?.order}}),r},async reconnectExternal(t){await re._getClient()?.reconnectExternal?.(t);const e=t.chain||v.state.activeChain;e&&te.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){if(!e)return;$e.setLoading(!0,v.state.activeChain);const n=te.getAuthConnector();n&&(v.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),J.setPreferredAccountTypes(Object.entries(v.state.chains).reduce((r,[s,i])=>{const o=s,a=zt(o);return a!==void 0&&(r[o]=a),r},{})),await re.reconnectExternal(n),$e.setLoading(!1,v.state.activeChain),xe.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:v.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(t){return re._getClient()?.signMessage(t)},parseUnits(t,e){return re._getClient()?.parseUnits(t,e)},formatUnits(t,e){return re._getClient()?.formatUnits(t,e)},updateBalance(t){return re._getClient()?.updateBalance(t)},async sendTransaction(t){return re._getClient()?.sendTransaction(t)},async getCapabilities(t){return re._getClient()?.getCapabilities(t)},async grantPermissions(t){return re._getClient()?.grantPermissions(t)},async walletGetAssets(t){return re._getClient()?.walletGetAssets(t)??{}},async estimateGas(t){return re._getClient()?.estimateGas(t)},async writeContract(t){return re._getClient()?.writeContract(t)},async writeSolanaTransaction(t){return re._getClient()?.writeSolanaTransaction(t)},async getEnsAddress(t){return re._getClient()?.getEnsAddress(t)},async getEnsAvatar(t){return re._getClient()?.getEnsAvatar(t)},checkInstalled(t){return re._getClient()?.checkInstalled?.(t)||!1},resetWcConnection(){je.wcUri=void 0,je.wcPairingExpiry=void 0,je.wcLinking=void 0,je.recentWallet=void 0,je.wcFetchingUri=!1,je.status="disconnected",Al.resetTransactions(),J.deleteWalletConnectDeepLink(),J.deleteRecentWallet(),Gn.set({connectingWallet:void 0})},resetUri(){je.wcUri=void 0,je.wcPairingExpiry=void 0,di=void 0,je.wcFetchingUri=!1,Gn.set({connectingWallet:void 0})},finalizeWcConnection(t){const{wcLinking:e,recentWallet:n}=re.state;e&&J.setWalletConnectDeepLink(e),n&&J.setAppKitRecent(n),t&&xe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:he.state.data?.wallet?.name||"Unknown",view:he.state.view,walletRank:n?.order}})},setWcBasic(t){je.wcBasic=t},setUri(t){je.wcUri=t,je.wcFetchingUri=!1,je.wcPairingExpiry=se.getPairingExpiry()},setWcLinking(t){je.wcLinking=t},setWcError(t){je.wcError=t,je.wcFetchingUri=!1,je.buffering=!1},setRecentWallet(t){je.recentWallet=t},setBuffering(t){je.buffering=t},setStatus(t){je.status=t},setIsSwitchingConnection(t){je.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){try{await re._getClient()?.disconnect({id:t,chainNamespace:e,initialDisconnect:n})}catch(r){throw new Fi("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},async disconnectConnector({id:t,namespace:e}){try{await re._getClient()?.disconnectConnector({id:t,namespace:e})}catch(n){throw new Fi("Failed to disconnect connector","INTERNAL_SDK_ERROR",n)}},setConnections(t,e){const n=new Map(je.connections);n.set(e,t),je.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){const r=v.getAccountData(e)?.user?.accounts?.find(i=>i.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&ea.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await re.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=te.getConnectorById(t.connectorId),s=t.connectorId===$.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)n&&await re.handleAuthAccountSwitch({address:n,namespace:e});else return(await re.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e))?.address;return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){const s=te.getConnectorById(t.connectorId),i=t.auth?.name?.toLowerCase(),o=t.connectorId===$.CONNECTOR_ID.AUTH,a=t.connectorId===$.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&ea.isSocialProvider(i)){const{address:l}=await ea.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){$e.open({view:"ConnectingFarcaster"})},onConnect(){he.replace("ProfileWallets")}});c=l}else{const{address:l}=await ea.connectEmail({closeModalOnConnect:r,onOpen(){$e.open({view:"EmailLogin"})},onConnect(){he.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await ea.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(u){const d=u?"AllWallets":"ConnectingWalletConnect";$e.state.open?he.push(d):$e.open({view:d})},onConnect(){he.replace("ProfileWallets")}});c=l}else{const l=await re.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);l&&(c=l.address)}return o&&n&&await re.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=v.getAccountData(n)?.caipAddress;if(o){const{address:c}=Lt.parseCaipAddress(o);i=c}const a=Yl.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await re.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await re.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},re=Ln(BI),ad={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return kf(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let cd;async function gg(){if(!cd){const{createPublicClient:t,http:e,defineChain:n}=await Xt(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await import("./wagmi-DcZqQoR7.js").then(o=>o.aR);return{createPublicClient:r,http:s,defineChain:i}},[]);cd={createPublicClient:t,http:e,defineChain:n}}return cd}const Ih={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await gg(),{chainId:n}=Lt.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await gg(),r=K.state.projectId,s=await Ih.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(Ih.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},Su={async getMyTokensWithBalance(t={forceUpdate:void 0,caipNetwork:v.state.activeCaipNetwork,address:v.getAccountData()?.address}){const{forceUpdate:e,caipNetwork:n,address:r}=t,s=te.getConnectorId("eip155")===$.CONNECTOR_ID.AUTH;if(!r)return[];const i=n?`${n.caipNetworkId}:${r}`:r,o=J.getBalanceCacheForCaipAddress(i);if(o)return o.balances;if(n&&n.chainNamespace===$.CHAIN.EVM&&s){const c=await this.getEIP155Balances(r,n);if(c)return this.filterLowQualityTokens(c)}const a=await _e.getBalance(r,n?.caipNetworkId,e);return this.filterLowQualityTokens(a.balances)},async getEIP155Balances(t,e){try{const n=ad.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await re.getCapabilities(t))?.[n]?.assetDiscovery?.supported)return null;const s=await re.walletGetAssets({account:t,chainFilter:[n]});if(!ad.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>ad.createBalance(a,e.caipNetworkId));return J.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await Ih.createViemPublicClient(n),{address:s}=Lt.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:c}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:jc},{address:e,functionName:"symbol",args:[],abi:jc},{address:e,functionName:"balanceOf",args:[s],abi:jc},{address:e,functionName:"decimals",args:[],abi:jc}]});return{name:i,symbol:o,decimals:c,balance:a&&c?kf(a,c):"0"}}},ld={adapters:{}},N0={state:ld,initialize(t){ld.adapters={...t}},get(t){return ld.adapters[t]}},Zl={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0,ton:void 0},Cn=tt({providers:{...Zl},providerIds:{...Zl}}),it={state:Cn,subscribeKey(t,e){return It(Cn,t,e)},subscribe(t){return xt(Cn,()=>{t(Cn)})},subscribeProviders(t){return xt(Cn.providers,()=>t(Cn.providers))},setProvider(t,e){t&&e&&(Cn.providers[t]=Va(e))},getProvider(t){if(t)return Cn.providers[t]},setProviderId(t,e){e&&(Cn.providerIds[t]=e)},getProviderId(t){if(t)return Cn.providerIds[t]},reset(){Cn.providers={...Zl},Cn.providerIds={...Zl}},resetChain(t){Cn.providers[t]=void 0,Cn.providerIds[t]=void 0}},Eo={async getTokenList(t){return(await _e.fetchSwapTokens({chainId:t}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const t=v.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const e=(await re?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await _e.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await _e.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s?.allowance&&n&&r){const i=re.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await Su.getMyTokensWithBalance({forceUpdate:t,caipNetwork:v.state.activeCaipNetwork,address:v.getAccountData()?.address});return v.setAccountProp("tokenBalance",e,v.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return t?.map(e=>({...e,address:e?.address?e.address:cc(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]},async handleSwapError(t){try{const e=t?.cause;return e?.json&&(await e.json())?.reasons?.[0]?.description?.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},Ve=tt({tokenBalances:[],loading:!1}),LI={state:Ve,subscribe(t){return xt(Ve,()=>t(Ve))},subscribeKey(t,e){return It(Ve,t,e)},setToken(t){t&&(Ve.token=Va(t))},setTokenAmount(t){Ve.sendTokenAmount=t},setReceiverAddress(t){Ve.receiverAddress=t},setReceiverProfileImageUrl(t){Ve.receiverProfileImageUrl=t},setReceiverProfileName(t){Ve.receiverProfileName=t},setNetworkBalanceInUsd(t){Ve.networkBalanceInUSD=t},setLoading(t){Ve.loading=t},getSdkEventProperties(t){return{message:se.parseError(t),isSmartAccount:zt(v.state.activeChain)===yt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ve.token?.symbol||"",amount:Ve.sendTokenAmount??0,network:v.state.activeCaipNetwork?.caipNetworkId||""}},async sendToken(){try{switch(Le.setLoading(!0),v.state.activeCaipNetwork?.chainNamespace){case"eip155":await Le.sendEvmToken();return;case"solana":await Le.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(t){throw br.isUserRejectedRequestError(t)?new Co(t):t}finally{Le.setLoading(!1)}},async sendEvmToken(){const t=v.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=zt(t);if(!Le.state.sendTokenAmount||!Le.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Le.state.token)throw new Error("A token is required");if(Le.state.token?.address){xe.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===yt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Le.state.token.address,amount:Le.state.sendTokenAmount,network:v.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await Le.sendERC20Token({receiverAddress:Le.state.receiverAddress,tokenAddress:Le.state.token.address,sendTokenAmount:Le.state.sendTokenAmount,decimals:Le.state.token.quantity.decimals});n&&(Ve.hash=n)}else{xe.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===yt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Le.state.token.symbol||"",amount:Le.state.sendTokenAmount,network:v.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await Le.sendNativeToken({receiverAddress:Le.state.receiverAddress,sendTokenAmount:Le.state.sendTokenAmount,decimals:Le.state.token.quantity.decimals});n&&(Ve.hash=n)}},async fetchTokenBalance(t){Ve.loading=!0;const e=v.state.activeChain,n=v.state.activeCaipNetwork?.caipNetworkId,r=v.state.activeCaipNetwork?.chainNamespace,s=v.getAccountData(e)?.caipAddress??v.state.activeCaipAddress,i=s?se.getPlainAddress(s):void 0;if(Ve.lastRetry&&!se.isAllowedRetry(Ve.lastRetry,30*Pe.ONE_SEC_MS))return Ve.loading=!1,[];try{if(i&&n&&r){const o=await Su.getMyTokensWithBalance();return Ve.tokenBalances=o,Ve.lastRetry=void 0,o}}catch(o){Ve.lastRetry=Date.now(),t?.(o),pt.showError("Token Balance Unavailable")}finally{Ve.loading=!1}return[]},fetchNetworkBalance(){if(Ve.tokenBalances.length===0)return;const t=Eo.mapBalancesToSwapTokens(Ve.tokenBalances);if(!t)return;const e=t.find(n=>n.address===cc());e&&(Ve.networkBalanceInUSD=e?bt.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){he.pushTransactionStack({});const e=t.receiverAddress,n=v.getAccountData()?.address,r=re.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await re.sendTransaction({chainNamespace:$.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return xe.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:zt("eip155")===yt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Le.state.token?.symbol||"",amount:t.sendTokenAmount,network:v.state.activeCaipNetwork?.caipNetworkId||"",hash:i||""}}),re._getClient()?.updateBalance("eip155"),Le.resetSend(),{hash:i}},async sendERC20Token(t){he.pushTransactionStack({onSuccess(){he.replace("Account")}});const e=re.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=v.getAccountData()?.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const r=se.getPlainAddress(t.tokenAddress);if(!r)throw new Error("SendController:sendERC20Token - tokenAddress is required");const s=await re.writeContract({fromAddress:n,tokenAddress:r,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:Q_.getERC20Abi(r),chainNamespace:$.CHAIN.EVM});return xe.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:zt("eip155")===yt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Le.state.token?.symbol||"",amount:t.sendTokenAmount,network:v.state.activeCaipNetwork?.caipNetworkId||"",hash:s||""}}),Le.resetSend(),{hash:s}}return{hash:void 0}},async sendSolanaToken(){if(!Le.state.sendTokenAmount||!Le.state.receiverAddress)throw new Error("An amount and receiver address are required");he.pushTransactionStack({onSuccess(){he.replace("Account")}});let t;Le.state.token&&Le.state.token.address!==Pe.SOLANA_NATIVE_TOKEN_ADDRESS&&(se.isCaipAddress(Le.state.token.address)?t=se.getPlainAddress(Le.state.token.address):t=Le.state.token.address);const e=await re.sendTransaction({chainNamespace:"solana",tokenMint:t,to:Le.state.receiverAddress,value:Le.state.sendTokenAmount});e&&(Ve.hash=e),re._getClient()?.updateBalance("solana"),xe.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:!1,token:Le.state.token?.symbol||"",amount:Le.state.sendTokenAmount,network:v.state.activeCaipNetwork?.caipNetworkId||"",hash:e||""}}),Le.resetSend()},resetSend(){Ve.token=void 0,Ve.sendTokenAmount=void 0,Ve.receiverAddress=void 0,Ve.receiverProfileImageUrl=void 0,Ve.receiverProfileName=void 0,Ve.loading=!1,Ve.tokenBalances=[]}},Le=Ln(LI),ud={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},Kc={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},ce=tt({chains:k_(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{connectionControllerClient:void 0},isSwitchingNamespace:!1}),x0={state:ce,subscribe(t){return xt(ce,()=>{t(ce)})},subscribeKey(t,e){return It(ce,t,e)},subscribeAccountStateProp(t,e,n){const r=n||ce.activeChain;return r?It(ce.chains.get(r)?.accountState||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return xt(ce.chains,()=>{const s=n||ce.activeChain;if(s){const i=ce.chains.get(s)?.[t];r!==i&&(r=i,e(i))}})},initialize(t,e,n){const{chainId:r,namespace:s}=J.getActiveNetworkProps(),i=e?.find(u=>u.id.toString()===r?.toString()),a=t.find(u=>u?.namespace===s)||t?.[0],c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=K.state.enableEmbedded?new Set([...c]):new Set([...e?.map(u=>u.chainNamespace)??[]]);(t?.length===0||!a)&&(ce.noAdapters=!0),ce.noAdapters||(ce.activeChain=a?.namespace,ce.activeCaipNetwork=i,v.setChainNetworkData(a?.namespace,{caipNetwork:i}),ce.activeChain&&Gn.set({activeChain:a?.namespace})),l.forEach(u=>{const d=e?.filter(m=>m.chainNamespace===u),h=J.getPreferredAccountTypes()||{},p={...K.state.defaultAccountTypes,...h};v.state.chains.set(u,{namespace:u,networkState:tt({...Kc,caipNetwork:d?.[0]}),accountState:tt({...ud,preferredAccountType:p[u]}),caipNetworks:d??[],...n}),v.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){if(ce.activeChain===t){const e=Array.from(ce.chains.entries()).find(([n])=>n!==t);if(e){const n=e[1]?.caipNetworks?.[0];n&&v.setActiveCaipNetwork(n)}}ce.chains.delete(t)},addAdapter(t,{connectionControllerClient:e},n){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");ce.chains.set(t.namespace,{namespace:t.namespace,networkState:{...Kc,caipNetwork:n[0]},accountState:{...ud},caipNetworks:n,connectionControllerClient:e}),v.setRequestedCaipNetworks(n?.filter(r=>r.chainNamespace===t.namespace)??[],t.namespace)},addNetwork(t){const e=ce.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];e.caipNetworks?.find(r=>r.id===t.id)||n.push(t),ce.chains.set(t.chainNamespace,{...e,caipNetworks:n}),v.setRequestedCaipNetworks(n,t.chainNamespace),te.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){const n=ce.chains.get(t);if(n){const r=ce.activeCaipNetwork?.id===e,s=[...n.caipNetworks?.filter(i=>i.id!==e)||[]];r&&n?.caipNetworks?.[0]&&v.setActiveCaipNetwork(n.caipNetworks[0]),ce.chains.set(t,{...n,caipNetworks:s}),v.setRequestedCaipNetworks(s||[],t),s.length===0&&te.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=ce.chains.get(t);n&&(n.networkState={...n.networkState||Kc,...e},ce.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=ce.chains.get(t);if(r){const s={...r.accountState||ud,...e};ce.chains.set(t,{...r,accountState:s}),(ce.chains.size===1||ce.activeChain===t)&&e.caipAddress&&(ce.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=ce.chains.get(t);if(n){const r={...n.networkState||Kc,...e};ce.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){v.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){ce.activeChain=t;const e=t?ce.chains.get(t):void 0,n=e?.networkState?.caipNetwork;n?.id&&t&&(ce.activeCaipAddress=e?.accountState?.caipAddress,ce.activeCaipNetwork=n,v.setChainNetworkData(t,{caipNetwork:n}),J.setActiveCaipNetworkId(n?.caipNetworkId),Gn.set({activeChain:t,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(t){if(!t)return;const e=ce.activeChain===t.chainNamespace;e||v.setIsSwitchingNamespace(!0);const n=ce.chains.get(t.chainNamespace);ce.activeChain=t.chainNamespace,ce.activeCaipNetwork=t,v.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=n?.accountState?.address;if(r)ce.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&ce.activeCaipAddress){const{address:i}=Lt.parseCaipAddress(ce.activeCaipAddress);r=i,ce.activeCaipAddress=`${t.caipNetworkId}:${r}`}else ce.activeCaipAddress=void 0;v.setChainAccountData(t.chainNamespace,{address:r,caipAddress:ce.activeCaipAddress}),Le.resetSend(),Gn.set({activeChain:ce.activeChain,selectedNetworkId:ce.activeCaipNetwork?.caipNetworkId}),J.setActiveCaipNetworkId(t.caipNetworkId),!v.checkIfSupportedNetwork(t.chainNamespace)&&K.state.enableNetworkSwitch&&!K.state.allowUnsupportedChain&&!re.state.wcBasic&&v.showUnsupportedChainUI()},addCaipNetwork(t){if(!t)return;const e=ce.chains.get(t.chainNamespace);e&&e?.caipNetworks?.push(t)},async switchActiveNamespace(t){if(!t)return;const e=t!==v.state.activeChain,n=v.getNetworkData(t)?.caipNetwork,r=v.getCaipNetworkByNamespace(t,n?.id);e&&r&&await v.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){const n=v.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=it.getProviderId(ce.activeChain)==="AUTH",s=v.getAccountData(n)?.address,i=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t.chainNamespace);try{if(s&&t.chainNamespace===n||r&&i){const o=N0.get(t.chainNamespace);if(!o)throw new Error("Adapter not found");await o.switchNetwork({caipNetwork:t})}v.setActiveCaipNetwork(t)}catch(o){if(e)throw o}xe.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})},getConnectionControllerClient(t){const e=t||ce.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=ce.chains.get(e);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){const n=ce.chains.get(e)?.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=ce.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=e?.networkState||{};return se.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const t=[];return ce.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=v.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){v.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=v.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));te.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return ce.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=v.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){return t?ce.chains.get(t)?.networkState?.caipNetwork:ce.activeCaipNetwork},getActiveCaipAddress(){return ce.activeCaipAddress},getApprovedCaipNetworkIds(t){return ce.chains.get(t)?.networkState?.approvedCaipNetworkIds||[]},setApprovedCaipNetworksData(t,e){v.setAdapterNetworkState(t,e)},checkIfSupportedNetwork(t,e){const n=e||ce.activeCaipNetwork?.caipNetworkId,r=v.getRequestedCaipNetworks(t);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(t){return ce.activeChain?v.getRequestedCaipNetworks(ce.activeChain)?.some(n=>n.id===t):!0},checkIfSmartAccountEnabled(){const t=Ka.caipNetworkIdToNumber(ce.activeCaipNetwork?.caipNetworkId);return!ce.activeChain||!t?!1:!!($t.get(Ee.SMART_ACCOUNT_ENABLED_NETWORKS)?.split(",")||[])?.includes(t.toString())},showUnsupportedChainUI(){$e.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=ce.activeCaipNetwork;return!!(t?.chainNamespace&&Pe.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){v.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=v.state.chains.get(e)?.accountState?.preferredAccountType,r=K.state.defaultAccountTypes[e];ce.activeCaipAddress=void 0,v.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),te.removeConnectorId(e)},setIsSwitchingNamespace(t){ce.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){const t=[];let e;if(ce.chains.forEach(n=>{$.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&t.push(n.namespace)}),t.length>0){const n=t[0];return e=n?ce.chains.get(n)?.caipNetworks?.[0]:void 0,e}},getAccountData(t){const e=t||ce.activeChain;if(e)return v.state.chains.get(e)?.accountState},getNetworkData(t){const e=t||ce.activeChain;if(e)return v.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(t,e){if(!t)return;const n=v.state.chains.get(t),r=n?.caipNetworks?.find(s=>s.id.toString()===e?.toString());return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const t=te.state.filterByNamespace;return(t?[ce.chains.get(t)]:Array.from(ce.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?v.getRequestedCaipNetworks(t):v.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return x0.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){ce.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return ce.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){const e=v.getAccountData();if(!e)return[];const n=v.state.activeCaipNetwork?.caipNetworkId,r=v.state.activeCaipNetwork?.chainNamespace,s=v.state.activeCaipAddress,i=s?se.getPlainAddress(s):void 0;if(v.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!se.isAllowedRetry(e.lastRetry,30*Pe.ONE_SEC_MS))return v.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const o=await Su.getMyTokensWithBalance();return v.setAccountProp("tokenBalance",o,r),v.setAccountProp("lastRetry",void 0,r),v.setAccountProp("balanceLoading",!1,r),o}}catch(o){v.setAccountProp("lastRetry",Date.now(),r),t?.(o),pt.showError("Token Balance Unavailable")}finally{v.setAccountProp("balanceLoading",!1,r)}return[]},isCaipNetworkDisabled(t){const e=t.chainNamespace,n=!!v.getAccountData(e)?.caipAddress,r=v.getAllApprovedCaipNetworkIds(),s=v.getNetworkProp("supportsAllNetworks",e)!==!1,i=te.getConnectorId(e),o=te.getAuthConnector(),a=i===$.CONNECTOR_ID.AUTH&&o;return!n||s||a?!1:!r?.includes(t.caipNetworkId)}},v=Ln(x0),MI={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=v.state.activeCaipNetwork,r=v.state.activeChain,s=he.state.data;if(t.id===n?.id)return;const o=!!v.getAccountData(r)?.address,a=!!v.getAccountData(t.chainNamespace)?.address,c=t.chainNamespace!==r,u=te.getConnectorId(r)===$.CONNECTOR_ID.AUTH,d=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(h=>h===t.chainNamespace);e||u&&d?he.push("SwitchNetwork",{...s,network:t}):o&&c&&!a?he.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):he.push("SwitchNetwork",{...s,network:t})}},vn=tt({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),FI={state:vn,subscribe(t){return xt(vn,()=>t(vn))},subscribeKey(t,e){return It(vn,t,e)},async open(t){const e=t?.namespace,n=v.state.activeChain,r=e&&e!==n,s=v.getAccountData(t?.namespace)?.caipAddress,i=v.state.noAdapters;if(re.state.wcBasic?de.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await de.prefetch(),te.setFilterByNamespace(t?.namespace),$e.setLoading(!0,e),e&&r){const o=v.getNetworkData(e)?.caipNetwork||v.getRequestedCaipNetworks(e)[0];o&&(i?(await v.switchActiveNetwork(o),he.push("ConnectingWalletConnectBasic")):MI.onSwitchNetwork({network:o,ignoreSwitchConfirmation:!0}))}else K.state.manualWCControl||i&&!s?se.isMobile()?he.reset("AllWallets"):he.reset("ConnectingWalletConnectBasic"):t?.view?he.reset(t.view,t.data):s?he.reset("Account"):he.reset("Connect");vn.open=!0,Gn.set({open:!0}),xe.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=K.state.enableEmbedded,e=!!v.state.activeCaipAddress;vn.open&&xe.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),vn.open=!1,he.reset("Connect"),$e.clearLoading(),t?e?he.replace("Account"):he.push("Connect"):Gn.set({open:!1}),re.resetUri()},setLoading(t,e){e&&vn.loadingNamespaceMap.set(e,t),vn.loading=t,Gn.set({loading:t})},clearLoading(){vn.loadingNamespaceMap.clear(),vn.loading=!1,Gn.set({loading:!1})},shake(){vn.shake||(vn.shake=!0,setTimeout(()=>{vn.shake=!1},500))}},$e=Ln(FI),Pa={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Th={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},jI={providers:p0,selectedProvider:null,error:null,purchaseCurrency:Pa,paymentCurrency:Th,purchaseCurrencies:[Pa],paymentCurrencies:[],quotesLoading:!1},Ke=tt(jI),WI={state:Ke,subscribe(t){return xt(Ke,()=>t(Ke))},subscribeKey(t,e){return It(Ke,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=v.state.activeChain,n=e===$.CHAIN.SOLANA?"SOL":"USDC",r=e?v.state.chains.get(e)?.accountState?.address??"":"",s=new URL(t.url);s.searchParams.append("publicKey",tA),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",K.state.projectId),Ke.selectedProvider={...t,url:s.toString()}}else Ke.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=p0.filter(r=>e.includes(r.name));Ke.providers=n}else Ke.providers=[]},setPurchaseCurrency(t){Ke.purchaseCurrency=t},setPaymentCurrency(t){Ke.paymentCurrency=t},setPurchaseAmount(t){Nh.state.purchaseAmount=t},setPaymentAmount(t){Nh.state.paymentAmount=t},async getAvailableCurrencies(){const t=await _e.getOnrampOptions();Ke.purchaseCurrencies=t.purchaseCurrencies,Ke.paymentCurrencies=t.paymentCurrencies,Ke.paymentCurrency=t.paymentCurrencies[0]||Th,Ke.purchaseCurrency=t.purchaseCurrencies[0]||Pa,await de.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await de.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){Ke.quotesLoading=!0;try{const t=await _e.getOnrampQuote({purchaseCurrency:Ke.purchaseCurrency,paymentCurrency:Ke.paymentCurrency,amount:Ke.paymentAmount?.toString()||"0",network:Ke.purchaseCurrency?.symbol});return Ke.quotesLoading=!1,Ke.purchaseAmount=Number(t?.purchaseAmount.amount),t}catch(t){return Ke.error=t.message,Ke.quotesLoading=!1,null}finally{Ke.quotesLoading=!1}},resetState(){Ke.selectedProvider=null,Ke.error=null,Ke.purchaseCurrency=Pa,Ke.paymentCurrency=Th,Ke.purchaseCurrencies=[Pa],Ke.paymentCurrencies=[],Ke.paymentAmount=void 0,Ke.purchaseAmount=void 0,Ke.quotesLoading=!1}},Nh=Ln(WI);var qf={exports:{}},xo=typeof Reflect=="object"?Reflect:null,mg=xo&&typeof xo.apply=="function"?xo.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Sl;xo&&typeof xo.ownKeys=="function"?Sl=xo.ownKeys:Object.getOwnPropertySymbols?Sl=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Sl=function(e){return Object.getOwnPropertyNames(e)};function HI(t){console&&console.warn&&console.warn(t)}var O0=Number.isNaN||function(e){return e!==e};function ot(){ot.init.call(this)}qf.exports=ot;qf.exports.once=KI;ot.EventEmitter=ot;ot.prototype._events=void 0;ot.prototype._eventsCount=0;ot.prototype._maxListeners=void 0;var yg=10;function Iu(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ot,"defaultMaxListeners",{enumerable:!0,get:function(){return yg},set:function(t){if(typeof t!="number"||t<0||O0(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");yg=t}});ot.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ot.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||O0(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function R0(t){return t._maxListeners===void 0?ot.defaultMaxListeners:t._maxListeners}ot.prototype.getMaxListeners=function(){return R0(this)};ot.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")mg(c,this,n);else for(var l=c.length,u=$0(c,l),r=0;r<l;++r)mg(u[r],this,n);return!0};function k0(t,e,n,r){var s,i,o;if(Iu(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),o=i[e]),o===void 0)o=i[e]=n,++t._eventsCount;else if(typeof o=="function"?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=R0(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,HI(a)}return t}ot.prototype.addListener=function(e,n){return k0(this,e,n,!1)};ot.prototype.on=ot.prototype.addListener;ot.prototype.prependListener=function(e,n){return k0(this,e,n,!0)};function qI(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function P0(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=qI.bind(r);return s.listener=n,r.wrapFn=s,s}ot.prototype.once=function(e,n){return Iu(n),this.on(e,P0(this,e,n)),this};ot.prototype.prependOnceListener=function(e,n){return Iu(n),this.prependListener(e,P0(this,e,n)),this};ot.prototype.removeListener=function(e,n){var r,s,i,o,a;if(Iu(n),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():zI(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};ot.prototype.off=ot.prototype.removeListener;ot.prototype.removeAllListeners=function(e){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function D0(t,e,n){var r=t._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?VI(s):$0(s,s.length)}ot.prototype.listeners=function(e){return D0(this,e,!0)};ot.prototype.rawListeners=function(e){return D0(this,e,!1)};ot.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):U0.call(t,e)};ot.prototype.listenerCount=U0;function U0(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ot.prototype.eventNames=function(){return this._eventsCount>0?Sl(this._events):[]};function $0(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function zI(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function VI(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function KI(t,e){return new Promise(function(n,r){function s(o){t.removeListener(e,i),r(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}B0(t,e,i,{once:!0}),e!=="error"&&GI(t,s,{once:!0})})}function GI(t,e,n){typeof t.on=="function"&&B0(t,"error",e,n)}function B0(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){r.once&&t.removeEventListener(e,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var lr=qf.exports;const zf=zo(lr);var oe={};var xh=function(t,e){return xh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},xh(t,e)};function YI(t,e){xh(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Oh=function(){return Oh=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Oh.apply(this,arguments)};function ZI(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function JI(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function XI(t,e){return function(n,r){e(n,r,t)}}function QI(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function eT(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function tT(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function nT(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function rT(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Rh(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function L0(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function sT(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(L0(arguments[e]));return t}function iT(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function lc(t){return this instanceof lc?(this.v=t,this):new lc(t)}function oT(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(p){return new Promise(function(m,w){i.push([h,p,m,w])>1||a(h,p)})})}function a(h,p){try{c(r[h](p))}catch(m){d(i[0][3],m)}}function c(h){h.value instanceof lc?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function aT(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:lc(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function cT(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Rh=="function"?Rh(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function lT(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function uT(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function dT(t){return t&&t.__esModule?t:{default:t}}function hT(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function fT(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const pT=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Oh},__asyncDelegator:aT,__asyncGenerator:oT,__asyncValues:cT,__await:lc,__awaiter:eT,__classPrivateFieldGet:hT,__classPrivateFieldSet:fT,__createBinding:nT,__decorate:JI,__exportStar:rT,__extends:YI,__generator:tT,__importDefault:dT,__importStar:uT,__makeTemplateObject:lT,__metadata:QI,__param:XI,__read:L0,__rest:ZI,__spread:sT,__spreadArrays:iT,__values:Rh},Symbol.toStringTag,{value:"Module"})),Tu=Jw(pT);var dd={},ta={},wg;function gT(){if(wg)return ta;wg=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return ta.delay=t,ta}var hi={},hd={},fi={},Eg;function mT(){return Eg||(Eg=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.ONE_THOUSAND=fi.ONE_HUNDRED=void 0,fi.ONE_HUNDRED=100,fi.ONE_THOUSAND=1e3),fi}var fd={},bg;function yT(){return bg||(bg=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(fd)),fd}var Cg;function M0(){return Cg||(Cg=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Tu;e.__exportStar(mT(),t),e.__exportStar(yT(),t)}(hd)),hd}var vg;function wT(){if(vg)return hi;vg=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.fromMiliseconds=hi.toMiliseconds=void 0;const t=M0();function e(r){return r*t.ONE_THOUSAND}hi.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return hi.fromMiliseconds=n,hi}var _g;function ET(){return _g||(_g=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Tu;e.__exportStar(gT(),t),e.__exportStar(wT(),t)}(dd)),dd}var co={},Ag;function bT(){if(Ag)return co;Ag=1,Object.defineProperty(co,"__esModule",{value:!0}),co.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return co.Watch=t,co.default=t,co}var pd={},na={},Sg;function CT(){if(Sg)return na;Sg=1,Object.defineProperty(na,"__esModule",{value:!0}),na.IWatch=void 0;class t{}return na.IWatch=t,na}var Ig;function vT(){return Ig||(Ig=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Tu.__exportStar(CT(),t)}(pd)),pd}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Tu;e.__exportStar(ET(),t),e.__exportStar(bT(),t),e.__exportStar(vT(),t),e.__exportStar(M0(),t)})(oe);class Ji{}let _T=class extends Ji{constructor(e){super()}};const Tg=oe.FIVE_SECONDS,Xi={pulse:"heartbeat_pulse"};let AT=class F0 extends _T{constructor(e){super(e),this.events=new lr.EventEmitter,this.interval=Tg,this.interval=e?.interval||Tg}static async init(e){const n=new F0(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),oe.toMiliseconds(this.interval))}pulse(){this.events.emit(Xi.pulse)}};const ST=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,IT=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,TT=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function NT(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){xT(t);return}return e}function xT(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Gc(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!TT.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(ST.test(t)||IT.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,NT)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function OT(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function jt(t,...e){try{return OT(t(...e))}catch(n){return Promise.reject(n)}}function RT(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function kT(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Il(t){if(RT(t))return String(t);if(kT(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Il(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const kh="base64:";function PT(t){return typeof t=="string"?t:kh+$T(t)}function DT(t){return typeof t!="string"||!t.startsWith(kh)?t:UT(t.slice(kh.length))}function UT(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function $T(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Sn(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function BT(...t){return Sn(t.join(":"))}function Yc(t){return t=Sn(t),t?t+":":""}function LT(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function MT(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const FT="memory",jT=()=>{const t=new Map;return{name:FT,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function WT(t={}){const e={mounts:{"":t.driver||jT()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=Sn(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Ng(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,p=m=>{let w=h.get(m.base);return w||(w={driver:m.driver,base:m.base,items:[]},h.set(m.base,w)),w};for(const m of l){const w=typeof m=="string",b=Sn(w?m:m.key),R=w?void 0:m.value,k=w||!m.options?u:{...u,...m.options},S=n(b);p(S).items.push({key:b,value:R,relativeKey:S.relativeKey,options:k})}return Promise.all([...h.values()].map(m=>d(m))).then(m=>m.flat())},c={hasItem(l,u={}){l=Sn(l);const{relativeKey:d,driver:h}=n(l);return jt(h.hasItem,d,u)},getItem(l,u={}){l=Sn(l);const{relativeKey:d,driver:h}=n(l);return jt(h.getItem,d,u).then(p=>Gc(p))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?jt(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(p=>({key:BT(d.base,p.key),value:Gc(p.value)}))):Promise.all(d.items.map(h=>jt(d.driver.getItem,h.relativeKey,h.options).then(p=>({key:h.key,value:Gc(p)})))))},getItemRaw(l,u={}){l=Sn(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?jt(h.getItemRaw,d,u):jt(h.getItem,d,u).then(p=>DT(p))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=Sn(l);const{relativeKey:h,driver:p}=n(l);p.setItem&&(await jt(p.setItem,h,Il(u),d),p.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return jt(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:Il(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>jt(d.driver.setItem,h.relativeKey,Il(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=Sn(l);const{relativeKey:h,driver:p}=n(l);if(p.setItemRaw)await jt(p.setItemRaw,h,u,d);else if(p.setItem)await jt(p.setItem,h,PT(u),d);else return;p.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Sn(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await jt(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await jt(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Sn(l);const{relativeKey:d,driver:h}=n(l),p=Object.create(null);if(h.getMeta&&Object.assign(p,await jt(h.getMeta,d,u)),!u.nativeOnly){const m=await jt(h.getItem,d+"$",u).then(w=>Gc(w));m&&typeof m=="object"&&(typeof m.atime=="string"&&(m.atime=new Date(m.atime)),typeof m.mtime=="string"&&(m.mtime=new Date(m.mtime)),Object.assign(p,m))}return p},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=Yc(l);const d=r(l,!0);let h=[];const p=[];let m=!0;for(const b of d){b.driver.flags?.maxDepth||(m=!1);const R=await jt(b.driver.getKeys,b.relativeBase,u);for(const k of R){const S=b.mountpoint+Sn(k);h.some(O=>S.startsWith(O))||p.push(S)}h=[b.mountpoint,...h.filter(k=>!k.startsWith(b.mountpoint))]}const w=u.maxDepth!==void 0&&!m;return p.filter(b=>(!w||LT(b,u.maxDepth))&&MT(b,l))},async clear(l,u={}){l=Yc(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return jt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(p=>d.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>xg(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Yc(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(Ng(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=Yc(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await xg(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=Sn(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Sn(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function Ng(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function xg(t){typeof t.dispose=="function"&&await jt(t.dispose)}function Qi(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function j0(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const r=Qi(n);return(s,i)=>r.then(o=>i(o.transaction(e,s).objectStore(e)))}let gd;function Sc(){return gd||(gd=j0("keyval-store","keyval")),gd}function Og(t,e=Sc()){return e("readonly",n=>Qi(n.get(t)))}function HT(t,e,n=Sc()){return n("readwrite",r=>(r.put(e,t),Qi(r.transaction)))}function qT(t,e=Sc()){return e("readwrite",n=>(n.delete(t),Qi(n.transaction)))}function zT(t=Sc()){return t("readwrite",e=>(e.clear(),Qi(e.transaction)))}function VT(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Qi(t.transaction)}function KT(t=Sc()){return t("readonly",e=>{if(e.getAllKeys)return Qi(e.getAllKeys());const n=[];return VT(e,r=>n.push(r.key)).then(()=>n)})}const GT=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),YT=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function ji(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return YT(t)}catch{return t}}function Wi(t){return typeof t=="string"?t:GT(t)||""}const ZT="idb-keyval";var JT=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=j0(t.dbName,t.storeName)),{name:ZT,options:t,async hasItem(s){return!(typeof await Og(n(s),r)>"u")},async getItem(s){return await Og(n(s),r)??null},setItem(s,i){return HT(n(s),i,r)},removeItem(s){return qT(n(s),r)},getKeys(){return KT(r)},clear(){return zT(r)}}};const XT="WALLET_CONNECT_V2_INDEXED_DB",QT="keyvaluestorage";let eN=class{constructor(){this.indexedDb=WT({driver:JT({dbName:XT,storeName:QT})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,Wi(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var md=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Tl={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof md<"u"&&md.localStorage?Tl.exports=md.localStorage:typeof window<"u"&&window.localStorage?Tl.exports=window.localStorage:Tl.exports=new e})();function tN(t){var e;return[t[0],ji((e=t[1])!=null?e:"")]}let nN=class{constructor(){this.localStorage=Tl.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(tN)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return ji(n)}async setItem(e,n){this.localStorage.setItem(e,Wi(n))}async removeItem(e){this.localStorage.removeItem(e)}};const rN="wc_storage_version",Rg=1,sN=async(t,e,n)=>{const r=rN,s=await e.getItem(r);if(s&&s>=Rg){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,Rg),n(e),iN(t,o)},iN=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let oN=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new nN;this.storage=e;try{const n=new eN;sN(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};var aN=Object.defineProperty,cN=(t,e,n)=>e in t?aN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kg=(t,e,n)=>cN(t,typeof e!="symbol"?e+"":e,n);let lN=class extends Ji{constructor(e){super(),this.opts=e,kg(this,"protocol","wc"),kg(this,"version",2)}};var uN=Object.defineProperty,dN=(t,e,n)=>e in t?uN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hN=(t,e,n)=>dN(t,e+"",n);let fN=class extends Ji{constructor(e,n){super(),this.core=e,this.logger=n,hN(this,"records",new Map)}},pN=class{constructor(e,n){this.logger=e,this.core=n}},gN=class extends Ji{constructor(e,n){super(),this.relayer=e,this.logger=n}},mN=class extends Ji{constructor(e){super()}},yN=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},wN=class extends Ji{constructor(e,n){super(),this.relayer=e,this.logger=n}},EN=class extends Ji{constructor(e,n){super(),this.core=e,this.logger=n}},bN=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},CN=class{constructor(e,n){this.projectId=e,this.logger=n}},vN=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var _N=Object.defineProperty,AN=(t,e,n)=>e in t?_N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pg=(t,e,n)=>AN(t,typeof e!="symbol"?e+"":e,n);let SN=class{constructor(e){this.opts=e,Pg(this,"protocol","wc"),Pg(this,"version",2)}},IN=class{constructor(e){this.client=e}};function TN(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function W0(t,...e){if(!TN(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Dg(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function NN(t,e){W0(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const lo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const yd=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function xN(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function H0(t){return typeof t=="string"&&(t=xN(t)),W0(t),t}let ON=class{clone(){return this._cloneInto()}};function RN(t){const e=r=>t().update(H0(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function q0(t=32){if(lo&&typeof lo.getRandomValues=="function")return lo.getRandomValues(new Uint8Array(t));if(lo&&typeof lo.randomBytes=="function")return lo.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function kN(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}let PN=class extends ON{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=yd(this.buffer)}update(e){Dg(this);const{view:n,buffer:r,blockLen:s}=this;e=H0(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=yd(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Dg(this),NN(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;kN(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=yd(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const Zc=BigInt(2**32-1),Ph=BigInt(32);function z0(t,e=!1){return e?{h:Number(t&Zc),l:Number(t>>Ph&Zc)}:{h:Number(t>>Ph&Zc)|0,l:Number(t&Zc)|0}}function DN(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=z0(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const UN=(t,e)=>BigInt(t>>>0)<<Ph|BigInt(e>>>0),$N=(t,e,n)=>t>>>n,BN=(t,e,n)=>t<<32-n|e>>>n,LN=(t,e,n)=>t>>>n|e<<32-n,MN=(t,e,n)=>t<<32-n|e>>>n,FN=(t,e,n)=>t<<64-n|e>>>n-32,jN=(t,e,n)=>t>>>n-32|e<<64-n,WN=(t,e)=>e,HN=(t,e)=>t,qN=(t,e,n)=>t<<n|e>>>32-n,zN=(t,e,n)=>e<<n|t>>>32-n,VN=(t,e,n)=>e<<n-32|t>>>64-n,KN=(t,e,n)=>t<<n-32|e>>>64-n;function GN(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const YN=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),ZN=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,JN=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),XN=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,QN=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),e2=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Be={fromBig:z0,split:DN,toBig:UN,shrSH:$N,shrSL:BN,rotrSH:LN,rotrSL:MN,rotrBH:FN,rotrBL:jN,rotr32H:WN,rotr32L:HN,rotlSH:qN,rotlSL:zN,rotlBH:VN,rotlBL:KN,add:GN,add3L:YN,add3H:ZN,add4L:JN,add4H:XN,add5H:e2,add5L:QN},[t2,n2]=Be.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Is=new Uint32Array(80),Ts=new Uint32Array(80);let r2=class extends PN{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:m,Hh:w,Hl:b}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,p,m,w,b]}set(e,n,r,s,i,o,a,c,l,u,d,h,p,m,w,b){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=m|0,this.Hh=w|0,this.Hl=b|0}process(e,n){for(let S=0;S<16;S++,n+=4)Is[S]=e.getUint32(n),Ts[S]=e.getUint32(n+=4);for(let S=16;S<80;S++){const O=Is[S-15]|0,U=Ts[S-15]|0,F=Be.rotrSH(O,U,1)^Be.rotrSH(O,U,8)^Be.shrSH(O,U,7),q=Be.rotrSL(O,U,1)^Be.rotrSL(O,U,8)^Be.shrSL(O,U,7),V=Is[S-2]|0,L=Ts[S-2]|0,Y=Be.rotrSH(V,L,19)^Be.rotrBH(V,L,61)^Be.shrSH(V,L,6),G=Be.rotrSL(V,L,19)^Be.rotrBL(V,L,61)^Be.shrSL(V,L,6),W=Be.add4L(q,G,Ts[S-7],Ts[S-16]),D=Be.add4H(W,F,Y,Is[S-7],Is[S-16]);Is[S]=D|0,Ts[S]=W|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:m,Gh:w,Gl:b,Hh:R,Hl:k}=this;for(let S=0;S<80;S++){const O=Be.rotrSH(d,h,14)^Be.rotrSH(d,h,18)^Be.rotrBH(d,h,41),U=Be.rotrSL(d,h,14)^Be.rotrSL(d,h,18)^Be.rotrBL(d,h,41),F=d&p^~d&w,q=h&m^~h&b,V=Be.add5L(k,U,q,n2[S],Ts[S]),L=Be.add5H(V,R,O,F,t2[S],Is[S]),Y=V|0,G=Be.rotrSH(r,s,28)^Be.rotrBH(r,s,34)^Be.rotrBH(r,s,39),W=Be.rotrSL(r,s,28)^Be.rotrBL(r,s,34)^Be.rotrBL(r,s,39),D=r&i^r&a^i&a,P=s&o^s&c^o&c;R=w|0,k=b|0,w=p|0,b=m|0,p=d|0,m=h|0,{h:d,l:h}=Be.add(l|0,u|0,L|0,Y|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const y=Be.add3L(Y,W,P);r=Be.add3H(y,L,G,D),s=y|0}({h:r,l:s}=Be.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Be.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Be.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Be.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Be.add(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:m}=Be.add(this.Fh|0,this.Fl|0,p|0,m|0),{h:w,l:b}=Be.add(this.Gh|0,this.Gl|0,w|0,b|0),{h:R,l:k}=Be.add(this.Hh|0,this.Hl|0,R|0,k|0),this.set(r,s,i,o,a,c,l,u,d,h,p,m,w,b,R,k)}roundClean(){Is.fill(0),Ts.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const s2=RN(()=>new r2);const Vf=BigInt(0),V0=BigInt(1),i2=BigInt(2);function Kf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Gf(t){if(!Kf(t))throw new Error("Uint8Array expected")}function wd(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const o2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Yf(t){Gf(t);let e="";for(let n=0;n<t.length;n++)e+=o2[t[n]];return e}function K0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Vf:BigInt("0x"+t)}const Jr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ug(t){if(t>=Jr._0&&t<=Jr._9)return t-Jr._0;if(t>=Jr.A&&t<=Jr.F)return t-(Jr.A-10);if(t>=Jr.a&&t<=Jr.f)return t-(Jr.a-10)}function G0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Ug(t.charCodeAt(i)),a=Ug(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function a2(t){return K0(Yf(t))}function Nl(t){return Gf(t),K0(Yf(Uint8Array.from(t).reverse()))}function Y0(t,e){return G0(t.toString(16).padStart(e*2,"0"))}function Dh(t,e){return Y0(t,e).reverse()}function Xr(t,e,n){let r;if(typeof e=="string")try{r=G0(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Kf(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function $g(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Gf(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const Ed=t=>typeof t=="bigint"&&Vf<=t;function c2(t,e,n){return Ed(t)&&Ed(e)&&Ed(n)&&e<=t&&t<n}function ra(t,e,n,r){if(!c2(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function l2(t){let e;for(e=0;t>Vf;t>>=V0,e+=1);return e}const u2=t=>(i2<<BigInt(t-1))-V0,d2={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Kf(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Zf(t,e,n={}){const r=(s,i,o)=>{const a=d2[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function Bg(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Vt=BigInt(0),Nt=BigInt(1),vi=BigInt(2),h2=BigInt(3),Uh=BigInt(4),Lg=BigInt(5),Mg=BigInt(8);function Bt(t,e){const n=t%e;return n>=Vt?n:e+n}function f2(t,e,n){if(e<Vt)throw new Error("invalid exponent, negatives unsupported");if(n<=Vt)throw new Error("invalid modulus");if(n===Nt)return Vt;let r=Nt;for(;e>Vt;)e&Nt&&(r=r*t%n),t=t*t%n,e>>=Nt;return r}function xr(t,e,n){let r=t;for(;e-- >Vt;)r*=r,r%=n;return r}function Fg(t,e){if(t===Vt)throw new Error("invert: expected non-zero number");if(e<=Vt)throw new Error("invert: expected positive modulus, got "+e);let n=Bt(t,e),r=e,s=Vt,i=Nt;for(;n!==Vt;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Nt)throw new Error("invert: does not exist");return Bt(s,e)}function p2(t){const e=(t-Nt)/vi;let n,r,s;for(n=t-Nt,r=0;n%vi===Vt;n/=vi,r++);for(s=vi;s<t&&f2(s,e,t)!==t-Nt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+Nt)/Uh;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+Nt)/vi;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let m=o.sqr(d);h<c&&!o.eql(m,o.ONE);h++)m=o.sqr(m);const p=o.pow(l,Nt<<BigInt(c-h-1));l=o.sqr(p),u=o.mul(u,p),d=o.mul(d,l),c=h}return u}}function g2(t){if(t%Uh===h2){const e=(t+Nt)/Uh;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%Mg===Lg){const e=(t-Lg)/Mg;return function(n,r){const s=n.mul(r,vi),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,vi),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return p2(t)}const m2=(t,e)=>(Bt(t,e)&Nt)===Nt,y2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function w2(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=y2.reduce((r,s)=>(r[s]="function",r),e);return Zf(t,n)}function E2(t,e,n){if(n<Vt)throw new Error("invalid exponent, negatives unsupported");if(n===Vt)return t.ONE;if(n===Nt)return e;let r=t.ONE,s=e;for(;n>Vt;)n&Nt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Nt;return r}function b2(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function Z0(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function J0(t,e,n=!1,r={}){if(t<=Vt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=Z0(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:u2(s),ZERO:Vt,ONE:Nt,create:c=>Bt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Vt<=c&&c<t},is0:c=>c===Vt,isOdd:c=>(c&Nt)===Nt,neg:c=>Bt(-c,t),eql:(c,l)=>c===l,sqr:c=>Bt(c*c,t),add:(c,l)=>Bt(c+l,t),sub:(c,l)=>Bt(c-l,t),mul:(c,l)=>Bt(c*l,t),pow:(c,l)=>E2(a,c,l),div:(c,l)=>Bt(c*Fg(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Fg(c,t),sqrt:r.sqrt||(c=>(o||(o=g2(t)),o(a,c))),invertBatch:c=>b2(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Dh(c,i):Y0(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Nl(c):a2(c)}});return Object.freeze(a)}const jg=BigInt(0),Jc=BigInt(1);function bd(t,e){const n=e.negate();return t?n:e}function X0(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Cd(t,e){X0(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function C2(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function v2(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const vd=new WeakMap,Q0=new WeakMap;function _d(t){return Q0.get(t)||1}function _2(t,e){return{constTimeNegate:bd,hasPrecomputes(n){return _d(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>jg;)r&Jc&&(s=s.add(i)),i=i.double(),r>>=Jc;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Cd(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=Cd(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const p=h*o;let m=Number(s&l);s>>=d,m>o&&(m-=u,s+=Jc);const w=p,b=p+Math.abs(m)-1,R=h%2!==0,k=m<0;m===0?c=c.add(bd(R,r[w])):a=a.add(bd(k,r[b]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=Cd(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===jg)break;let p=Number(s&c);if(s>>=u,p>a&&(p-=l,s+=Jc),p===0)continue;let m=r[h+Math.abs(p)-1];p<0&&(m=m.negate()),i=i.add(m)}return i},getPrecomputes(n,r,s){let i=vd.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&vd.set(r,s(i))),i},wNAFCached(n,r,s){const i=_d(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=_d(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){X0(r,e),Q0.set(n,r),vd.delete(n)}}}function A2(t,e,n,r){if(C2(n,t),v2(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=l2(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let p=0;p<r.length;p++){const m=r[p],w=Number(m>>BigInt(d)&BigInt(a));c[w]=c[w].add(n[p])}let h=s;for(let p=c.length-1,m=s;p>0;p--)m=m.add(c[p]),h=h.add(m);if(u=u.add(h),d!==0)for(let p=0;p<o;p++)u=u.double()}return u}function S2(t){return w2(t.Fp),Zf(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Z0(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const dr=BigInt(0),_n=BigInt(1),Xc=BigInt(2),I2=BigInt(8),T2={zip215:!0};function N2(t){const e=S2(t);return Zf(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function x2(t){const e=N2(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Xc<<BigInt(a*8)-_n,u=n.create,d=J0(e.n,e.nBitLength),h=e.uvRatio||((y,E)=>{try{return{isValid:!0,value:n.sqrt(y*n.inv(E))}}catch{return{isValid:!1,value:dr}}}),p=e.adjustScalarBytes||(y=>y),m=e.domain||((y,E,A)=>{if(wd("phflag",A),E.length||A)throw new Error("Contexts/pre-hash are not supported");return y});function w(y,E){ra("coordinate "+y,E,dr,l)}function b(y){if(!(y instanceof S))throw new Error("ExtendedPoint expected")}const R=Bg((y,E)=>{const{ex:A,ey:N,ez:T}=y,x=y.is0();E==null&&(E=x?I2:n.inv(T));const M=u(A*E),H=u(N*E),ne=u(T*E);if(x)return{x:dr,y:_n};if(ne!==_n)throw new Error("invZ was invalid");return{x:M,y:H}}),k=Bg(y=>{const{a:E,d:A}=e;if(y.is0())throw new Error("bad point: ZERO");const{ex:N,ey:T,ez:x,et:M}=y,H=u(N*N),ne=u(T*T),Z=u(x*x),Q=u(Z*Z),pe=u(H*E),ye=u(Z*u(pe+ne)),Te=u(Q+u(A*u(H*ne)));if(ye!==Te)throw new Error("bad point: equation left != right (1)");const ue=u(N*T),Ae=u(x*M);if(ue!==Ae)throw new Error("bad point: equation left != right (2)");return!0});class S{constructor(E,A,N,T){this.ex=E,this.ey=A,this.ez=N,this.et=T,w("x",E),w("y",A),w("z",N),w("t",T),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(E){if(E instanceof S)throw new Error("extended point not allowed");const{x:A,y:N}=E||{};return w("x",A),w("y",N),new S(A,N,_n,u(A*N))}static normalizeZ(E){const A=n.invertBatch(E.map(N=>N.ez));return E.map((N,T)=>N.toAffine(A[T])).map(S.fromAffine)}static msm(E,A){return A2(S,d,E,A)}_setWindowSize(E){F.setWindowSize(this,E)}assertValidity(){k(this)}equals(E){b(E);const{ex:A,ey:N,ez:T}=this,{ex:x,ey:M,ez:H}=E,ne=u(A*H),Z=u(x*T),Q=u(N*H),pe=u(M*T);return ne===Z&&Q===pe}is0(){return this.equals(S.ZERO)}negate(){return new S(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:E}=e,{ex:A,ey:N,ez:T}=this,x=u(A*A),M=u(N*N),H=u(Xc*u(T*T)),ne=u(E*x),Z=A+N,Q=u(u(Z*Z)-x-M),pe=ne+M,ye=pe-H,Te=ne-M,ue=u(Q*ye),Ae=u(pe*Te),qe=u(Q*Te),st=u(ye*pe);return new S(ue,Ae,st,qe)}add(E){b(E);const{a:A,d:N}=e,{ex:T,ey:x,ez:M,et:H}=this,{ex:ne,ey:Z,ez:Q,et:pe}=E;if(A===BigInt(-1)){const Lc=u((x-T)*(Z+ne)),Jo=u((x+T)*(Z-ne)),_s=u(Jo-Lc);if(_s===dr)return this.double();const Mn=u(M*Xc*pe),so=u(H*Xc*Q),Mc=so+Mn,ur=Jo+Lc,Fc=so-Mn,_=u(Mc*_s),f=u(ur*Fc),g=u(Mc*Fc),I=u(_s*ur);return new S(_,f,I,g)}const ye=u(T*ne),Te=u(x*Z),ue=u(H*N*pe),Ae=u(M*Q),qe=u((T+x)*(ne+Z)-ye-Te),st=Ae-ue,Qe=Ae+ue,Tt=u(Te-A*ye),Zn=u(qe*st),ro=u(Qe*Tt),Zo=u(qe*Tt),Zu=u(st*Qe);return new S(Zn,ro,Zu,Zo)}subtract(E){return this.add(E.negate())}wNAF(E){return F.wNAFCached(this,E,S.normalizeZ)}multiply(E){const A=E;ra("scalar",A,_n,r);const{p:N,f:T}=this.wNAF(A);return S.normalizeZ([N,T])[0]}multiplyUnsafe(E,A=S.ZERO){const N=E;return ra("scalar",N,dr,r),N===dr?U:this.is0()||N===_n?this:F.wNAFCachedUnsafe(this,N,S.normalizeZ,A)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return F.unsafeLadder(this,r).is0()}toAffine(E){return R(this,E)}clearCofactor(){const{h:E}=e;return E===_n?this:this.multiplyUnsafe(E)}static fromHex(E,A=!1){const{d:N,a:T}=e,x=n.BYTES;E=Xr("pointHex",E,x),wd("zip215",A);const M=E.slice(),H=E[x-1];M[x-1]=H&-129;const ne=Nl(M),Z=A?l:n.ORDER;ra("pointHex.y",ne,dr,Z);const Q=u(ne*ne),pe=u(Q-_n),ye=u(N*Q-T);let{isValid:Te,value:ue}=h(pe,ye);if(!Te)throw new Error("Point.fromHex: invalid y coordinate");const Ae=(ue&_n)===_n,qe=(H&128)!==0;if(!A&&ue===dr&&qe)throw new Error("Point.fromHex: x=0 and x_0=1");return qe!==Ae&&(ue=u(-ue)),S.fromAffine({x:ue,y:ne})}static fromPrivateKey(E){return L(E).point}toRawBytes(){const{x:E,y:A}=this.toAffine(),N=Dh(A,n.BYTES);return N[N.length-1]|=E&_n?128:0,N}toHex(){return Yf(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,_n,u(e.Gx*e.Gy)),S.ZERO=new S(dr,_n,_n,dr);const{BASE:O,ZERO:U}=S,F=_2(S,a*8);function q(y){return Bt(y,r)}function V(y){return q(Nl(y))}function L(y){const E=n.BYTES;y=Xr("private key",y,E);const A=Xr("hashed private key",i(y),2*E),N=p(A.slice(0,E)),T=A.slice(E,2*E),x=V(N),M=O.multiply(x),H=M.toRawBytes();return{head:N,prefix:T,scalar:x,point:M,pointBytes:H}}function Y(y){return L(y).pointBytes}function G(y=new Uint8Array,...E){const A=$g(...E);return V(i(m(A,Xr("context",y),!!s)))}function W(y,E,A={}){y=Xr("message",y),s&&(y=s(y));const{prefix:N,scalar:T,pointBytes:x}=L(E),M=G(A.context,N,y),H=O.multiply(M).toRawBytes(),ne=G(A.context,H,x,y),Z=q(M+ne*T);ra("signature.s",Z,dr,r);const Q=$g(H,Dh(Z,n.BYTES));return Xr("result",Q,n.BYTES*2)}const D=T2;function P(y,E,A,N=D){const{context:T,zip215:x}=N,M=n.BYTES;y=Xr("signature",y,2*M),E=Xr("message",E),A=Xr("publicKey",A,M),x!==void 0&&wd("zip215",x),s&&(E=s(E));const H=Nl(y.slice(M,2*M));let ne,Z,Q;try{ne=S.fromHex(A,x),Z=S.fromHex(y.slice(0,M),x),Q=O.multiplyUnsafe(H)}catch{return!1}if(!x&&ne.isSmallOrder())return!1;const pe=G(T,Z.toRawBytes(),ne.toRawBytes(),E);return Z.add(ne.multiplyUnsafe(pe)).subtract(Q).clearCofactor().equals(S.ZERO)}return O._setWindowSize(8),{CURVE:e,getPublicKey:Y,sign:W,verify:P,ExtendedPoint:S,utils:{getExtendedPublicKey:L,randomPrivateKey:()=>o(n.BYTES),precompute(y=8,E=S.BASE){return E._setWindowSize(y),E.multiply(BigInt(3)),E}}}}BigInt(0),BigInt(1);const Jf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Wg=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const O2=BigInt(1),Hg=BigInt(2);BigInt(3);const R2=BigInt(5),k2=BigInt(8);function P2(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Jf,o=t*t%i*t%i,a=xr(o,Hg,i)*o%i,c=xr(a,O2,i)*t%i,l=xr(c,R2,i)*c%i,u=xr(l,e,i)*l%i,d=xr(u,n,i)*u%i,h=xr(d,r,i)*d%i,p=xr(h,s,i)*h%i,m=xr(p,s,i)*h%i,w=xr(m,e,i)*l%i;return{pow_p_5_8:xr(w,Hg,i)*t%i,b2:o}}function D2(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function U2(t,e){const n=Jf,r=Bt(e*e*e,n),s=Bt(r*r*e,n),i=P2(t*s).pow_p_5_8;let o=Bt(t*r*i,n);const a=Bt(e*o*o,n),c=o,l=Bt(o*Wg,n),u=a===t,d=a===Bt(-t,n),h=a===Bt(-t*Wg,n);return u&&(o=c),(d||h)&&(o=l),m2(o,n)&&(o=Bt(-o,n)),{isValid:u||d,value:o}}const $2=J0(Jf,void 0,!0),B2={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:$2,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:k2,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:s2,randomBytes:q0,adjustScalarBytes:D2,uvRatio:U2},eE=x2(B2),L2="EdDSA",M2="JWT",Jl=".",Nu="base64url",tE="utf8",nE="utf8",F2=":",j2="did",W2="key",qg="base58btc",H2="z",q2="K36",z2=32;function Xf(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function rE(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Xf(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function sE(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=rE(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Xf(n)}function V2(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var w=0,b=0,R=0,k=m.length;R!==k&&m[R]===0;)R++,w++;for(var S=(k-R)*u+1>>>0,O=new Uint8Array(S);R!==k;){for(var U=m[R],F=0,q=S-1;(U!==0||F<b)&&q!==-1;q--,F++)U+=256*O[q]>>>0,O[q]=U%a>>>0,U=U/a>>>0;if(U!==0)throw new Error("Non-zero carry");b=F,R++}for(var V=S-b;V!==S&&O[V]===0;)V++;for(var L=c.repeat(w);V<S;++V)L+=t.charAt(O[V]);return L}function h(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var w=0;if(m[w]!==" "){for(var b=0,R=0;m[w]===c;)b++,w++;for(var k=(m.length-w)*l+1>>>0,S=new Uint8Array(k);m[w];){var O=n[m.charCodeAt(w)];if(O===255)return;for(var U=0,F=k-1;(O!==0||U<R)&&F!==-1;F--,U++)O+=a*S[F]>>>0,S[F]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");R=U,w++}if(m[w]!==" "){for(var q=k-R;q!==k&&S[q]===0;)q++;for(var V=new Uint8Array(b+(k-q)),L=b;q!==k;)V[L++]=S[q++];return V}}}function p(m){var w=h(m);if(w)return w;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var K2=V2,G2=K2;const iE=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Y2=t=>new TextEncoder().encode(t),Z2=t=>new TextDecoder().decode(t);let J2=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},X2=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return oE(this,e)}},Q2=class{constructor(e){this.decoders=e}or(e){return oE(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const oE=(t,e)=>new Q2({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let ex=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new J2(e,n,r),this.decoder=new X2(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const xu=({name:t,prefix:e,encode:n,decode:r})=>new ex(t,e,n,r),Ic=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=G2(n,e);return xu({prefix:t,name:e,encode:r,decode:i=>iE(s(i))})},tx=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},nx=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Qt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>xu({prefix:e,name:t,encode(s){return nx(s,r,n)},decode(s){return tx(s,r,n,t)}}),rx=xu({prefix:"\0",name:"identity",encode:t=>Z2(t),decode:t=>Y2(t)});var sx=Object.freeze({__proto__:null,identity:rx});const ix=Qt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ox=Object.freeze({__proto__:null,base2:ix});const ax=Qt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var cx=Object.freeze({__proto__:null,base8:ax});const lx=Ic({prefix:"9",name:"base10",alphabet:"0123456789"});var ux=Object.freeze({__proto__:null,base10:lx});const dx=Qt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hx=Qt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fx=Object.freeze({__proto__:null,base16:dx,base16upper:hx});const px=Qt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gx=Qt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mx=Qt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yx=Qt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wx=Qt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ex=Qt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bx=Qt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Cx=Qt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),vx=Qt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var _x=Object.freeze({__proto__:null,base32:px,base32upper:gx,base32pad:mx,base32padupper:yx,base32hex:wx,base32hexupper:Ex,base32hexpad:bx,base32hexpadupper:Cx,base32z:vx});const Ax=Ic({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Sx=Ic({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ix=Object.freeze({__proto__:null,base36:Ax,base36upper:Sx});const Tx=Ic({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nx=Ic({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xx=Object.freeze({__proto__:null,base58btc:Tx,base58flickr:Nx});const Ox=Qt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Rx=Qt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kx=Qt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Px=Qt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Dx=Object.freeze({__proto__:null,base64:Ox,base64pad:Rx,base64url:kx,base64urlpad:Px});const aE=Array.from(""),Ux=aE.reduce((t,e,n)=>(t[n]=e,t),[]),$x=aE.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Bx(t){return t.reduce((e,n)=>(e+=Ux[n],e),"")}function Lx(t){const e=[];for(const n of t){const r=$x[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const Mx=xu({prefix:"",name:"base256emoji",encode:Bx,decode:Lx});var Fx=Object.freeze({__proto__:null,base256emoji:Mx}),jx=cE,zg=128,Wx=-128,Hx=Math.pow(2,31);function cE(t,e,n){e=e||[],n=n||0;for(var r=n;t>=Hx;)e[n++]=t&255|zg,t/=128;for(;t&Wx;)e[n++]=t&255|zg,t>>>=7;return e[n]=t|0,cE.bytes=n-r+1,e}var qx=$h,zx=128,Vg=127;function $h(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw $h.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Vg)<<s:(o&Vg)*Math.pow(2,s),s+=7}while(o>=zx);return $h.bytes=i-r,n}var Vx=Math.pow(2,7),Kx=Math.pow(2,14),Gx=Math.pow(2,21),Yx=Math.pow(2,28),Zx=Math.pow(2,35),Jx=Math.pow(2,42),Xx=Math.pow(2,49),Qx=Math.pow(2,56),eO=Math.pow(2,63),tO=function(t){return t<Vx?1:t<Kx?2:t<Gx?3:t<Yx?4:t<Zx?5:t<Jx?6:t<Xx?7:t<Qx?8:t<eO?9:10},nO={encode:jx,decode:qx,encodingLength:tO},lE=nO;const Kg=(t,e,n=0)=>(lE.encode(t,e,n),e),Gg=t=>lE.encodingLength(t),Bh=(t,e)=>{const n=e.byteLength,r=Gg(t),s=r+Gg(n),i=new Uint8Array(s+n);return Kg(t,i,0),Kg(n,i,r),i.set(e,s),new rO(t,n,e,i)};let rO=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const uE=({name:t,code:e,encode:n})=>new sO(t,e,n);let sO=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Bh(this.code,n):n.then(r=>Bh(this.code,r))}else throw Error("Unknown type, must be binary type")}};const dE=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),iO=uE({name:"sha2-256",code:18,encode:dE("SHA-256")}),oO=uE({name:"sha2-512",code:19,encode:dE("SHA-512")});var aO=Object.freeze({__proto__:null,sha256:iO,sha512:oO});const hE=0,cO="identity",fE=iE,lO=t=>Bh(hE,fE(t)),uO={code:hE,name:cO,encode:fE,digest:lO};var dO=Object.freeze({__proto__:null,identity:uO});new TextEncoder,new TextDecoder;const Yg={...sx,...ox,...cx,...ux,...fx,..._x,...Ix,...xx,...Dx,...Fx};({...aO,...dO});function pE(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Zg=pE("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ad=pE("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=rE(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),gE={utf8:Zg,"utf-8":Zg,hex:Yg.base16,latin1:Ad,ascii:Ad,binary:Ad,...Yg};function Ou(t,e="utf8"){const n=gE[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Vo(t,e="utf8"){const n=gE[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Xf(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Jg(t){return ji(Ou(Vo(t,Nu),tE))}function Xl(t){return Ou(Vo(Wi(t),tE),Nu)}function mE(t){const e=Vo(q2,qg),n=H2+Ou(sE([e,t]),qg);return[j2,W2,n].join(F2)}function hO(t){return Ou(t,Nu)}function fO(t){return Vo(t,Nu)}function pO(t){return Vo([Xl(t.header),Xl(t.payload)].join(Jl),nE)}function gO(t){return[Xl(t.header),Xl(t.payload),hO(t.signature)].join(Jl)}function Lh(t){const e=t.split(Jl),n=Jg(e[0]),r=Jg(e[1]),s=fO(e[2]),i=Vo(e.slice(0,2).join(Jl),nE);return{header:n,payload:r,signature:s,data:i}}function Xg(t=q0(z2)){const e=eE.getPublicKey(t);return{secretKey:sE([t,e]),publicKey:e}}async function mO(t,e,n,r,s=oe.fromMiliseconds(Date.now())){const i={alg:L2,typ:M2},o=mE(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=pO({header:i,payload:c}),u=eE.sign(l,r.secretKey.slice(0,32));return gO({header:i,payload:c,signature:u})}var Qg=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},yO=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),wO=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),EO=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),bO=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),CO=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),vO=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,_O=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,em=3,AO=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",vO]],tm=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function SO(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new CO:typeof navigator<"u"?TO(navigator.userAgent):xO()}function IO(t){return t!==""&&AO.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function TO(t){var e=IO(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new bO;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<em&&(s=Qg(Qg([],s,!0),OO(em-s.length),!0)):s=[];var i=s.join("."),o=NO(t),a=_O.exec(t);return a&&a[1]?new EO(n,i,o,a[1]):new yO(n,i,o)}function NO(t){for(var e=0,n=tm.length;e<n;e++){var r=tm[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function xO(){var t=typeof process<"u"&&process.version;return t?new wO(process.version.slice(1)):null}function OO(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var ut={};Object.defineProperty(ut,"__esModule",{value:!0});ut.getLocalStorage=ut.getLocalStorageOrThrow=ut.getCrypto=ut.getCryptoOrThrow=yE=ut.getLocation=ut.getLocationOrThrow=Qf=ut.getNavigator=ut.getNavigatorOrThrow=Hi=ut.getDocument=ut.getDocumentOrThrow=ut.getFromWindowOrThrow=ut.getFromWindow=void 0;function eo(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}ut.getFromWindow=eo;function Ko(t){const e=eo(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}ut.getFromWindowOrThrow=Ko;function RO(){return Ko("document")}ut.getDocumentOrThrow=RO;function kO(){return eo("document")}var Hi=ut.getDocument=kO;function PO(){return Ko("navigator")}ut.getNavigatorOrThrow=PO;function DO(){return eo("navigator")}var Qf=ut.getNavigator=DO;function UO(){return Ko("location")}ut.getLocationOrThrow=UO;function $O(){return eo("location")}var yE=ut.getLocation=$O;function BO(){return Ko("crypto")}ut.getCryptoOrThrow=BO;function LO(){return eo("crypto")}ut.getCrypto=LO;function MO(){return Ko("localStorage")}ut.getLocalStorageOrThrow=MO;function FO(){return eo("localStorage")}ut.getLocalStorage=FO;var ep={};Object.defineProperty(ep,"__esModule",{value:!0});var wE=ep.getWindowMetadata=void 0;const nm=ut;function jO(){let t,e;try{t=nm.getDocumentOrThrow(),e=nm.getLocationOrThrow()}catch{return null}function n(){const d=t.getElementsByTagName("link"),h=[];for(let p=0;p<d.length;p++){const m=d[p],w=m.getAttribute("rel");if(w&&w.toLowerCase().indexOf("icon")>-1){const b=m.getAttribute("href");if(b)if(b.toLowerCase().indexOf("https:")===-1&&b.toLowerCase().indexOf("http:")===-1&&b.indexOf("//")!==0){let R=e.protocol+"//"+e.host;if(b.indexOf("/")===0)R+=b;else{const k=e.pathname.split("/");k.pop();const S=k.join("/");R+=S+"/"+b}h.push(R)}else if(b.indexOf("//")===0){const R=e.protocol+b;h.push(R)}else h.push(b)}}return h}function r(...d){const h=t.getElementsByTagName("meta");for(let p=0;p<h.length;p++){const m=h[p],w=["itemprop","property","name"].map(b=>m.getAttribute(b)).filter(b=>b?d.includes(b):!1);if(w.length&&w){const b=m.getAttribute("content");if(b)return b}}return""}function s(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=n();return{description:a,url:c,icons:l,name:o}}wE=ep.getWindowMetadata=jO;const WO="0.1.1";function HO(){return WO}class wt extends Error{constructor(e,n={}){const r=(()=>{if(n.cause instanceof wt){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),s=n.cause instanceof wt&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${HO()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return EE(this,e)}}function EE(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?EE(t.cause,e):e?null:t}const uo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function qO(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function uc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function qi(t,...e){if(!qO(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function zO(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");uc(t.outputLen),uc(t.blockLen)}function Mo(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function bE(t,e){qi(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function VO(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Fo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Sd(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Or(t,e){return t<<32-e|t>>>e}const KO=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function GO(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function YO(t){for(let e=0;e<t.length;e++)t[e]=GO(t[e]);return t}const rm=KO?t=>t:YO;function ZO(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Ru(t){return typeof t=="string"&&(t=ZO(t)),qi(t),t}function JO(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];qi(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}class tp{}function CE(t){const e=r=>t().update(Ru(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function XO(t=32){if(uo&&typeof uo.getRandomValues=="function")return uo.getRandomValues(new Uint8Array(t));if(uo&&typeof uo.randomBytes=="function")return Uint8Array.from(uo.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function QO(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function eR(t,e,n){return t&e^~t&n}function tR(t,e,n){return t&e^t&n^e&n}class nR extends tp{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Sd(this.buffer)}update(e){Mo(this),e=Ru(e),qi(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Sd(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Mo(this),bE(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Fo(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;QO(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Sd(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const Ns=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qc=BigInt(2**32-1),sm=BigInt(32);function rR(t,e=!1){return e?{h:Number(t&Qc),l:Number(t>>sm&Qc)}:{h:Number(t>>sm&Qc)|0,l:Number(t&Qc)|0}}function sR(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=rR(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const iR=(t,e,n)=>t<<n|e>>>32-n,oR=(t,e,n)=>e<<n|t>>>32-n,aR=(t,e,n)=>e<<n-32|t>>>64-n,cR=(t,e,n)=>t<<n-32|e>>>64-n,lR=BigInt(0),sa=BigInt(1),uR=BigInt(2),dR=BigInt(7),hR=BigInt(256),fR=BigInt(113),vE=[],_E=[],AE=[];for(let t=0,e=sa,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],vE.push(2*(5*r+n)),_E.push((t+1)*(t+2)/2%64);let s=lR;for(let i=0;i<7;i++)e=(e<<sa^(e>>dR)*fR)%hR,e&uR&&(s^=sa<<(sa<<BigInt(i))-sa);AE.push(s)}const SE=sR(AE,!0),pR=SE[0],gR=SE[1],im=(t,e,n)=>n>32?aR(t,e,n):iR(t,e,n),om=(t,e,n)=>n>32?cR(t,e,n):oR(t,e,n);function mR(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=im(l,u,1)^n[a],h=om(l,u,1)^n[a+1];for(let p=0;p<50;p+=10)t[o+p]^=d,t[o+p+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=_E[o],c=im(s,i,a),l=om(s,i,a),u=vE[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=pR[r],t[1]^=gR[r]}Fo(n)}class np extends tp{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,uc(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=VO(this.state)}clone(){return this._cloneInto()}keccak(){rm(this.state32),mR(this.state32,this.rounds),rm(this.state32),this.posOut=0,this.pos=0}update(e){Mo(this),e=Ru(e),qi(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Mo(this,!1),qi(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return uc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(bE(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Fo(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new np(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const yR=(t,e,n)=>CE(()=>new np(e,t,n)),wR=yR(1,136,256/8),ER=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xs=new Uint32Array(64);class bR extends nR{constructor(e=32){super(64,e,8,!1),this.A=Ns[0]|0,this.B=Ns[1]|0,this.C=Ns[2]|0,this.D=Ns[3]|0,this.E=Ns[4]|0,this.F=Ns[5]|0,this.G=Ns[6]|0,this.H=Ns[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)xs[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=xs[d-15],p=xs[d-2],m=Or(h,7)^Or(h,18)^h>>>3,w=Or(p,17)^Or(p,19)^p>>>10;xs[d]=w+xs[d-7]+m+xs[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=Or(a,6)^Or(a,11)^Or(a,25),p=u+h+eR(a,c,l)+ER[d]+xs[d]|0,w=(Or(r,2)^Or(r,13)^Or(r,22))+tR(r,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=r,r=p+w|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Fo(xs)}destroy(){this.set(0,0,0,0,0,0,0,0),Fo(this.buffer)}}const CR=CE(()=>new bR);const rp=BigInt(0),Mh=BigInt(1);function Tc(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function sp(t){if(!Tc(t))throw new Error("Uint8Array expected")}function dc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function el(t){const e=t.toString(16);return e.length&1?"0"+e:e}function IE(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?rp:BigInt("0x"+t)}const TE=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",vR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function hc(t){if(sp(t),TE)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=vR[t[n]];return e}const Qr={_0:48,_9:57,A:65,F:70,a:97,f:102};function am(t){if(t>=Qr._0&&t<=Qr._9)return t-Qr._0;if(t>=Qr.A&&t<=Qr.F)return t-(Qr.A-10);if(t>=Qr.a&&t<=Qr.f)return t-(Qr.a-10)}function Ql(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(TE)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=am(t.charCodeAt(i)),a=am(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function Di(t){return IE(hc(t))}function NE(t){return sp(t),IE(hc(Uint8Array.from(t).reverse()))}function Nc(t,e){return Ql(t.toString(16).padStart(e*2,"0"))}function xE(t,e){return Nc(t,e).reverse()}function sr(t,e,n){let r;if(typeof e=="string")try{r=Ql(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Tc(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function eu(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];sp(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const Id=t=>typeof t=="bigint"&&rp<=t;function ip(t,e,n){return Id(t)&&Id(e)&&Id(n)&&e<=t&&t<n}function Oo(t,e,n,r){if(!ip(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function _R(t){let e;for(e=0;t>rp;t>>=Mh,e+=1);return e}const ku=t=>(Mh<<BigInt(t))-Mh,Td=t=>new Uint8Array(t),cm=t=>Uint8Array.from(t);function AR(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Td(t),s=Td(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=Td(0))=>{s=a(cm([0]),d),r=a(),d.length!==0&&(s=a(cm([1]),d),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){r=a();const p=r.slice();h.push(p),d+=r.length}return eu(...h)};return(d,h)=>{o(),c(d);let p;for(;!(p=h(l()));)c();return o(),p}}const SR={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Tc(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Pu(t,e,n={}){const r=(s,i,o)=>{const a=SR[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function lm(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}function IR(t,e){if(fm(t)>e)throw new KR({givenSize:fm(t),maxSize:e})}const es={zero:48,nine:57,A:65,F:70,a:97,f:102};function um(t){if(t>=es.zero&&t<=es.nine)return t-es.zero;if(t>=es.A&&t<=es.F)return t-(es.A-10);if(t>=es.a&&t<=es.f)return t-(es.a-10)}function TR(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;if(t.length>r)throw new GR({size:t.length,targetSize:r,type:"Bytes"});const s=new Uint8Array(r);for(let i=0;i<r;i++){const o=n==="right";s[o?i:r-i-1]=t[o?i:t.length-i-1]}return s}function OE(t,e){if(oi(t)>e)throw new BR({givenSize:oi(t),maxSize:e})}function NR(t,e){if(typeof e=="number"&&e>0&&e>oi(t)-1)throw new PE({offset:e,position:"start",size:oi(t)})}function xR(t,e,n){if(typeof e=="number"&&typeof n=="number"&&oi(t)!==n-e)throw new PE({offset:n,position:"end",size:oi(t)})}function RE(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new LR({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const OR="#__bigint";function op(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+OR:s,n)}const RR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function kR(t,e={}){const{strict:n=!1}=e;if(!t)throw new dm(t);if(typeof t!="string")throw new dm(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new hm(t);if(!t.startsWith("0x"))throw new hm(t)}function PR(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function ap(t){return t instanceof Uint8Array?tu(t):Array.isArray(t)?tu(new Uint8Array(t)):t}function tu(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=RR[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(OE(r,e.size),kE(r,e.size)):r}function Nd(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new $R({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?DR(c,r):c}function DR(t,e){return RE(t,{dir:"left",size:e})}function kE(t,e){return RE(t,{dir:"right",size:e})}function as(t,e,n,r={}){const{strict:s}=r;NR(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&xR(i,e,n),i}function oi(t){return Math.ceil((t.length-2)/2)}function UR(t,e={}){const{strict:n=!1}=e;try{return kR(t,{strict:n}),!0}catch{return!1}}class $R extends wt{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class dm extends wt{constructor(e){super(`Value \`${typeof e=="object"?op(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class hm extends wt{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let BR=class extends wt{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class PE extends wt{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let LR=class extends wt{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const MR=new TextEncoder;function FR(t){if(!(t instanceof Uint8Array)){if(!t)throw new tl(t);if(typeof t!="object")throw new tl(t);if(!("BYTES_PER_ELEMENT"in t))throw new tl(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new tl(t)}}function jR(t){return t instanceof Uint8Array?t:typeof t=="string"?HR(t):WR(t)}function WR(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function HR(t,e={}){const{size:n}=e;let r=t;n&&(OE(t,n),r=kE(t,n));let s=r.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=um(s.charCodeAt(c++)),u=um(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new wt(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l*16+u}return o}function qR(t,e={}){const{size:n}=e,r=MR.encode(t);return typeof n=="number"?(IR(r,n),zR(r,n)):r}function zR(t,e){return TR(t,{dir:"right",size:e})}function fm(t){return t.length}function VR(t){try{return FR(t),!0}catch{return!1}}class tl extends wt{constructor(e){super(`Value \`${typeof e=="object"?op(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class KR extends wt{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class GR extends wt{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function DE(t,e={}){const{as:n=typeof t=="string"?"Hex":"Bytes"}=e,r=wR(jR(t));return n==="Bytes"?r:tu(r)}class YR extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const ZR={checksum:new YR(8192)},xd=ZR.checksum;function UE(t,e={}){const{compressed:n}=e,{prefix:r,x:s,y:i}=t;if(n===!1||typeof s=="bigint"&&typeof i=="bigint"){if(r!==4)throw new pm({prefix:r,cause:new nk});return}if(n===!0||typeof s=="bigint"&&typeof i>"u"){if(r!==3&&r!==2)throw new pm({prefix:r,cause:new tk});return}throw new ek({publicKey:t})}function JR(t){const e=(()=>{if(UR(t))return $E(t);if(VR(t))return XR(t);const{prefix:n,x:r,y:s}=t;return typeof r=="bigint"&&typeof s=="bigint"?{prefix:n??4,x:r,y:s}:{prefix:n,x:r}})();return UE(e),e}function XR(t){return $E(tu(t))}function $E(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new rk({publicKey:t});if(t.length===130){const r=BigInt(as(t,0,32)),s=BigInt(as(t,32,64));return{prefix:4,x:r,y:s}}if(t.length===132){const r=Number(as(t,0,1)),s=BigInt(as(t,1,33)),i=BigInt(as(t,33,65));return{prefix:r,x:s,y:i}}const e=Number(as(t,0,1)),n=BigInt(as(t,1,33));return{prefix:e,x:n}}function QR(t,e={}){UE(t);const{prefix:n,x:r,y:s}=t,{includePrefix:i=!0}=e;return PR(i?Nd(n,{size:1}):"0x",Nd(r,{size:32}),typeof s=="bigint"?Nd(s,{size:32}):"0x")}class ek extends wt{constructor({publicKey:e}){super(`Value \`${op(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class pm extends wt{constructor({prefix:e,cause:n}){super(`Prefix "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class tk extends wt{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class nk extends wt{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let rk=class extends wt{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${oi(ap(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const sk=/^0x[a-fA-F0-9]{40}$/;function BE(t,e={}){const{strict:n=!0}=e;if(!sk.test(t))throw new gm({address:t,cause:new ak});if(n){if(t.toLowerCase()===t)return;if(LE(t)!==t)throw new gm({address:t,cause:new ck})}}function LE(t){if(xd.has(t))return xd.get(t);BE(t,{strict:!1});const e=t.substring(2).toLowerCase(),n=DE(qR(e),{as:"Bytes"}),r=e.split("");for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&r[i]&&(r[i]=r[i].toUpperCase()),(n[i>>1]&15)>=8&&r[i+1]&&(r[i+1]=r[i+1].toUpperCase());const s=`0x${r.join("")}`;return xd.set(t,s),s}function ik(t,e={}){const{checksum:n=!1}=e;return BE(t),n?LE(t):t}function ok(t,e={}){const n=DE(`0x${QR(t).slice(4)}`).substring(26);return ik(`0x${n}`,e)}class gm extends wt{constructor({address:e,cause:n}){super(`Address "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class ak extends wt{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class ck extends wt{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class ME extends tp{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,zO(e);const r=Ru(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Fo(i)}update(e){return Mo(this),this.iHash.update(e),this}digestInto(e){Mo(this),qi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const FE=(t,e,n)=>new ME(t,e).update(n).digest();FE.create=(t,e)=>new ME(t,e);const kn=BigInt(0),yn=BigInt(1),Ii=BigInt(2),lk=BigInt(3),jE=BigInt(4),WE=BigInt(5),HE=BigInt(8);function Nn(t,e){const n=t%e;return n>=kn?n:e+n}function Jn(t,e,n){let r=t;for(;e-- >kn;)r*=r,r%=n;return r}function Fh(t,e){if(t===kn)throw new Error("invert: expected non-zero number");if(e<=kn)throw new Error("invert: expected positive modulus, got "+e);let n=Nn(t,e),r=e,s=kn,i=yn;for(;n!==kn;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==yn)throw new Error("invert: does not exist");return Nn(s,e)}function qE(t,e){const n=(t.ORDER+yn)/jE,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function uk(t,e){const n=(t.ORDER-WE)/HE,r=t.mul(e,Ii),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Ii),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function dk(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-yn,n=0;for(;e%Ii===kn;)e/=Ii,n++;let r=Ii;const s=cp(t);for(;mm(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return qE;let i=s.pow(r,e);const o=(e+yn)/Ii;return function(c,l){if(c.is0(l))return l;if(mm(c,l)!==1)throw new Error("Cannot find square root");let u=n,d=c.mul(c.ONE,i),h=c.pow(l,e),p=c.pow(l,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let m=1,w=c.sqr(h);for(;!c.eql(w,c.ONE);)if(m++,w=c.sqr(w),m===u)throw new Error("Cannot find square root");const b=yn<<BigInt(u-m-1),R=c.pow(d,b);u=m,d=c.sqr(R),h=c.mul(h,d),p=c.mul(p,R)}return p}}function hk(t){return t%jE===lk?qE:t%HE===WE?uk:dk(t)}const fk=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function pk(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=fk.reduce((r,s)=>(r[s]="function",r),e);return Pu(t,n)}function gk(t,e,n){if(n<kn)throw new Error("invalid exponent, negatives unsupported");if(n===kn)return t.ONE;if(n===yn)return e;let r=t.ONE,s=e;for(;n>kn;)n&yn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=yn;return r}function zE(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function mm(t,e){const n=(t.ORDER-yn)/Ii,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function VE(t,e){e!==void 0&&uc(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function cp(t,e,n=!1,r={}){if(t<=kn)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=VE(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:ku(s),ZERO:kn,ONE:yn,create:c=>Nn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return kn<=c&&c<t},is0:c=>c===kn,isOdd:c=>(c&yn)===yn,neg:c=>Nn(-c,t),eql:(c,l)=>c===l,sqr:c=>Nn(c*c,t),add:(c,l)=>Nn(c+l,t),sub:(c,l)=>Nn(c-l,t),mul:(c,l)=>Nn(c*l,t),pow:(c,l)=>gk(a,c,l),div:(c,l)=>Nn(c*Fh(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Fh(c,t),sqrt:r.sqrt||(c=>(o||(o=hk(t)),o(a,c))),toBytes:c=>n?xE(c,i):Nc(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?NE(c):Di(c)},invertBatch:c=>zE(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function KE(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function GE(t){const e=KE(t);return e+Math.ceil(e/2)}function mk(t,e,n=!1){const r=t.length,s=KE(e),i=GE(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?NE(t):Di(t),a=Nn(o,e-yn)+yn;return n?xE(a,s):Nc(a,s)}const ym=BigInt(0),jh=BigInt(1);function Od(t,e){const n=e.negate();return t?n:e}function YE(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Rd(t,e){YE(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=ku(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function wm(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=jh);const l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function yk(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function wk(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const kd=new WeakMap,ZE=new WeakMap;function Pd(t){return ZE.get(t)||1}function Ek(t,e){return{constTimeNegate:Od,hasPrecomputes(n){return Pd(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>ym;)r&jh&&(s=s.add(i)),i=i.double(),r>>=jh;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Rd(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=Rd(n,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:m}=wm(s,c,a);s=l,d?o=o.add(Od(p,r[m])):i=i.add(Od(h,r[u]))}return{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=Rd(n,e);for(let a=0;a<o.windows&&s!==ym;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=wm(s,a,o);if(s=c,!u){const h=r[l];i=i.add(d?h.negate():h)}}return i},getPrecomputes(n,r,s){let i=kd.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&kd.set(r,s(i))),i},wNAFCached(n,r,s){const i=Pd(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Pd(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){YE(r,e),ZE.set(n,r),kd.delete(n)}}}function bk(t,e,n,r){yk(n,t),wk(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=_R(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=ku(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let w=0;w<i;w++){const b=r[w],R=Number(b>>BigInt(p)&l);u[R]=u[R].add(n[w])}let m=o;for(let w=u.length-1,b=o;w>0;w--)b=b.add(u[w]),m=m.add(b);if(h=h.add(m),p!==0)for(let w=0;w<c;w++)h=h.double()}return h}function JE(t){return pk(t.Fp),Pu(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...VE(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function Em(t){t.lowS!==void 0&&dc("lowS",t.lowS),t.prehash!==void 0&&dc("prehash",t.prehash)}function Ck(t){const e=JE(t);Pu(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class vk extends Error{constructor(e=""){super(e)}}const ls={Err:vk,_tlv:{encode:(t,e)=>{const{Err:n}=ls;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=el(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?el(s.length/2|128):"";return el(t)+i+s+e},decode(t,e){const{Err:n}=ls;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=ls;if(t<ds)throw new e("integer: negative integers are not allowed");let n=el(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=ls;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Di(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=ls,s=sr("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=ls,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}};function Dd(t,e){return hc(Nc(t,e))}const ds=BigInt(0),Wt=BigInt(1);BigInt(2);const Ud=BigInt(3),_k=BigInt(4);function Ak(t){const e=Ck(t),{Fp:n}=e,r=cp(e.n,e.nBitLength),s=e.toBytes||((S,O,U)=>{const F=O.toAffine();return eu(Uint8Array.from([4]),n.toBytes(F.x),n.toBytes(F.y))}),i=e.fromBytes||(S=>{const O=S.subarray(1),U=n.fromBytes(O.subarray(0,n.BYTES)),F=n.fromBytes(O.subarray(n.BYTES,2*n.BYTES));return{x:U,y:F}});function o(S){const{a:O,b:U}=e,F=n.sqr(S),q=n.mul(F,S);return n.add(n.add(q,n.mul(S,O)),U)}function a(S,O){const U=n.sqr(O),F=o(S);return n.eql(U,F)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(e.a,Ud),_k),l=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(c,l)))throw new Error("bad curve params: a or b");function u(S){return ip(S,Wt,e.n)}function d(S){const{allowedPrivateKeyLengths:O,nByteLength:U,wrapPrivateKey:F,n:q}=e;if(O&&typeof S!="bigint"){if(Tc(S)&&(S=hc(S)),typeof S!="string"||!O.includes(S.length))throw new Error("invalid private key");S=S.padStart(U*2,"0")}let V;try{V=typeof S=="bigint"?S:Di(sr("private key",S,U))}catch{throw new Error("invalid private key, expected hex or "+U+" bytes, got "+typeof S)}return F&&(V=Nn(V,q)),Oo("private key",V,Wt,q),V}function h(S){if(!(S instanceof w))throw new Error("ProjectivePoint expected")}const p=lm((S,O)=>{const{px:U,py:F,pz:q}=S;if(n.eql(q,n.ONE))return{x:U,y:F};const V=S.is0();O==null&&(O=V?n.ONE:n.inv(q));const L=n.mul(U,O),Y=n.mul(F,O),G=n.mul(q,O);if(V)return{x:n.ZERO,y:n.ZERO};if(!n.eql(G,n.ONE))throw new Error("invZ was invalid");return{x:L,y:Y}}),m=lm(S=>{if(S.is0()){if(e.allowInfinityPoint&&!n.is0(S.py))return;throw new Error("bad point: ZERO")}const{x:O,y:U}=S.toAffine();if(!n.isValid(O)||!n.isValid(U))throw new Error("bad point: x or y not FE");if(!a(O,U))throw new Error("bad point: equation left != right");if(!S.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class w{constructor(O,U,F){if(O==null||!n.isValid(O))throw new Error("x required");if(U==null||!n.isValid(U)||n.is0(U))throw new Error("y required");if(F==null||!n.isValid(F))throw new Error("z required");this.px=O,this.py=U,this.pz=F,Object.freeze(this)}static fromAffine(O){const{x:U,y:F}=O||{};if(!O||!n.isValid(U)||!n.isValid(F))throw new Error("invalid affine point");if(O instanceof w)throw new Error("projective point not allowed");const q=V=>n.eql(V,n.ZERO);return q(U)&&q(F)?w.ZERO:new w(U,F,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(O){const U=zE(n,O.map(F=>F.pz));return O.map((F,q)=>F.toAffine(U[q])).map(w.fromAffine)}static fromHex(O){const U=w.fromAffine(i(sr("pointHex",O)));return U.assertValidity(),U}static fromPrivateKey(O){return w.BASE.multiply(d(O))}static msm(O,U){return bk(w,r,O,U)}_setWindowSize(O){k.setWindowSize(this,O)}assertValidity(){m(this)}hasEvenY(){const{y:O}=this.toAffine();if(n.isOdd)return!n.isOdd(O);throw new Error("Field doesn't support isOdd")}equals(O){h(O);const{px:U,py:F,pz:q}=this,{px:V,py:L,pz:Y}=O,G=n.eql(n.mul(U,Y),n.mul(V,q)),W=n.eql(n.mul(F,Y),n.mul(L,q));return G&&W}negate(){return new w(this.px,n.neg(this.py),this.pz)}double(){const{a:O,b:U}=e,F=n.mul(U,Ud),{px:q,py:V,pz:L}=this;let Y=n.ZERO,G=n.ZERO,W=n.ZERO,D=n.mul(q,q),P=n.mul(V,V),y=n.mul(L,L),E=n.mul(q,V);return E=n.add(E,E),W=n.mul(q,L),W=n.add(W,W),Y=n.mul(O,W),G=n.mul(F,y),G=n.add(Y,G),Y=n.sub(P,G),G=n.add(P,G),G=n.mul(Y,G),Y=n.mul(E,Y),W=n.mul(F,W),y=n.mul(O,y),E=n.sub(D,y),E=n.mul(O,E),E=n.add(E,W),W=n.add(D,D),D=n.add(W,D),D=n.add(D,y),D=n.mul(D,E),G=n.add(G,D),y=n.mul(V,L),y=n.add(y,y),D=n.mul(y,E),Y=n.sub(Y,D),W=n.mul(y,P),W=n.add(W,W),W=n.add(W,W),new w(Y,G,W)}add(O){h(O);const{px:U,py:F,pz:q}=this,{px:V,py:L,pz:Y}=O;let G=n.ZERO,W=n.ZERO,D=n.ZERO;const P=e.a,y=n.mul(e.b,Ud);let E=n.mul(U,V),A=n.mul(F,L),N=n.mul(q,Y),T=n.add(U,F),x=n.add(V,L);T=n.mul(T,x),x=n.add(E,A),T=n.sub(T,x),x=n.add(U,q);let M=n.add(V,Y);return x=n.mul(x,M),M=n.add(E,N),x=n.sub(x,M),M=n.add(F,q),G=n.add(L,Y),M=n.mul(M,G),G=n.add(A,N),M=n.sub(M,G),D=n.mul(P,x),G=n.mul(y,N),D=n.add(G,D),G=n.sub(A,D),D=n.add(A,D),W=n.mul(G,D),A=n.add(E,E),A=n.add(A,E),N=n.mul(P,N),x=n.mul(y,x),A=n.add(A,N),N=n.sub(E,N),N=n.mul(P,N),x=n.add(x,N),E=n.mul(A,x),W=n.add(W,E),E=n.mul(M,x),G=n.mul(T,G),G=n.sub(G,E),E=n.mul(T,A),D=n.mul(M,D),D=n.add(D,E),new w(G,W,D)}subtract(O){return this.add(O.negate())}is0(){return this.equals(w.ZERO)}wNAF(O){return k.wNAFCached(this,O,w.normalizeZ)}multiplyUnsafe(O){const{endo:U,n:F}=e;Oo("scalar",O,ds,F);const q=w.ZERO;if(O===ds)return q;if(this.is0()||O===Wt)return this;if(!U||k.hasPrecomputes(this))return k.wNAFCachedUnsafe(this,O,w.normalizeZ);let{k1neg:V,k1:L,k2neg:Y,k2:G}=U.splitScalar(O),W=q,D=q,P=this;for(;L>ds||G>ds;)L&Wt&&(W=W.add(P)),G&Wt&&(D=D.add(P)),P=P.double(),L>>=Wt,G>>=Wt;return V&&(W=W.negate()),Y&&(D=D.negate()),D=new w(n.mul(D.px,U.beta),D.py,D.pz),W.add(D)}multiply(O){const{endo:U,n:F}=e;Oo("scalar",O,Wt,F);let q,V;if(U){const{k1neg:L,k1:Y,k2neg:G,k2:W}=U.splitScalar(O);let{p:D,f:P}=this.wNAF(Y),{p:y,f:E}=this.wNAF(W);D=k.constTimeNegate(L,D),y=k.constTimeNegate(G,y),y=new w(n.mul(y.px,U.beta),y.py,y.pz),q=D.add(y),V=P.add(E)}else{const{p:L,f:Y}=this.wNAF(O);q=L,V=Y}return w.normalizeZ([q,V])[0]}multiplyAndAddUnsafe(O,U,F){const q=w.BASE,V=(Y,G)=>G===ds||G===Wt||!Y.equals(q)?Y.multiplyUnsafe(G):Y.multiply(G),L=V(this,U).add(V(O,F));return L.is0()?void 0:L}toAffine(O){return p(this,O)}isTorsionFree(){const{h:O,isTorsionFree:U}=e;if(O===Wt)return!0;if(U)return U(w,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:O,clearCofactor:U}=e;return O===Wt?this:U?U(w,this):this.multiplyUnsafe(e.h)}toRawBytes(O=!0){return dc("isCompressed",O),this.assertValidity(),s(w,this,O)}toHex(O=!0){return dc("isCompressed",O),hc(this.toRawBytes(O))}}w.BASE=new w(e.Gx,e.Gy,n.ONE),w.ZERO=new w(n.ZERO,n.ONE,n.ZERO);const{endo:b,nBitLength:R}=e,k=Ek(w,b?Math.ceil(R/2):R);return{CURVE:e,ProjectivePoint:w,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function Sk(t){const e=JE(t);return Pu(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Ik(t){const e=Sk(t),{Fp:n,n:r,nByteLength:s,nBitLength:i}=e,o=n.BYTES+1,a=2*n.BYTES+1;function c(y){return Nn(y,r)}function l(y){return Fh(y,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:p}=Ak({...e,toBytes(y,E,A){const N=E.toAffine(),T=n.toBytes(N.x),x=eu;return dc("isCompressed",A),A?x(Uint8Array.from([E.hasEvenY()?2:3]),T):x(Uint8Array.from([4]),T,n.toBytes(N.y))},fromBytes(y){const E=y.length,A=y[0],N=y.subarray(1);if(E===o&&(A===2||A===3)){const T=Di(N);if(!ip(T,Wt,n.ORDER))throw new Error("Point is not on curve");const x=h(T);let M;try{M=n.sqrt(x)}catch(Z){const Q=Z instanceof Error?": "+Z.message:"";throw new Error("Point is not on curve"+Q)}const H=(M&Wt)===Wt;return(A&1)===1!==H&&(M=n.neg(M)),{x:T,y:M}}else if(E===a&&A===4){const T=n.fromBytes(N.subarray(0,n.BYTES)),x=n.fromBytes(N.subarray(n.BYTES,2*n.BYTES));return{x:T,y:x}}else{const T=o,x=a;throw new Error("invalid Point, expected length of "+T+", or uncompressed "+x+", got "+E)}}});function m(y){const E=r>>Wt;return y>E}function w(y){return m(y)?c(-y):y}const b=(y,E,A)=>Di(y.slice(E,A));class R{constructor(E,A,N){Oo("r",E,Wt,r),Oo("s",A,Wt,r),this.r=E,this.s=A,N!=null&&(this.recovery=N),Object.freeze(this)}static fromCompact(E){const A=s;return E=sr("compactSignature",E,A*2),new R(b(E,0,A),b(E,A,2*A))}static fromDER(E){const{r:A,s:N}=ls.toSig(sr("DER",E));return new R(A,N)}assertValidity(){}addRecoveryBit(E){return new R(this.r,this.s,E)}recoverPublicKey(E){const{r:A,s:N,recovery:T}=this,x=q(sr("msgHash",E));if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");const M=T===2||T===3?A+e.n:A;if(M>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=T&1?"03":"02",ne=u.fromHex(H+Dd(M,n.BYTES)),Z=l(M),Q=c(-x*Z),pe=c(N*Z),ye=u.BASE.multiplyAndAddUnsafe(ne,Q,pe);if(!ye)throw new Error("point at infinify");return ye.assertValidity(),ye}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new R(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Ql(this.toDERHex())}toDERHex(){return ls.hexFromSig(this)}toCompactRawBytes(){return Ql(this.toCompactHex())}toCompactHex(){const E=s;return Dd(this.r,E)+Dd(this.s,E)}}const k={isValidPrivateKey(y){try{return d(y),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const y=GE(e.n);return mk(e.randomBytes(y),e.n)},precompute(y=8,E=u.BASE){return E._setWindowSize(y),E.multiply(BigInt(3)),E}};function S(y,E=!0){return u.fromPrivateKey(y).toRawBytes(E)}function O(y){if(typeof y=="bigint")return!1;if(y instanceof u)return!0;const A=sr("key",y).length,N=n.BYTES,T=N+1,x=2*N+1;if(!(e.allowedPrivateKeyLengths||s===T))return A===T||A===x}function U(y,E,A=!0){if(O(y)===!0)throw new Error("first arg must be private key");if(O(E)===!1)throw new Error("second arg must be public key");return u.fromHex(E).multiply(d(y)).toRawBytes(A)}const F=e.bits2int||function(y){if(y.length>8192)throw new Error("input is too large");const E=Di(y),A=y.length*8-i;return A>0?E>>BigInt(A):E},q=e.bits2int_modN||function(y){return c(F(y))},V=ku(i);function L(y){return Oo("num < 2^"+i,y,ds,V),Nc(y,s)}function Y(y,E,A=G){if(["recovered","canonical"].some(ue=>ue in A))throw new Error("sign() legacy options not supported");const{hash:N,randomBytes:T}=e;let{lowS:x,prehash:M,extraEntropy:H}=A;x==null&&(x=!0),y=sr("msgHash",y),Em(A),M&&(y=sr("prehashed msgHash",N(y)));const ne=q(y),Z=d(E),Q=[L(Z),L(ne)];if(H!=null&&H!==!1){const ue=H===!0?T(n.BYTES):H;Q.push(sr("extraEntropy",ue))}const pe=eu(...Q),ye=ne;function Te(ue){const Ae=F(ue);if(!p(Ae))return;const qe=l(Ae),st=u.BASE.multiply(Ae).toAffine(),Qe=c(st.x);if(Qe===ds)return;const Tt=c(qe*c(ye+Qe*Z));if(Tt===ds)return;let Zn=(st.x===Qe?0:2)|Number(st.y&Wt),ro=Tt;return x&&m(Tt)&&(ro=w(Tt),Zn^=1),new R(Qe,ro,Zn)}return{seed:pe,k2sig:Te}}const G={lowS:e.lowS,prehash:!1},W={lowS:e.lowS,prehash:!1};function D(y,E,A=G){const{seed:N,k2sig:T}=Y(y,E,A),x=e;return AR(x.hash.outputLen,x.nByteLength,x.hmac)(N,T)}u.BASE._setWindowSize(8);function P(y,E,A,N=W){const T=y;E=sr("msgHash",E),A=sr("publicKey",A);const{lowS:x,prehash:M,format:H}=N;if(Em(N),"strict"in N)throw new Error("options.strict was renamed to lowS");if(H!==void 0&&H!=="compact"&&H!=="der")throw new Error("format must be compact or der");const ne=typeof T=="string"||Tc(T),Z=!ne&&!H&&typeof T=="object"&&T!==null&&typeof T.r=="bigint"&&typeof T.s=="bigint";if(!ne&&!Z)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Q,pe;try{if(Z&&(Q=new R(T.r,T.s)),ne){try{H!=="compact"&&(Q=R.fromDER(T))}catch(Zn){if(!(Zn instanceof ls.Err))throw Zn}!Q&&H!=="der"&&(Q=R.fromCompact(T))}pe=u.fromHex(A)}catch{return!1}if(!Q||x&&Q.hasHighS())return!1;M&&(E=e.hash(E));const{r:ye,s:Te}=Q,ue=q(E),Ae=l(Te),qe=c(ue*Ae),st=c(ye*Ae),Qe=u.BASE.multiplyAndAddUnsafe(pe,qe,st)?.toAffine();return Qe?c(Qe.x)===ye:!1}return{CURVE:e,getPublicKey:S,getSharedSecret:U,sign:D,verify:P,ProjectivePoint:u,Signature:R,utils:k}}function Tk(t){return{hash:t,hmac:(e,...n)=>FE(t,e,JO(...n)),randomBytes:XO}}function Nk(t,e){const n=r=>Ik({...t,...Tk(r)});return{...n(e),create:n}}const XE=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),bm=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),xk=BigInt(0),Ok=BigInt(1),Wh=BigInt(2),Cm=(t,e)=>(t+e/Wh)/e;function Rk(t){const e=XE,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Jn(u,n,e)*u%e,h=Jn(d,n,e)*u%e,p=Jn(h,Wh,e)*l%e,m=Jn(p,s,e)*p%e,w=Jn(m,i,e)*m%e,b=Jn(w,a,e)*w%e,R=Jn(b,c,e)*b%e,k=Jn(R,a,e)*w%e,S=Jn(k,n,e)*u%e,O=Jn(S,o,e)*m%e,U=Jn(O,r,e)*l%e,F=Jn(U,Wh,e);if(!Hh.eql(Hh.sqr(F),t))throw new Error("Cannot find square root");return F}const Hh=cp(XE,void 0,void 0,{sqrt:Rk}),kk=Nk({a:xk,b:BigInt(7),Fp:Hh,n:bm,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=bm,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Ok*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=Cm(i*t,e),c=Cm(-r*t,e);let l=Nn(t-a*n-c*s,e),u=Nn(-a*r-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},CR);function Pk(t){if(t.length!==130&&t.length!==132)throw new Uk({signature:t});const e=BigInt(as(t,0,32)),n=BigInt(as(t,32,64)),r=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return Dk(s)}catch{throw new $k({value:s})}})();return typeof r>"u"?{r:e,s:n}:{r:e,s:n,yParity:r}}function Dk(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new Bk({value:t})}class Uk extends wt{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${oi(ap(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class $k extends wt{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class Bk extends wt{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}function Lk(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function QE(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(n=>typeof n=="string"):e.every(n=>Number.isSafeInteger(n)):!1}function nu(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function lp(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function qh(t){if(!Array.isArray(t))throw new Error("array expected")}function ru(t,e){if(!QE(!0,e))throw new Error(`${t}: array of strings expected`)}function Mk(t,e){if(!QE(!1,e))throw new Error(`${t}: array of numbers expected`)}function Fk(...t){const e=i=>i,n=(i,o)=>a=>i(o(a)),r=t.map(i=>i.encode).reduceRight(n,e),s=t.map(i=>i.decode).reduce(n,e);return{encode:r,decode:s}}function jk(t){const e=typeof t=="string"?t.split(""):t,n=e.length;ru("alphabet",e);const r=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(qh(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>(qh(s),s.map(i=>{nu("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function Wk(t=""){return nu("join",t),{encode:e=>(ru("join.decode",e),e.join(t)),decode:e=>(nu("join.decode",e),e.split(t))}}function Hk(t,e="="){return lp(t),nu("padding",e),{encode(n){for(ru("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){ru("padding.decode",n);let r=n.length;if(r*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if((r-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const eb=(t,e)=>e===0?t:eb(e,t%e),su=(t,e)=>t+(e-eb(t,e)),$d=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function vm(t,e,n,r){if(qh(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(su(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${su(e,n)}`);let s=0,i=0;const o=$d[e],a=$d[n]-1,c=[];for(const l of t){if(lp(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=$d[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=e)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function qk(t,e=!1){if(lp(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(su(8,t)>32||su(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Lk(n))throw new Error("radix2.encode input should be Uint8Array");return vm(Array.from(n),8,t,!e)},decode:n=>(Mk("radix2.decode",n),Uint8Array.from(vm(n,t,8,e)))}}const zk=Fk(qk(5),jk("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Hk(5),Wk(""));function Vk(t){return ok(Kk(t))}function Kk(t){const{payload:e,signature:n}=t,{r,s,yParity:i}=n,a=new kk.Signature(BigInt(r),BigInt(s)).addRecoveryBit(i).recoverPublicKey(ap(e).substring(2));return JR(a)}function Gk(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const m=(p-h)*i+1>>>0,w=new Uint8Array(m);for(;h!==p;){let k=l[h],S=0;for(let O=m-1;(k!==0||S<d)&&O!==-1;O--,S++)k+=256*w[O]>>>0,w[O]=k%n>>>0,k=k/n>>>0;if(k!==0)throw new Error("Non-zero carry");d=S,h++}let b=m-d;for(;b!==m&&w[b]===0;)b++;let R=r.repeat(u);for(;b<m;++b)R+=t.charAt(w[b]);return R}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const p=(l.length-u)*s+1>>>0,m=new Uint8Array(p);for(;u<l.length;){const k=l.charCodeAt(u);if(k>255)return;let S=e[k];if(S===255)return;let O=0;for(let U=p-1;(S!==0||O<h)&&U!==-1;U--,O++)S+=n*m[U]>>>0,m[U]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");h=O,u++}let w=p-h;for(;w!==p&&m[w]===0;)w++;const b=new Uint8Array(d+(p-w));let R=d;for(;w!==p;)b[R++]=m[w++];return b}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var Yk="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const xc=Gk(Yk);function Zk(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function Jk(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const Xk=new TextEncoder,Qk=50;function eP(t,e,n){Xk.encodeInto(t,e.subarray(n))}function tP(t,e,n){t.length>Qk?eP(t,e,n):Jk(t,e,n)}const nP=4096;function tb(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if(!(a&128))i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,l=t[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[r++]&63,l=t[r++]&63,u=t[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=nP&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const rP=new TextDecoder,sP=200;function iP(t,e,n){const r=t.subarray(e,e+n);return rP.decode(r)}function oP(t,e,n){return n>sP?iP(t,e,n):tb(t,e,n)}class nl{constructor(e,n){this.type=e,this.data=n}}class qn extends Error{constructor(e){super(e);const n=Object.create(qn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:qn.name})}}const ia=4294967295;function aP(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function nb(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function rb(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function cP(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const lP=-1,uP=4294967296-1,dP=17179869184-1;function hP({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=dP)if(e===0&&t<=uP){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),nb(r,4,t),n}}function fP(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function pP(t){if(t instanceof Date){const e=fP(t);return hP(e)}else return null}function gP(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=rb(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new qn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function mP(t){const e=gP(t);return new Date(e.sec*1e3+e.nsec/1e6)}const yP={type:lP,encode:pP,decode:mP};class iu{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(yP)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new nl(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new nl(o,i)}}}return e instanceof nl?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new nl(n,e)}}iu.defaultCodec=new iu;function wP(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function zh(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):wP(t)?new Uint8Array(t):Uint8Array.from(t)}const EP=100,bP=2048;let CP=class sb{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??iu.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??EP,this.initialBufferSize=e?.initialBufferSize??bP,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new sb({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=Zk(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),tP(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=zh(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),aP(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),nb(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function vP(t,e){return new CP(e).encodeSharedRef(t)}function Bd(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const _P=16,AP=16;class SP{constructor(e=_P,n=AP){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=tb(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const Vh="array",Da="map_key",ib="map_value",IP=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new qn("The type of key must be string or number but "+typeof t)};class TP{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Vh,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Da,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Vh){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Da||e.type===ib){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const oa=-1,up=new DataView(new ArrayBuffer(0)),NP=new Uint8Array(up.buffer);try{up.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const _m=new RangeError("Insufficient data"),xP=new SP;let OP=class ob{constructor(e){this.totalPos=0,this.pos=0,this.view=up,this.bytes=NP,this.headByte=oa,this.stack=new TP,this.entered=!1,this.extensionCodec=e?.extensionCodec??iu.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??ia,this.maxBinLength=e?.maxBinLength??ia,this.maxArrayLength=e?.maxArrayLength??ia,this.maxMapLength=e?.maxMapLength??ia,this.maxExtLength=e?.maxExtLength??ia,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:xP,this.mapKeyConverter=e?.mapKeyConverter??IP}clone(){return new ob({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=oa,this.stack.reset()}setBuffer(e){const n=zh(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===oa&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=zh(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Bd(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new qn(`Unrecognized type byte: ${Bd(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===Vh)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===Da){if(n==="__proto__")throw new qn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=ib;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=Da;continue e}}return n}}readHeadByte(){return this.headByte===oa&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=oa}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new qn(`Unrecognized array type byte: ${Bd(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new qn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new qn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new qn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw _m;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?s=this.keyDecoder.decode(this.bytes,r,e):s=oP(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Da:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new qn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw _m;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new qn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=cP(this.view,this.pos);return this.pos+=8,e}readI64(){const e=rb(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function RP(t,e){return new OP(e).decode(t)}function dp(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function ab(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?dp(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ua(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=ab(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return dp(n)}function kP(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var w=0,b=0,R=0,k=m.length;R!==k&&m[R]===0;)R++,w++;for(var S=(k-R)*u+1>>>0,O=new Uint8Array(S);R!==k;){for(var U=m[R],F=0,q=S-1;(U!==0||F<b)&&q!==-1;q--,F++)U+=256*O[q]>>>0,O[q]=U%a>>>0,U=U/a>>>0;if(U!==0)throw new Error("Non-zero carry");b=F,R++}for(var V=S-b;V!==S&&O[V]===0;)V++;for(var L=c.repeat(w);V<S;++V)L+=t.charAt(O[V]);return L}function h(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var w=0;if(m[w]!==" "){for(var b=0,R=0;m[w]===c;)b++,w++;for(var k=(m.length-w)*l+1>>>0,S=new Uint8Array(k);m[w];){var O=n[m.charCodeAt(w)];if(O===255)return;for(var U=0,F=k-1;(O!==0||U<R)&&F!==-1;F--,U++)O+=a*S[F]>>>0,S[F]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");R=U,w++}if(m[w]!==" "){for(var q=k-R;q!==k&&S[q]===0;)q++;for(var V=new Uint8Array(b+(k-q)),L=b;q!==k;)V[L++]=S[q++];return V}}}function p(m){var w=h(m);if(w)return w;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var PP=kP,DP=PP;const UP=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},$P=t=>new TextEncoder().encode(t),BP=t=>new TextDecoder().decode(t);class LP{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class MP{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return cb(this,e)}}class FP{constructor(e){this.decoders=e}or(e){return cb(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const cb=(t,e)=>new FP({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class jP{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new LP(e,n,r),this.decoder=new MP(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Du=({name:t,prefix:e,encode:n,decode:r})=>new jP(t,e,n,r),Oc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=DP(n,e);return Du({prefix:t,name:e,encode:r,decode:i=>UP(s(i))})},WP=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},HP=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},en=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Du({prefix:e,name:t,encode(s){return HP(s,r,n)},decode(s){return WP(s,r,n,t)}}),qP=Du({prefix:"\0",name:"identity",encode:t=>BP(t),decode:t=>$P(t)}),zP=Object.freeze(Object.defineProperty({__proto__:null,identity:qP},Symbol.toStringTag,{value:"Module"})),VP=en({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),KP=Object.freeze(Object.defineProperty({__proto__:null,base2:VP},Symbol.toStringTag,{value:"Module"})),GP=en({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),YP=Object.freeze(Object.defineProperty({__proto__:null,base8:GP},Symbol.toStringTag,{value:"Module"})),ZP=Oc({prefix:"9",name:"base10",alphabet:"0123456789"}),JP=Object.freeze(Object.defineProperty({__proto__:null,base10:ZP},Symbol.toStringTag,{value:"Module"})),XP=en({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),QP=en({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),e3=Object.freeze(Object.defineProperty({__proto__:null,base16:XP,base16upper:QP},Symbol.toStringTag,{value:"Module"})),t3=en({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),n3=en({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),r3=en({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),s3=en({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i3=en({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),o3=en({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),a3=en({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),c3=en({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),l3=en({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),u3=Object.freeze(Object.defineProperty({__proto__:null,base32:t3,base32hex:i3,base32hexpad:a3,base32hexpadupper:c3,base32hexupper:o3,base32pad:r3,base32padupper:s3,base32upper:n3,base32z:l3},Symbol.toStringTag,{value:"Module"})),d3=Oc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),h3=Oc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),f3=Object.freeze(Object.defineProperty({__proto__:null,base36:d3,base36upper:h3},Symbol.toStringTag,{value:"Module"})),p3=Oc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),g3=Oc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),m3=Object.freeze(Object.defineProperty({__proto__:null,base58btc:p3,base58flickr:g3},Symbol.toStringTag,{value:"Module"})),y3=en({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),w3=en({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),E3=en({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),b3=en({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),C3=Object.freeze(Object.defineProperty({__proto__:null,base64:y3,base64pad:w3,base64url:E3,base64urlpad:b3},Symbol.toStringTag,{value:"Module"})),lb=Array.from(""),v3=lb.reduce((t,e,n)=>(t[n]=e,t),[]),_3=lb.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function A3(t){return t.reduce((e,n)=>(e+=v3[n],e),"")}function S3(t){const e=[];for(const n of t){const r=_3[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const I3=Du({prefix:"",name:"base256emoji",encode:A3,decode:S3}),T3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:I3},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Am={...zP,...KP,...YP,...JP,...e3,...u3,...f3,...m3,...C3,...T3};function ub(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Sm=ub("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ld=ub("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=ab(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),db={utf8:Sm,"utf-8":Sm,hex:Am.base16,latin1:Ld,ascii:Ld,binary:Ld,...Am};function ar(t,e="utf8"){const n=db[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?dp(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Dn(t,e="utf8"){const n=db[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const N3={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},x3="Input must be an string, Buffer or Uint8Array";function O3(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(x3);return e}function R3(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function rl(t){return(4294967296+t).toString(16).substring(1)}function k3(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=rl(e[s]).toUpperCase(),r+=" ",r+=rl(e[s+1]).toUpperCase();else if(n===64)r+=rl(e[s+1]).toUpperCase(),r+=rl(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function P3(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<n;o++){const a=t(s),c=new Date().getTime(),l=c-r;r=c,console.log("Hashed in "+l+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(l/1e3)*100)/100+" MB PER SECOND")}}var hb={normalizeInput:O3,toHex:R3,debugPrint:k3,testSpeed:P3};const xl=hb;function sl(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function Im(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function fb(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Os(t,e,n,r,s,i){const o=Ia[s],a=Ia[s+1],c=Ia[i],l=Ia[i+1];sl(De,t,e),Im(De,t,o,a);let u=De[r]^De[t],d=De[r+1]^De[t+1];De[r]=d,De[r+1]=u,sl(De,n,r),u=De[e]^De[n],d=De[e+1]^De[n+1],De[e]=u>>>24^d<<8,De[e+1]=d>>>24^u<<8,sl(De,t,e),Im(De,t,c,l),u=De[r]^De[t],d=De[r+1]^De[t+1],De[r]=u>>>16^d<<16,De[r+1]=d>>>16^u<<16,sl(De,n,r),u=De[e]^De[n],d=De[e+1]^De[n+1],De[e]=d>>>31^u<<1,De[e+1]=u>>>31^d<<1}const pb=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),D3=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],nn=new Uint8Array(D3.map(function(t){return t*2})),De=new Uint32Array(32),Ia=new Uint32Array(32);function gb(t,e){let n=0;for(n=0;n<16;n++)De[n]=t.h[n],De[n+16]=pb[n];for(De[24]=De[24]^t.t,De[25]=De[25]^t.t/4294967296,e&&(De[28]=~De[28],De[29]=~De[29]),n=0;n<32;n++)Ia[n]=fb(t.b,4*n);for(n=0;n<12;n++)Os(0,8,16,24,nn[n*16+0],nn[n*16+1]),Os(2,10,18,26,nn[n*16+2],nn[n*16+3]),Os(4,12,20,28,nn[n*16+4],nn[n*16+5]),Os(6,14,22,30,nn[n*16+6],nn[n*16+7]),Os(0,10,20,30,nn[n*16+8],nn[n*16+9]),Os(2,12,22,24,nn[n*16+10],nn[n*16+11]),Os(4,14,16,26,nn[n*16+12],nn[n*16+13]),Os(6,8,18,28,nn[n*16+14],nn[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^De[n]^De[n+16]}const Rs=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function mb(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};Rs.fill(0),Rs[0]=t,e&&(Rs[1]=e.length),Rs[2]=1,Rs[3]=1,n&&Rs.set(n,32),r&&Rs.set(r,48);for(let i=0;i<16;i++)s.h[i]=pb[i]^fb(Rs,i*4);return e&&(hp(s,e),s.c=128),s}function hp(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,gb(t,!1),t.c=0),t.b[t.c++]=e[n]}function yb(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;gb(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function wb(t,e,n,r,s){n=n||64,t=xl.normalizeInput(t),r&&(r=xl.normalizeInput(r)),s&&(s=xl.normalizeInput(s));const i=mb(n,e,r,s);return hp(i,t),yb(i)}function U3(t,e,n,r,s){const i=wb(t,e,n,r,s);return xl.toHex(i)}var $3={blake2b:wb,blake2bHex:U3,blake2bInit:mb,blake2bUpdate:hp,blake2bFinal:yb};const Eb=hb;function B3(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function ks(t,e,n,r,s,i){Ze[t]=Ze[t]+Ze[e]+s,Ze[r]=il(Ze[r]^Ze[t],16),Ze[n]=Ze[n]+Ze[r],Ze[e]=il(Ze[e]^Ze[n],12),Ze[t]=Ze[t]+Ze[e]+i,Ze[r]=il(Ze[r]^Ze[t],8),Ze[n]=Ze[n]+Ze[r],Ze[e]=il(Ze[e]^Ze[n],7)}function il(t,e){return t>>>e^t<<32-e}const bb=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),rn=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),Ze=new Uint32Array(16),Kt=new Uint32Array(16);function Cb(t,e){let n=0;for(n=0;n<8;n++)Ze[n]=t.h[n],Ze[n+8]=bb[n];for(Ze[12]^=t.t,Ze[13]^=t.t/4294967296,e&&(Ze[14]=~Ze[14]),n=0;n<16;n++)Kt[n]=B3(t.b,4*n);for(n=0;n<10;n++)ks(0,4,8,12,Kt[rn[n*16+0]],Kt[rn[n*16+1]]),ks(1,5,9,13,Kt[rn[n*16+2]],Kt[rn[n*16+3]]),ks(2,6,10,14,Kt[rn[n*16+4]],Kt[rn[n*16+5]]),ks(3,7,11,15,Kt[rn[n*16+6]],Kt[rn[n*16+7]]),ks(0,5,10,15,Kt[rn[n*16+8]],Kt[rn[n*16+9]]),ks(1,6,11,12,Kt[rn[n*16+10]],Kt[rn[n*16+11]]),ks(2,7,8,13,Kt[rn[n*16+12]],Kt[rn[n*16+13]]),ks(3,4,9,14,Kt[rn[n*16+14]],Kt[rn[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=Ze[n]^Ze[n+8]}function vb(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(bb),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&(fp(r,e),r.c=64),r}function fp(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,Cb(t,!1),t.c=0),t.b[t.c++]=e[n]}function _b(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;Cb(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function Ab(t,e,n){n=n||32,t=Eb.normalizeInput(t);const r=vb(n,e);return fp(r,t),_b(r)}function L3(t,e,n){const r=Ab(t,e,n);return Eb.toHex(r)}var M3={blake2s:Ab,blake2sHex:L3,blake2sInit:vb,blake2sUpdate:fp,blake2sFinal:_b};const aa=$3,ca=M3;var F3={blake2b:aa.blake2b,blake2bHex:aa.blake2bHex,blake2bInit:aa.blake2bInit,blake2bUpdate:aa.blake2bUpdate,blake2bFinal:aa.blake2bFinal,blake2s:ca.blake2s,blake2sHex:ca.blake2sHex,blake2sInit:ca.blake2sInit,blake2sUpdate:ca.blake2sUpdate,blake2sFinal:ca.blake2sFinal},j3={};const W3=":";function ys(t){const[e,n]=t.split(W3);return{namespace:e,reference:n}}function Sb(t,e){return t.includes(":")?[t]:e.chains||[]}var H3=Object.defineProperty,q3=Object.defineProperties,z3=Object.getOwnPropertyDescriptors,Tm=Object.getOwnPropertySymbols,V3=Object.prototype.hasOwnProperty,K3=Object.prototype.propertyIsEnumerable,Kh=(t,e,n)=>e in t?H3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nm=(t,e)=>{for(var n in e||(e={}))V3.call(e,n)&&Kh(t,n,e[n]);if(Tm)for(var n of Tm(e))K3.call(e,n)&&Kh(t,n,e[n]);return t},G3=(t,e)=>q3(t,z3(e)),xm=(t,e,n)=>Kh(t,typeof e!="symbol"?e+"":e,n);const Y3="ReactNative",Yn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Z3="js";function ou(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ci(){return!Hi()&&!!Qf()&&navigator.product===Y3}function J3(){return ci()&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"&&globalThis?.Platform.OS==="android"}function X3(){return ci()&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"&&globalThis?.Platform.OS==="ios"}function Go(){return!ou()&&!!Qf()&&!!Hi()}function Rc(){return ci()?Yn.reactNative:ou()?Yn.node:Go()?Yn.browser:Yn.unknown}function Om(){var t;try{return ci()&&typeof globalThis<"u"&&typeof globalThis?.Application<"u"?(t=globalThis.Application)==null?void 0:t.applicationId:void 0}catch{return}}function Q3(t,e){const n=new URLSearchParams(t);return Object.entries(e).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!=null&&n.set(r,String(s))}),n.toString()}function eD(t){var e,n;const r=Ib();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),G3(Nm(Nm({},r),t),{url:t?.url||r.url,name:t?.name||r.name,description:t?.description||r.description,icons:(n=t?.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function Ib(){return wE()||{name:"",description:"",url:"",icons:[""]}}function tD(){if(Rc()===Yn.reactNative&&typeof globalThis<"u"&&typeof globalThis?.Platform<"u"){const{OS:n,Version:r}=globalThis.Platform;return[n,r].join("-")}const t=SO();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function nD(){var t;const e=Rc();return e===Yn.browser?[e,((t=yE())==null?void 0:t.host)||"unknown"].join(":"):e}function Tb(t,e,n){const r=tD(),s=nD();return[[t,e].join("-"),[Z3,n].join("-"),r,s].join("/")}function rD({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=Tb(t,e,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=Q3(l[1]||"",d);return l[0]+"?"+h}function Ti(t,e){return t.filter(n=>e.includes(n)).length===t.length}function Gh(t){return Object.fromEntries(t.entries())}function Yh(t){return new Map(Object.entries(t))}function Ci(t=oe.FIVE_MINUTES,e){const n=oe.toMiliseconds(t||oe.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function jr(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function Nb(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function sD(t){return Nb("topic",t)}function iD(t){return Nb("id",t)}function xb(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function Rt(t,e){return oe.fromMiliseconds(Date.now()+oe.toMiliseconds(t))}function Br(t){return Date.now()>=oe.toMiliseconds(t)}function nt(t,e){return`${t}${e?`:${e}`:""}`}function qr(t=[],e=[]){return[...new Set([...t,...e])]}async function oD({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=aD(i,t,e),a=Rc();if(a===Yn.browser){if(!((r=Hi())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}cD(o)}else a===Yn.reactNative&&typeof globalThis?.Linking<"u"&&await globalThis.Linking.openURL(o)}catch(s){console.error(s)}}function aD(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${hD(r,!0)}`}else s=`${s}/wc?${r}`;return s}function cD(t){let e="_self";dD()?e="_top":(uD()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function lD(t,e){let n="";try{if(Go()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function Rm(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function km(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function pp(){return typeof process<"u"&&j3.IS_VITEST==="true"}function uD(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function dD(){try{return window.self!==window.top}catch{return!1}}function hD(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function Ob(t){return Buffer.from(t,"base64").toString("utf-8")}function fD(t){return new Promise(e=>setTimeout(e,t))}let pD=class{constructor({limit:e}){xm(this,"limit"),xm(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const ol=BigInt(2**32-1),Pm=BigInt(32);function Rb(t,e=!1){return e?{h:Number(t&ol),l:Number(t>>Pm&ol)}:{h:Number(t>>Pm&ol)|0,l:Number(t&ol)|0}}function kb(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=Rb(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const Dm=(t,e,n)=>t>>>n,Um=(t,e,n)=>t<<32-n|e>>>n,Fs=(t,e,n)=>t>>>n|e<<32-n,js=(t,e,n)=>t<<32-n|e>>>n,Ta=(t,e,n)=>t<<64-n|e>>>n-32,Na=(t,e,n)=>t>>>n-32|e<<64-n,gD=(t,e)=>e,mD=(t,e)=>t,yD=(t,e,n)=>t<<n|e>>>32-n,wD=(t,e,n)=>e<<n|t>>>32-n,ED=(t,e,n)=>e<<n-32|t>>>64-n,bD=(t,e,n)=>t<<n-32|e>>>64-n;function yr(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const gp=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),mp=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,CD=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),vD=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,_D=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),AD=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,ho=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Uu(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function vs(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Tr(t,...e){if(!Uu(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function $u(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");vs(t.outputLen),vs(t.blockLen)}function ai(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function yp(t,e){Tr(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function fc(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function cr(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Md(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Rr(t,e){return t<<32-e|t>>>e}const Pb=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Db(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const ss=Pb?t=>t:t=>Db(t);function SD(t){for(let e=0;e<t.length;e++)t[e]=Db(t[e]);return t}const Ws=Pb?t=>t:SD,Ub=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ID=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ro(t){if(Tr(t),Ub)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=ID[t[n]];return e}const ts={_0:48,_9:57,A:65,F:70,a:97,f:102};function $m(t){if(t>=ts._0&&t<=ts._9)return t-ts._0;if(t>=ts.A&&t<=ts.F)return t-(ts.A-10);if(t>=ts.a&&t<=ts.f)return t-(ts.a-10)}function au(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Ub)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=$m(t.charCodeAt(i)),a=$m(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function $b(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Sr(t){return typeof t=="string"&&(t=$b(t)),Tr(t),t}function zs(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Tr(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let Bu=class{};function kc(t){const e=r=>t().update(Sr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function TD(t){const e=(r,s)=>t(s).update(Sr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function to(t=32){if(ho&&typeof ho.getRandomValues=="function")return ho.getRandomValues(new Uint8Array(t));if(ho&&typeof ho.randomBytes=="function")return Uint8Array.from(ho.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const ND=BigInt(0),la=BigInt(1),xD=BigInt(2),OD=BigInt(7),RD=BigInt(256),kD=BigInt(113),Bb=[],Lb=[],Mb=[];for(let t=0,e=la,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],Bb.push(2*(5*r+n)),Lb.push((t+1)*(t+2)/2%64);let s=ND;for(let i=0;i<7;i++)e=(e<<la^(e>>OD)*kD)%RD,e&xD&&(s^=la<<(la<<BigInt(i))-la);Mb.push(s)}const Fb=kb(Mb,!0),PD=Fb[0],DD=Fb[1],Bm=(t,e,n)=>n>32?ED(t,e,n):yD(t,e,n),Lm=(t,e,n)=>n>32?bD(t,e,n):wD(t,e,n);function UD(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Bm(l,u,1)^n[a],h=Lm(l,u,1)^n[a+1];for(let p=0;p<50;p+=10)t[o+p]^=d,t[o+p+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Lb[o],c=Bm(s,i,a),l=Lm(s,i,a),u=Bb[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=PD[r],t[1]^=DD[r]}cr(n)}let $D=class jb extends Bu{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,vs(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=fc(this.state)}clone(){return this._cloneInto()}keccak(){Ws(this.state32),UD(this.state32,this.rounds),Ws(this.state32),this.posOut=0,this.pos=0}update(e){ai(this),e=Sr(e),Tr(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){ai(this,!1),Tr(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return vs(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(yp(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,cr(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new jb(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const BD=(t,e,n)=>kc(()=>new $D(e,t,n)),LD=BD(1,136,256/8);function MD(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function FD(t,e,n){return t&e^~t&n}function jD(t,e,n){return t&e^t&n^e&n}let Wb=class extends Bu{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Md(this.buffer)}update(e){ai(this),e=Sr(e),Tr(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Md(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ai(this),yp(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,cr(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;MD(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Md(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Ps=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),sn=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),on=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),WD=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ds=new Uint32Array(64);class HD extends Wb{constructor(e=32){super(64,e,8,!1),this.A=Ps[0]|0,this.B=Ps[1]|0,this.C=Ps[2]|0,this.D=Ps[3]|0,this.E=Ps[4]|0,this.F=Ps[5]|0,this.G=Ps[6]|0,this.H=Ps[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Ds[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Ds[d-15],p=Ds[d-2],m=Rr(h,7)^Rr(h,18)^h>>>3,w=Rr(p,17)^Rr(p,19)^p>>>10;Ds[d]=w+Ds[d-7]+m+Ds[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=Rr(a,6)^Rr(a,11)^Rr(a,25),p=u+h+FD(a,c,l)+WD[d]+Ds[d]|0,m=(Rr(r,2)^Rr(r,13)^Rr(r,22))+jD(r,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=r,r=p+m|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){cr(Ds)}destroy(){this.set(0,0,0,0,0,0,0,0),cr(this.buffer)}}const Hb=kb(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),qD=Hb[0],zD=Hb[1],Us=new Uint32Array(80),$s=new Uint32Array(80);let wp=class extends Wb{constructor(e=64){super(128,e,16,!1),this.Ah=on[0]|0,this.Al=on[1]|0,this.Bh=on[2]|0,this.Bl=on[3]|0,this.Ch=on[4]|0,this.Cl=on[5]|0,this.Dh=on[6]|0,this.Dl=on[7]|0,this.Eh=on[8]|0,this.El=on[9]|0,this.Fh=on[10]|0,this.Fl=on[11]|0,this.Gh=on[12]|0,this.Gl=on[13]|0,this.Hh=on[14]|0,this.Hl=on[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:m,Hh:w,Hl:b}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,p,m,w,b]}set(e,n,r,s,i,o,a,c,l,u,d,h,p,m,w,b){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=m|0,this.Hh=w|0,this.Hl=b|0}process(e,n){for(let S=0;S<16;S++,n+=4)Us[S]=e.getUint32(n),$s[S]=e.getUint32(n+=4);for(let S=16;S<80;S++){const O=Us[S-15]|0,U=$s[S-15]|0,F=Fs(O,U,1)^Fs(O,U,8)^Dm(O,U,7),q=js(O,U,1)^js(O,U,8)^Um(O,U,7),V=Us[S-2]|0,L=$s[S-2]|0,Y=Fs(V,L,19)^Ta(V,L,61)^Dm(V,L,6),G=js(V,L,19)^Na(V,L,61)^Um(V,L,6),W=CD(q,G,$s[S-7],$s[S-16]),D=vD(W,F,Y,Us[S-7],Us[S-16]);Us[S]=D|0,$s[S]=W|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:m,Gh:w,Gl:b,Hh:R,Hl:k}=this;for(let S=0;S<80;S++){const O=Fs(d,h,14)^Fs(d,h,18)^Ta(d,h,41),U=js(d,h,14)^js(d,h,18)^Na(d,h,41),F=d&p^~d&w,q=h&m^~h&b,V=_D(k,U,q,zD[S],$s[S]),L=AD(V,R,O,F,qD[S],Us[S]),Y=V|0,G=Fs(r,s,28)^Ta(r,s,34)^Ta(r,s,39),W=js(r,s,28)^Na(r,s,34)^Na(r,s,39),D=r&i^r&a^i&a,P=s&o^s&c^o&c;R=w|0,k=b|0,w=p|0,b=m|0,p=d|0,m=h|0,{h:d,l:h}=yr(l|0,u|0,L|0,Y|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const y=gp(Y,W,P);r=mp(y,L,G,D),s=y|0}({h:r,l:s}=yr(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=yr(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=yr(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=yr(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=yr(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:m}=yr(this.Fh|0,this.Fl|0,p|0,m|0),{h:w,l:b}=yr(this.Gh|0,this.Gl|0,w|0,b|0),{h:R,l:k}=yr(this.Hh|0,this.Hl|0,R|0,k|0),this.set(r,s,i,o,a,c,l,u,d,h,p,m,w,b,R,k)}roundClean(){cr(Us,$s)}destroy(){cr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class VD extends wp{constructor(){super(48),this.Ah=sn[0]|0,this.Al=sn[1]|0,this.Bh=sn[2]|0,this.Bl=sn[3]|0,this.Ch=sn[4]|0,this.Cl=sn[5]|0,this.Dh=sn[6]|0,this.Dl=sn[7]|0,this.Eh=sn[8]|0,this.El=sn[9]|0,this.Fh=sn[10]|0,this.Fl=sn[11]|0,this.Gh=sn[12]|0,this.Gl=sn[13]|0,this.Hh=sn[14]|0,this.Hl=sn[15]|0}}const an=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class KD extends wp{constructor(){super(32),this.Ah=an[0]|0,this.Al=an[1]|0,this.Bh=an[2]|0,this.Bl=an[3]|0,this.Ch=an[4]|0,this.Cl=an[5]|0,this.Dh=an[6]|0,this.Dl=an[7]|0,this.Eh=an[8]|0,this.El=an[9]|0,this.Fh=an[10]|0,this.Fl=an[11]|0,this.Gh=an[12]|0,this.Gl=an[13]|0,this.Hh=an[14]|0,this.Hl=an[15]|0}}const Lu=kc(()=>new HD),GD=kc(()=>new wp),YD=kc(()=>new VD),ZD=kc(()=>new KD),JD=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Ut=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),le=new Uint32Array(32);function Bs(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=le[2*t],l=le[2*t+1],u=le[2*e],d=le[2*e+1],h=le[2*n],p=le[2*n+1],m=le[2*r],w=le[2*r+1],b=gp(c,u,o);l=mp(b,l,d,a),c=b|0,{Dh:w,Dl:m}={Dh:w^l,Dl:m^c},{Dh:w,Dl:m}={Dh:gD(w,m),Dl:mD(w)},{h:p,l:h}=yr(p,h,w,m),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:Fs(d,u,24),Bl:js(d,u,24)},le[2*t]=c,le[2*t+1]=l,le[2*e]=u,le[2*e+1]=d,le[2*n]=h,le[2*n+1]=p,le[2*r]=m,le[2*r+1]=w}function Ls(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=le[2*t],l=le[2*t+1],u=le[2*e],d=le[2*e+1],h=le[2*n],p=le[2*n+1],m=le[2*r],w=le[2*r+1],b=gp(c,u,o);l=mp(b,l,d,a),c=b|0,{Dh:w,Dl:m}={Dh:w^l,Dl:m^c},{Dh:w,Dl:m}={Dh:Fs(w,m,16),Dl:js(w,m,16)},{h:p,l:h}=yr(p,h,w,m),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:Ta(d,u,63),Bl:Na(d,u,63)},le[2*t]=c,le[2*t+1]=l,le[2*e]=u,le[2*e+1]=d,le[2*n]=h,le[2*n+1]=p,le[2*r]=m,le[2*r+1]=w}function XD(t,e={},n,r,s){if(vs(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class QD extends Bu{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,vs(e),vs(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=fc(this.buffer)}update(e){ai(this),e=Sr(e),Tr(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(Ws(s),this.compress(s,0,!1),Ws(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));Ws(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);Ws(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){ai(this),yp(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,cr(this.buffer.subarray(n)),Ws(r),this.compress(r,0,!0),Ws(r);const s=fc(e);this.get().forEach((i,o)=>s[o]=ss(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class eU extends QD{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=Ut[0]|0,this.v0h=Ut[1]|0,this.v1l=Ut[2]|0,this.v1h=Ut[3]|0,this.v2l=Ut[4]|0,this.v2h=Ut[5]|0,this.v3l=Ut[6]|0,this.v3h=Ut[7]|0,this.v4l=Ut[8]|0,this.v4h=Ut[9]|0,this.v5l=Ut[10]|0,this.v5h=Ut[11]|0,this.v6l=Ut[12]|0,this.v6h=Ut[13]|0,this.v7l=Ut[14]|0,this.v7h=Ut[15]|0,XD(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=Sr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=Sr(i);const a=fc(i);this.v4l^=ss(a[0]),this.v4h^=ss(a[1]),this.v5l^=ss(a[2]),this.v5h^=ss(a[3])}if(s!==void 0){s=Sr(s);const a=fc(s);this.v6l^=ss(a[0]),this.v6h^=ss(a[1]),this.v7l^=ss(a[2]),this.v7h^=ss(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:p,v6h:m,v7l:w,v7h:b}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,p,m,w,b]}set(e,n,r,s,i,o,a,c,l,u,d,h,p,m,w,b){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=p|0,this.v6h=m|0,this.v7l=w|0,this.v7h=b|0}compress(e,n,r){this.get().forEach((c,l)=>le[l]=c),le.set(Ut,16);let{h:s,l:i}=Rb(BigInt(this.length));le[24]=Ut[8]^i,le[25]=Ut[9]^s,r&&(le[28]=~le[28],le[29]=~le[29]);let o=0;const a=JD;for(let c=0;c<12;c++)Bs(0,4,8,12,e,n+2*a[o++]),Ls(0,4,8,12,e,n+2*a[o++]),Bs(1,5,9,13,e,n+2*a[o++]),Ls(1,5,9,13,e,n+2*a[o++]),Bs(2,6,10,14,e,n+2*a[o++]),Ls(2,6,10,14,e,n+2*a[o++]),Bs(3,7,11,15,e,n+2*a[o++]),Ls(3,7,11,15,e,n+2*a[o++]),Bs(0,5,10,15,e,n+2*a[o++]),Ls(0,5,10,15,e,n+2*a[o++]),Bs(1,6,11,12,e,n+2*a[o++]),Ls(1,6,11,12,e,n+2*a[o++]),Bs(2,7,8,13,e,n+2*a[o++]),Ls(2,7,8,13,e,n+2*a[o++]),Bs(3,4,9,14,e,n+2*a[o++]),Ls(3,4,9,14,e,n+2*a[o++]);this.v0l^=le[0]^le[16],this.v0h^=le[1]^le[17],this.v1l^=le[2]^le[18],this.v1h^=le[3]^le[19],this.v2l^=le[4]^le[20],this.v2h^=le[5]^le[21],this.v3l^=le[6]^le[22],this.v3h^=le[7]^le[23],this.v4l^=le[8]^le[24],this.v4h^=le[9]^le[25],this.v5l^=le[10]^le[26],this.v5h^=le[11]^le[27],this.v6l^=le[12]^le[28],this.v6h^=le[13]^le[29],this.v7l^=le[14]^le[30],this.v7h^=le[15]^le[31],cr(le)}destroy(){this.destroyed=!0,cr(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const tU=TD(t=>new eU(t)),nU="https://rpc.walletconnect.org/v1";function qb(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(LD(n)).toString("hex")}async function rU(t,e,n,r,s,i){switch(n.t){case"eip191":return await sU(t,e,n.s);case"eip1271":return await iU(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}function sU(t,e,n){const r=Pk(n);return Vk({payload:qb(e),signature:r}).toLowerCase()===t.toLowerCase()}async function iU(t,e,n,r,s,i){const o=ys(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:qb(e)).substring(2),h=a+d+c+u+l,p=await fetch(`${i||nU}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:oU(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:m}=await p.json();return m?m.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function oU(){return Date.now()+Math.floor(Math.random()*1e3)}function aU(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return xc.encode(i)}function cU(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=tU(r,{dkLen:32});return xc.encode(s)}function Mm(t){const e=new Uint8Array(Lu(lU(t)));return xc.encode(e)}function lU(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Fm(t){const e=Buffer.from(t,"base64"),n=RP(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=vP(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=ZD(i);return zk.encode(o).replace(/=+$/,"")}function Fd(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function uU(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Fd(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Fd(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(Fd(r.length)),s.push(r);const i=Buffer.concat(s),o=Lu(i);return Buffer.from(o).toString("hex").toUpperCase()}function dU(t){var e,n;const r=[];try{if(typeof t=="string")return r.push(t),r;if(typeof t!="object")return r;t!=null&&t.id&&r.push(t.id);const s=(n=(e=t?.capabilities)==null?void 0:e.caip345)==null?void 0:n.transactionHashes;s&&r.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return r}var hU=Object.defineProperty,fU=Object.defineProperties,pU=Object.getOwnPropertyDescriptors,jm=Object.getOwnPropertySymbols,gU=Object.prototype.hasOwnProperty,mU=Object.prototype.propertyIsEnumerable,Wm=(t,e,n)=>e in t?hU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yU=(t,e)=>{for(var n in e||(e={}))gU.call(e,n)&&Wm(t,n,e[n]);if(jm)for(var n of jm(e))mU.call(e,n)&&Wm(t,n,e[n]);return t},wU=(t,e)=>fU(t,pU(e));const zb="did:pkh:",EU={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},bU=t=>t?EU[t]||t:"",Mu=t=>t?.split(":"),CU=t=>{const e=t&&Mu(t);if(e)return t.includes(zb)?e[3]:e[1]},vU=t=>{const e=t&&Mu(t);if(e)return t.includes(zb)?e[2]:e[0]},Zh=t=>{const e=t&&Mu(t);if(e)return e[2]+":"+e[3]},cu=t=>{const e=t&&Mu(t);if(e)return e.pop()};async function Hm(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=Vb(s,s.iss),o=cu(s.iss);return await rU(o,i,r,Zh(s.iss),n)}const Vb=(t,e)=>{const n=vU(e);if(!n)throw new Error("Invalid issuer: "+e);const r=`${t.domain} wants you to sign in with your ${bU(n)} account:`,s=cu(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const o=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${CU(e)}`,l=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,d=t.exp?`Expiration Time: ${t.exp}`:void 0,h=t.nbf?`Not Before: ${t.nbf}`:void 0,p=t.requestId?`Request ID: ${t.requestId}`:void 0,m=t.resources?`Resources:${t.resources.map(b=>`
- ${b}`).join("")}`:void 0,w=Ol(t.resources);if(w){const b=pc(w);i=RU(i,b)}return[r,s,"",i,"",o,a,c,l,u,d,h,p,m].filter(b=>b!=null).join(`
`)};function _U(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function AU(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function zi(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function SU(t,e,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:IU(e,n,r)}}}function IU(t,e,n={}){e=e?.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function Kb(t){return zi(t),`urn:recap:${_U(t).replace(/=/g,"")}`}function pc(t){const e=AU(t.replace("urn:recap:",""));return zi(e),e}function TU(t,e,n){const r=SU(t,e,n);return Kb(r)}function NU(t){return t&&t.includes("urn:recap:")}function xU(t,e){const n=pc(t),r=pc(e),s=OU(n,r);return Kb(s)}function OU(t,e){zi(t),zi(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=wU(yU({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function RU(t="",e){zi(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function qm(t){var e;const n=pc(t);zi(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function zm(t){const e=pc(t);zi(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function Ol(t){if(!t)return;const e=t?.[t.length-1];return NU(e)?e:void 0}function Gb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Jh(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function jd(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function xn(t,...e){if(!Gb(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Vm(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function kU(t,e){xn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function ei(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function jo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function PU(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const DU=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function UU(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Xh(t){if(typeof t=="string")t=UU(t);else if(Gb(t))t=Qh(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function $U(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function BU(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const LU=(t,e)=>{function n(r,...s){if(xn(r),!DU)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?xn(l):xn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&xn(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");xn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,xn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(xn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,t),n};function Km(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!FU(e))throw new Error("invalid output, must be aligned");return e}function Gm(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function MU(t,e,n){Jh(n);const r=new Uint8Array(16),s=PU(r);return Gm(s,0,BigInt(e),n),Gm(s,8,BigInt(t),n),r}function FU(t){return t.byteOffset%4===0}function Qh(t){return Uint8Array.from(t)}const Yb=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),jU=Yb("expand 16-byte k"),WU=Yb("expand 32-byte k"),HU=ei(jU),qU=ei(WU);function Ge(t,e){return t<<e|t>>>32-e}function ef(t){return t.byteOffset%4===0}const al=64,zU=16,Zb=2**32-1,Ym=new Uint32Array;function VU(t,e,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(al),u=ei(l),d=ef(s)&&ef(i),h=d?ei(s):Ym,p=d?ei(i):Ym;for(let m=0;m<c;o++){if(t(e,n,r,u,o,a),o>=Zb)throw new Error("arx: counter overflow");const w=Math.min(al,c-m);if(d&&w===al){const b=m/4;if(m%4!==0)throw new Error("arx: invalid block position");for(let R=0,k;R<zU;R++)k=b+R,p[k]=h[k]^u[R];m+=al;continue}for(let b=0,R;b<w;b++)R=m+b,i[R]=s[R]^l[b];m+=w}}function KU(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=$U({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return jd(s),jd(o),Jh(i),Jh(n),(a,c,l,u,d=0)=>{xn(a),xn(c),xn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),xn(u),jd(d),d<0||d>=Zb)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const p=[];let m=a.length,w,b;if(m===32)p.push(w=Qh(a)),b=qU;else if(m===16&&n)w=new Uint8Array(32),w.set(a),w.set(a,16),b=HU,p.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${m}`);ef(c)||p.push(c=Qh(c));const R=ei(w);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(b,R,ei(c.subarray(0,16)),R),c=c.subarray(16)}const k=16-s;if(k!==c.length)throw new Error(`arx: nonce must be ${k} or 16 bytes`);if(k!==12){const O=new Uint8Array(12);O.set(c,i?0:12-c.length),c=O,p.push(c)}const S=ei(c);return VU(t,b,R,S,l,u,d,o),jo(...p),u}}const Gt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class GU{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Xh(e),xn(e,32);const n=Gt(e,0),r=Gt(e,2),s=Gt(e,4),i=Gt(e,6),o=Gt(e,8),a=Gt(e,10),c=Gt(e,12),l=Gt(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Gt(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],p=o[6],m=o[7],w=o[8],b=o[9],R=Gt(e,n+0),k=Gt(e,n+2),S=Gt(e,n+4),O=Gt(e,n+6),U=Gt(e,n+8),F=Gt(e,n+10),q=Gt(e,n+12),V=Gt(e,n+14);let L=i[0]+(R&8191),Y=i[1]+((R>>>13|k<<3)&8191),G=i[2]+((k>>>10|S<<6)&8191),W=i[3]+((S>>>7|O<<9)&8191),D=i[4]+((O>>>4|U<<12)&8191),P=i[5]+(U>>>1&8191),y=i[6]+((U>>>14|F<<2)&8191),E=i[7]+((F>>>11|q<<5)&8191),A=i[8]+((q>>>8|V<<8)&8191),N=i[9]+(V>>>5|s),T=0,x=T+L*a+Y*(5*b)+G*(5*w)+W*(5*m)+D*(5*p);T=x>>>13,x&=8191,x+=P*(5*h)+y*(5*d)+E*(5*u)+A*(5*l)+N*(5*c),T+=x>>>13,x&=8191;let M=T+L*c+Y*a+G*(5*b)+W*(5*w)+D*(5*m);T=M>>>13,M&=8191,M+=P*(5*p)+y*(5*h)+E*(5*d)+A*(5*u)+N*(5*l),T+=M>>>13,M&=8191;let H=T+L*l+Y*c+G*a+W*(5*b)+D*(5*w);T=H>>>13,H&=8191,H+=P*(5*m)+y*(5*p)+E*(5*h)+A*(5*d)+N*(5*u),T+=H>>>13,H&=8191;let ne=T+L*u+Y*l+G*c+W*a+D*(5*b);T=ne>>>13,ne&=8191,ne+=P*(5*w)+y*(5*m)+E*(5*p)+A*(5*h)+N*(5*d),T+=ne>>>13,ne&=8191;let Z=T+L*d+Y*u+G*l+W*c+D*a;T=Z>>>13,Z&=8191,Z+=P*(5*b)+y*(5*w)+E*(5*m)+A*(5*p)+N*(5*h),T+=Z>>>13,Z&=8191;let Q=T+L*h+Y*d+G*u+W*l+D*c;T=Q>>>13,Q&=8191,Q+=P*a+y*(5*b)+E*(5*w)+A*(5*m)+N*(5*p),T+=Q>>>13,Q&=8191;let pe=T+L*p+Y*h+G*d+W*u+D*l;T=pe>>>13,pe&=8191,pe+=P*c+y*a+E*(5*b)+A*(5*w)+N*(5*m),T+=pe>>>13,pe&=8191;let ye=T+L*m+Y*p+G*h+W*d+D*u;T=ye>>>13,ye&=8191,ye+=P*l+y*c+E*a+A*(5*b)+N*(5*w),T+=ye>>>13,ye&=8191;let Te=T+L*w+Y*m+G*p+W*h+D*d;T=Te>>>13,Te&=8191,Te+=P*u+y*l+E*c+A*a+N*(5*b),T+=Te>>>13,Te&=8191;let ue=T+L*b+Y*w+G*m+W*p+D*h;T=ue>>>13,ue&=8191,ue+=P*d+y*u+E*l+A*c+N*a,T+=ue>>>13,ue&=8191,T=(T<<2)+T|0,T=T+x|0,x=T&8191,T=T>>>13,M+=T,i[0]=x,i[1]=M,i[2]=H,i[3]=ne,i[4]=Z,i[5]=Q,i[6]=pe,i[7]=ye,i[8]=Te,i[9]=ue}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;jo(r)}update(e){Vm(this),e=Xh(e),xn(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){jo(this.h,this.r,this.buffer,this.pad)}digestInto(e){Vm(this),kU(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function YU(t){const e=(r,s)=>t(s).update(Xh(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const ZU=YU(t=>new GU(t));function JU(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],p=e[3],m=e[4],w=e[5],b=e[6],R=e[7],k=s,S=n[0],O=n[1],U=n[2],F=o,q=a,V=c,L=l,Y=u,G=d,W=h,D=p,P=m,y=w,E=b,A=R,N=k,T=S,x=O,M=U;for(let ne=0;ne<i;ne+=2)F=F+Y|0,N=Ge(N^F,16),P=P+N|0,Y=Ge(Y^P,12),F=F+Y|0,N=Ge(N^F,8),P=P+N|0,Y=Ge(Y^P,7),q=q+G|0,T=Ge(T^q,16),y=y+T|0,G=Ge(G^y,12),q=q+G|0,T=Ge(T^q,8),y=y+T|0,G=Ge(G^y,7),V=V+W|0,x=Ge(x^V,16),E=E+x|0,W=Ge(W^E,12),V=V+W|0,x=Ge(x^V,8),E=E+x|0,W=Ge(W^E,7),L=L+D|0,M=Ge(M^L,16),A=A+M|0,D=Ge(D^A,12),L=L+D|0,M=Ge(M^L,8),A=A+M|0,D=Ge(D^A,7),F=F+G|0,M=Ge(M^F,16),E=E+M|0,G=Ge(G^E,12),F=F+G|0,M=Ge(M^F,8),E=E+M|0,G=Ge(G^E,7),q=q+W|0,N=Ge(N^q,16),A=A+N|0,W=Ge(W^A,12),q=q+W|0,N=Ge(N^q,8),A=A+N|0,W=Ge(W^A,7),V=V+D|0,T=Ge(T^V,16),P=P+T|0,D=Ge(D^P,12),V=V+D|0,T=Ge(T^V,8),P=P+T|0,D=Ge(D^P,7),L=L+Y|0,x=Ge(x^L,16),y=y+x|0,Y=Ge(Y^y,12),L=L+Y|0,x=Ge(x^L,8),y=y+x|0,Y=Ge(Y^y,7);let H=0;r[H++]=o+F|0,r[H++]=a+q|0,r[H++]=c+V|0,r[H++]=l+L|0,r[H++]=u+Y|0,r[H++]=d+G|0,r[H++]=h+W|0,r[H++]=p+D|0,r[H++]=m+P|0,r[H++]=w+y|0,r[H++]=b+E|0,r[H++]=R+A|0,r[H++]=k+N|0,r[H++]=S+T|0,r[H++]=O+x|0,r[H++]=U+M|0}const XU=KU(JU,{counterRight:!1,counterLength:4,allowShortKeys:!1}),QU=new Uint8Array(16),Zm=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(QU.subarray(n))},e8=new Uint8Array(32);function Jm(t,e,n,r,s){const i=t(e,n,e8),o=ZU.create(i);s&&Zm(o,s),Zm(o,r);const a=MU(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return jo(i,a),c}const t8=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=Km(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=Jm(t,e,n,a,r);return i.set(c,o),jo(c),i},decrypt(s,i){i=Km(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=Jm(t,e,n,o,r);if(!BU(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),jo(c),i}}),Jb=LU({blockSize:64,nonceLength:12,tagLength:16},t8(XU));let Xb=class extends Bu{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,$u(e);const r=Sr(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),cr(i)}update(e){return ai(this),this.iHash.update(e),this}digestInto(e){ai(this),Tr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Fu=(t,e,n)=>new Xb(t,e).update(n).digest();Fu.create=(t,e)=>new Xb(t,e);function n8(t,e,n){return $u(t),n===void 0&&(n=new Uint8Array(t.outputLen)),Fu(t,Sr(n),Sr(e))}const Wd=Uint8Array.from([0]),Xm=Uint8Array.of();function r8(t,e,n,r=32){$u(t),vs(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=Xm);const o=new Uint8Array(i*s),a=Fu.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Wd[0]=u+1,c.update(u===0?Xm:l).update(n).update(Wd).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),cr(l,Wd),o.slice(0,r)}const s8=(t,e,n,r,s)=>r8(t,n8(t,e,n),r,s),ju=Lu,Ep=BigInt(0),tf=BigInt(1);function lu(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}"`;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function Ni(t,e,n=""){const r=Uu(t),s=t?.length,i=e!==void 0;if(!r||i&&s!==e){const o=n&&`"${n}" `,a=i?` of length ${e}`:"",c=r?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function cl(t){const e=t.toString(16);return e.length&1?"0"+e:e}function Qb(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Ep:BigInt("0x"+t)}function Wu(t){return Qb(Ro(t))}function uu(t){return Tr(t),Qb(Ro(Uint8Array.from(t).reverse()))}function bp(t,e){return au(t.toString(16).padStart(e*2,"0"))}function Cp(t,e){return bp(t,e).reverse()}function un(t,e,n){let r;if(typeof e=="string")try{r=au(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Uu(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const Hd=t=>typeof t=="bigint"&&Ep<=t;function i8(t,e,n){return Hd(t)&&Hd(e)&&Hd(n)&&e<=t&&t<n}function nf(t,e,n,r){if(!i8(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function eC(t){let e;for(e=0;t>Ep;t>>=tf,e+=1);return e}const Pc=t=>(tf<<BigInt(t))-tf;function o8(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<e;){i=l();const m=i.slice();p.push(m),h+=i.length}return zs(...p)};return(h,p)=>{c(),u(h);let m;for(;!(m=p(d()));)u();return c(),m}}function Hu(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function Qm(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Pn=BigInt(0),wn=BigInt(1),xi=BigInt(2),tC=BigInt(3),nC=BigInt(4),rC=BigInt(5),a8=BigInt(7),sC=BigInt(8),c8=BigInt(9),iC=BigInt(16);function zn(t,e){const n=t%e;return n>=Pn?n:e+n}function mr(t,e,n){let r=t;for(;e-- >Pn;)r*=r,r%=n;return r}function ey(t,e){if(t===Pn)throw new Error("invert: expected non-zero number");if(e<=Pn)throw new Error("invert: expected positive modulus, got "+e);let n=zn(t,e),r=e,s=Pn,i=wn;for(;n!==Pn;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==wn)throw new Error("invert: does not exist");return zn(s,e)}function vp(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function oC(t,e){const n=(t.ORDER+wn)/nC,r=t.pow(e,n);return vp(t,r,e),r}function l8(t,e){const n=(t.ORDER-rC)/sC,r=t.mul(e,xi),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,xi),s),a=t.mul(i,t.sub(o,t.ONE));return vp(t,a,e),a}function u8(t){const e=li(t),n=aC(t),r=n(e,e.neg(e.ONE)),s=n(e,r),i=n(e,e.neg(r)),o=(t+a8)/iC;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,r);const d=a.mul(l,s),h=a.mul(l,i),p=a.eql(a.sqr(u),c),m=a.eql(a.sqr(d),c);l=a.cmov(l,u,p),u=a.cmov(h,d,m);const w=a.eql(a.sqr(u),c),b=a.cmov(l,u,w);return vp(a,b,c),b}}function aC(t){if(t<tC)throw new Error("sqrt is not defined for small field");let e=t-wn,n=0;for(;e%xi===Pn;)e/=xi,n++;let r=xi;const s=li(t);for(;ty(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return oC;let i=s.pow(r,e);const o=(e+wn)/xi;return function(a,c){if(a.is0(c))return c;if(ty(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let p=1,m=a.sqr(d);for(;!a.eql(m,a.ONE);)if(p++,m=a.sqr(m),p===l)throw new Error("Cannot find square root");const w=wn<<BigInt(l-p-1),b=a.pow(u,w);l=p,u=a.sqr(b),d=a.mul(d,u),h=a.mul(h,b)}return h}}function d8(t){return t%nC===tC?oC:t%sC===rC?l8:t%iC===c8?u8(t):aC(t)}const h8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function f8(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=h8.reduce((r,s)=>(r[s]="function",r),e);return Hu(t,n),t}function p8(t,e,n){if(n<Pn)throw new Error("invalid exponent, negatives unsupported");if(n===Pn)return t.ONE;if(n===wn)return e;let r=t.ONE,s=e;for(;n>Pn;)n&wn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=wn;return r}function cC(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function ty(t,e){const n=(t.ORDER-wn)/xi,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function lC(t,e){e!==void 0&&vs(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function li(t,e,n=!1,r={}){if(t<=Pn)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const h=e;h.BITS&&(s=h.BITS),h.sqrt&&(i=h.sqrt),typeof h.isLE=="boolean"&&(n=h.isLE),typeof h.modFromBytes=="boolean"&&(o=h.modFromBytes),a=h.allowedLengths}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:c,nByteLength:l}=lC(t,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:t,isLE:n,BITS:c,BYTES:l,MASK:Pc(c),ZERO:Pn,ONE:wn,allowedLengths:a,create:h=>zn(h,t),isValid:h=>{if(typeof h!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof h);return Pn<=h&&h<t},is0:h=>h===Pn,isValidNot0:h=>!d.is0(h)&&d.isValid(h),isOdd:h=>(h&wn)===wn,neg:h=>zn(-h,t),eql:(h,p)=>h===p,sqr:h=>zn(h*h,t),add:(h,p)=>zn(h+p,t),sub:(h,p)=>zn(h-p,t),mul:(h,p)=>zn(h*p,t),pow:(h,p)=>p8(d,h,p),div:(h,p)=>zn(h*ey(p,t),t),sqrN:h=>h*h,addN:(h,p)=>h+p,subN:(h,p)=>h-p,mulN:(h,p)=>h*p,inv:h=>ey(h,t),sqrt:i||(h=>(u||(u=d8(t)),u(d,h))),toBytes:h=>n?Cp(h,l):bp(h,l),fromBytes:(h,p=!0)=>{if(a){if(!a.includes(h.length)||h.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+h.length);const w=new Uint8Array(l);w.set(h,n?0:w.length-h.length),h=w}if(h.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+h.length);let m=n?uu(h):Wu(h);if(o&&(m=zn(m,t)),!p&&!d.isValid(m))throw new Error("invalid field element: outside of range 0..ORDER");return m},invertBatch:h=>cC(d,h),cmov:(h,p,m)=>m?p:h});return Object.freeze(d)}function uC(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function dC(t){const e=uC(t);return e+Math.ceil(e/2)}function g8(t,e,n=!1){const r=t.length,s=uC(e),i=dC(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?uu(t):Wu(t),a=zn(o,e-wn)+wn;return n?Cp(a,s):bp(a,s)}const Wo=BigInt(0),Oi=BigInt(1);function du(t,e){const n=e.negate();return t?n:e}function qd(t,e){const n=cC(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function hC(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function zd(t,e){hC(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Pc(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function ny(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Oi);const l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function m8(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function y8(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Vd=new WeakMap,fC=new WeakMap;function Kd(t){return fC.get(t)||1}function ry(t){if(t!==Wo)throw new Error("invalid wNAF")}class w8{constructor(e,n){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>Wo;)n&Oi&&(r=r.add(s)),s=s.double(),n>>=Oi;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=zd(n,this.bits),i=[];let o=e,a=o;for(let c=0;c<r;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=zd(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:h,offsetF:p}=ny(r,a,o);r=c,u?i=i.add(du(h,n[p])):s=s.add(du(d,n[l]))}return ry(r),{p:s,f:i}}wNAFUnsafe(e,n,r,s=this.ZERO){const i=zd(e,this.bits);for(let o=0;o<i.windows&&r!==Wo;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=ny(r,o,i);if(r=a,!l){const d=n[c];s=s.add(u?d.negate():d)}}return ry(r),s}getPrecomputes(e,n,r){let s=Vd.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),Vd.set(n,s))),s}cached(e,n,r){const s=Kd(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const i=Kd(e);return i===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),n,s)}createCache(e,n){hC(n,this.bits),fC.set(e,n),Vd.delete(e)}hasCache(e){return Kd(e)!==1}}function E8(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>Wo||r>Wo;)n&Oi&&(i=i.add(s)),r&Oi&&(o=o.add(s)),s=s.double(),n>>=Oi,r>>=Oi;return{p1:i,p2:o}}function b8(t,e,n,r){m8(n,t),y8(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=eC(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Pc(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let w=0;w<i;w++){const b=r[w],R=Number(b>>BigInt(p)&l);u[R]=u[R].add(n[w])}let m=o;for(let w=u.length-1,b=o;w>0;w--)b=b.add(u[w]),m=m.add(b);if(h=h.add(m),p!==0)for(let w=0;w<c;w++)h=h.double()}return h}function sy(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return f8(e),e}else return li(t,{isLE:n})}function C8(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>Wo))throw new Error(`CURVE.${a} must be positive bigint`)}const s=sy(e.p,n.Fp,r),i=sy(e.n,n.Fn,r),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),$b("HashToScalar-");const ua=BigInt(0),fo=BigInt(1),ll=BigInt(2);function v8(t){return Hu(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function _8(t){const e=v8(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||to,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),p=a?ll**BigInt(254):ll**BigInt(447),m=a?BigInt(8)*ll**BigInt(251)-fo:BigInt(4)*ll**BigInt(445)-fo,w=p+m+fo,b=W=>zn(W,n),R=k(d);function k(W){return Cp(b(W),u)}function S(W){const D=un("u coordinate",W,u);return a&&(D[31]&=127),b(uu(D))}function O(W){return uu(s(un("scalar",W,u)))}function U(W,D){const P=V(S(D),O(W));if(P===ua)throw new Error("invalid private or public key received");return k(P)}function F(W){return U(W,R)}function q(W,D,P){const y=b(W*(D-P));return D=b(D-y),P=b(P+y),{x_2:D,x_3:P}}function V(W,D){nf("u",W,ua,n),nf("scalar",D,p,w);const P=D,y=W;let E=fo,A=ua,N=W,T=fo,x=ua;for(let H=BigInt(l-1);H>=ua;H--){const ne=P>>H&fo;x^=ne,{x_2:E,x_3:N}=q(x,E,N),{x_2:A,x_3:T}=q(x,A,T),x=ne;const Z=E+A,Q=b(Z*Z),pe=E-A,ye=b(pe*pe),Te=Q-ye,ue=N+T,Ae=N-T,qe=b(Ae*Z),st=b(ue*pe),Qe=qe+st,Tt=qe-st;N=b(Qe*Qe),T=b(y*b(Tt*Tt)),E=b(Q*ye),A=b(Te*(Q+b(h*Te)))}({x_2:E,x_3:N}=q(x,E,N)),{x_2:A,x_3:T}=q(x,A,T);const M=i(A);return b(E*M)}const L={secretKey:u,publicKey:u,seed:u},Y=(W=c(u))=>(Tr(W,L.seed),W);function G(W){const D=Y(W);return{secretKey:D,publicKey:F(D)}}return{keygen:G,getSharedSecret:(W,D)=>U(W,D),getPublicKey:W=>F(W),scalarMult:U,scalarMultBase:F,utils:{randomSecretKey:Y,randomPrivateKey:Y},GuBytes:R.slice(),lengths:L}}const A8=BigInt(1),iy=BigInt(2),S8=BigInt(3),I8=BigInt(5);BigInt(8);const pC=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),T8={p:pC,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function N8(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=pC,o=t*t%i*t%i,a=mr(o,iy,i)*o%i,c=mr(a,A8,i)*t%i,l=mr(c,I8,i)*c%i,u=mr(l,e,i)*l%i,d=mr(u,n,i)*u%i,h=mr(d,r,i)*d%i,p=mr(h,s,i)*h%i,m=mr(p,s,i)*h%i,w=mr(m,e,i)*l%i;return{pow_p_5_8:mr(w,iy,i)*t%i,b2:o}}function x8(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const O8=li(T8.p,{isLE:!0}),rf=(()=>{const t=O8.ORDER;return _8({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=N8(e);return zn(mr(n,S8,t)*r,t)},adjustScalarBytes:x8})})(),oy=(t,e)=>(t+(t>=0?e:-e)/gC)/e;function R8(t,e,n){const[[r,s],[i,o]]=e,a=oy(o*t,n),c=oy(-s*t,n);let l=t-a*r-c*i,u=-a*s-c*o;const d=l<fs,h=u<fs;d&&(l=-l),h&&(u=-u);const p=Pc(Math.ceil(eC(n)/2))+ko;if(l<fs||l>=p||u<fs||u>=p)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}function sf(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Gd(t,e){const n={};for(let r of Object.keys(e))n[r]=t[r]===void 0?e[r]:t[r];return lu(n.lowS,"lowS"),lu(n.prehash,"prehash"),n.format!==void 0&&sf(n.format),n}class k8 extends Error{constructor(e=""){super(e)}}const us={Err:k8,_tlv:{encode:(t,e)=>{const{Err:n}=us;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=cl(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?cl(s.length/2|128):"";return cl(t)+i+s+e},decode(t,e){const{Err:n}=us;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=us;if(t<fs)throw new e("integer: negative integers are not allowed");let n=cl(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=us;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Wu(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=us,s=un("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=us,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},fs=BigInt(0),ko=BigInt(1),gC=BigInt(2),ul=BigInt(3),P8=BigInt(4);function vo(t,e){const{BYTES:n}=t;let r;if(typeof e=="bigint")r=e;else{let s=un("private key",e);try{r=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof e}`)}}if(!t.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function D8(t,e={}){const n=C8("weierstrass",t,e),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o,n:a}=i;Hu(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!r.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=yC(r,s);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(W,D,P){const{x:y,y:E}=D.toAffine(),A=r.toBytes(y);if(lu(P,"isCompressed"),P){u();const N=!r.isOdd(E);return zs(mC(N),A)}else return zs(Uint8Array.of(4),A,r.toBytes(E))}function h(W){Ni(W,void 0,"Point");const{publicKey:D,publicKeyUncompressed:P}=l,y=W.length,E=W[0],A=W.subarray(1);if(y===D&&(E===2||E===3)){const N=r.fromBytes(A);if(!r.isValid(N))throw new Error("bad point: is not on curve, wrong x");const T=w(N);let x;try{x=r.sqrt(T)}catch(H){const ne=H instanceof Error?": "+H.message:"";throw new Error("bad point: is not on curve, sqrt error"+ne)}u();const M=r.isOdd(x);return(E&1)===1!==M&&(x=r.neg(x)),{x:N,y:x}}else if(y===P&&E===4){const N=r.BYTES,T=r.fromBytes(A.subarray(0,N)),x=r.fromBytes(A.subarray(N,N*2));if(!b(T,x))throw new Error("bad point: is not on curve");return{x:T,y:x}}else throw new Error(`bad point: got length ${y}, expected compressed=${D} or uncompressed=${P}`)}const p=e.toBytes||d,m=e.fromBytes||h;function w(W){const D=r.sqr(W),P=r.mul(D,W);return r.add(r.add(P,r.mul(W,i.a)),i.b)}function b(W,D){const P=r.sqr(D),y=w(W);return r.eql(P,y)}if(!b(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const R=r.mul(r.pow(i.a,ul),P8),k=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(R,k)))throw new Error("bad curve params: a or b");function S(W,D,P=!1){if(!r.isValid(D)||P&&r.is0(D))throw new Error(`bad point coordinate ${W}`);return D}function O(W){if(!(W instanceof L))throw new Error("ProjectivePoint expected")}function U(W){if(!c||!c.basises)throw new Error("no endo");return R8(W,c.basises,s.ORDER)}const F=Qm((W,D)=>{const{X:P,Y:y,Z:E}=W;if(r.eql(E,r.ONE))return{x:P,y};const A=W.is0();D==null&&(D=A?r.ONE:r.inv(E));const N=r.mul(P,D),T=r.mul(y,D),x=r.mul(E,D);if(A)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:N,y:T}}),q=Qm(W=>{if(W.is0()){if(e.allowInfinityPoint&&!r.is0(W.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:P}=W.toAffine();if(!r.isValid(D)||!r.isValid(P))throw new Error("bad point: x or y not field elements");if(!b(D,P))throw new Error("bad point: equation left != right");if(!W.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function V(W,D,P,y,E){return P=new L(r.mul(P.X,W),P.Y,P.Z),D=du(y,D),P=du(E,P),D.add(P)}class L{constructor(D,P,y){this.X=S("x",D),this.Y=S("y",P,!0),this.Z=S("z",y),Object.freeze(this)}static CURVE(){return i}static fromAffine(D){const{x:P,y}=D||{};if(!D||!r.isValid(P)||!r.isValid(y))throw new Error("invalid affine point");if(D instanceof L)throw new Error("projective point not allowed");return r.is0(P)&&r.is0(y)?L.ZERO:new L(P,y,r.ONE)}static fromBytes(D){const P=L.fromAffine(m(Ni(D,void 0,"point")));return P.assertValidity(),P}static fromHex(D){return L.fromBytes(un("pointHex",D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,P=!0){return G.createCache(this,D),P||this.multiply(ul),this}assertValidity(){q(this)}hasEvenY(){const{y:D}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(D)}equals(D){O(D);const{X:P,Y:y,Z:E}=this,{X:A,Y:N,Z:T}=D,x=r.eql(r.mul(P,T),r.mul(A,E)),M=r.eql(r.mul(y,T),r.mul(N,E));return x&&M}negate(){return new L(this.X,r.neg(this.Y),this.Z)}double(){const{a:D,b:P}=i,y=r.mul(P,ul),{X:E,Y:A,Z:N}=this;let T=r.ZERO,x=r.ZERO,M=r.ZERO,H=r.mul(E,E),ne=r.mul(A,A),Z=r.mul(N,N),Q=r.mul(E,A);return Q=r.add(Q,Q),M=r.mul(E,N),M=r.add(M,M),T=r.mul(D,M),x=r.mul(y,Z),x=r.add(T,x),T=r.sub(ne,x),x=r.add(ne,x),x=r.mul(T,x),T=r.mul(Q,T),M=r.mul(y,M),Z=r.mul(D,Z),Q=r.sub(H,Z),Q=r.mul(D,Q),Q=r.add(Q,M),M=r.add(H,H),H=r.add(M,H),H=r.add(H,Z),H=r.mul(H,Q),x=r.add(x,H),Z=r.mul(A,N),Z=r.add(Z,Z),H=r.mul(Z,Q),T=r.sub(T,H),M=r.mul(Z,ne),M=r.add(M,M),M=r.add(M,M),new L(T,x,M)}add(D){O(D);const{X:P,Y:y,Z:E}=this,{X:A,Y:N,Z:T}=D;let x=r.ZERO,M=r.ZERO,H=r.ZERO;const ne=i.a,Z=r.mul(i.b,ul);let Q=r.mul(P,A),pe=r.mul(y,N),ye=r.mul(E,T),Te=r.add(P,y),ue=r.add(A,N);Te=r.mul(Te,ue),ue=r.add(Q,pe),Te=r.sub(Te,ue),ue=r.add(P,E);let Ae=r.add(A,T);return ue=r.mul(ue,Ae),Ae=r.add(Q,ye),ue=r.sub(ue,Ae),Ae=r.add(y,E),x=r.add(N,T),Ae=r.mul(Ae,x),x=r.add(pe,ye),Ae=r.sub(Ae,x),H=r.mul(ne,ue),x=r.mul(Z,ye),H=r.add(x,H),x=r.sub(pe,H),H=r.add(pe,H),M=r.mul(x,H),pe=r.add(Q,Q),pe=r.add(pe,Q),ye=r.mul(ne,ye),ue=r.mul(Z,ue),pe=r.add(pe,ye),ye=r.sub(Q,ye),ye=r.mul(ne,ye),ue=r.add(ue,ye),Q=r.mul(pe,ue),M=r.add(M,Q),Q=r.mul(Ae,ue),x=r.mul(Te,x),x=r.sub(x,Q),Q=r.mul(Te,pe),H=r.mul(Ae,H),H=r.add(H,Q),new L(x,M,H)}subtract(D){return this.add(D.negate())}is0(){return this.equals(L.ZERO)}multiply(D){const{endo:P}=e;if(!s.isValidNot0(D))throw new Error("invalid scalar: out of range");let y,E;const A=N=>G.cached(this,N,T=>qd(L,T));if(P){const{k1neg:N,k1:T,k2neg:x,k2:M}=U(D),{p:H,f:ne}=A(T),{p:Z,f:Q}=A(M);E=ne.add(Q),y=V(P.beta,H,Z,N,x)}else{const{p:N,f:T}=A(D);y=N,E=T}return qd(L,[y,E])[0]}multiplyUnsafe(D){const{endo:P}=e,y=this;if(!s.isValid(D))throw new Error("invalid scalar: out of range");if(D===fs||y.is0())return L.ZERO;if(D===ko)return y;if(G.hasCache(this))return this.multiply(D);if(P){const{k1neg:E,k1:A,k2neg:N,k2:T}=U(D),{p1:x,p2:M}=E8(L,y,A,T);return V(P.beta,x,M,E,N)}else return G.unsafe(y,D)}multiplyAndAddUnsafe(D,P,y){const E=this.multiplyUnsafe(P).add(D.multiplyUnsafe(y));return E.is0()?void 0:E}toAffine(D){return F(this,D)}isTorsionFree(){const{isTorsionFree:D}=e;return o===ko?!0:D?D(L,this):G.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:D}=e;return o===ko?this:D?D(L,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(D=!0){return lu(D,"isCompressed"),this.assertValidity(),p(L,this,D)}toHex(D=!0){return Ro(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(D=!0){return this.toBytes(D)}_setWindowSize(D){this.precompute(D)}static normalizeZ(D){return qd(L,D)}static msm(D,P){return b8(L,s,D,P)}static fromPrivateKey(D){return L.BASE.multiply(vo(s,D))}}L.BASE=new L(i.Gx,i.Gy,r.ONE),L.ZERO=new L(r.ZERO,r.ONE,r.ZERO),L.Fp=r,L.Fn=s;const Y=s.BITS,G=new w8(L,e.endo?Math.ceil(Y/2):Y);return L.BASE.precompute(8),L}function mC(t){return Uint8Array.of(t?2:3)}function yC(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function U8(t,e={}){const{Fn:n}=t,r=e.randomBytes||to,s=Object.assign(yC(t.Fp,n),{seed:dC(n.ORDER)});function i(h){try{return!!vo(n,h)}catch{return!1}}function o(h,p){const{publicKey:m,publicKeyUncompressed:w}=s;try{const b=h.length;return p===!0&&b!==m||p===!1&&b!==w?!1:!!t.fromBytes(h)}catch{return!1}}function a(h=r(s.seed)){return g8(Ni(h,s.seed,"seed"),n.ORDER)}function c(h,p=!0){return t.BASE.multiply(vo(n,h)).toBytes(p)}function l(h){const p=a(h);return{secretKey:p,publicKey:c(p)}}function u(h){if(typeof h=="bigint")return!1;if(h instanceof t)return!0;const{secretKey:p,publicKey:m,publicKeyUncompressed:w}=s;if(n.allowedLengths||p===m)return;const b=un("key",h).length;return b===m||b===w}function d(h,p,m=!0){if(u(h)===!0)throw new Error("first arg must be private key");if(u(p)===!1)throw new Error("second arg must be public key");const w=vo(n,h);return t.fromHex(p).multiply(w).toBytes(m)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:h=>vo(n,h),precompute(h=8,p=t.BASE){return p.precompute(h,!1)}},lengths:s})}function $8(t,e,n={}){$u(e),Hu(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||to,s=n.hmac||((P,...y)=>Fu(e,P,zs(...y))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:p}=U8(t,n),m={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},w="compact";function b(P){const y=a>>ko;return P>y}function R(P,y){if(!o.isValidNot0(y))throw new Error(`invalid signature ${P}: out of range 1..Point.Fn.ORDER`);return y}function k(P,y){sf(y);const E=p.signature,A=y==="compact"?E:y==="recovered"?E+1:void 0;return Ni(P,A,`${y} signature`)}class S{constructor(y,E,A){this.r=R("r",y),this.s=R("s",E),A!=null&&(this.recovery=A),Object.freeze(this)}static fromBytes(y,E=w){k(y,E);let A;if(E==="der"){const{r:M,s:H}=us.toSig(Ni(y));return new S(M,H)}E==="recovered"&&(A=y[0],E="compact",y=y.subarray(1));const N=o.BYTES,T=y.subarray(0,N),x=y.subarray(N,N*2);return new S(o.fromBytes(T),o.fromBytes(x),A)}static fromHex(y,E){return this.fromBytes(au(y),E)}addRecoveryBit(y){return new S(this.r,this.s,y)}recoverPublicKey(y){const E=i.ORDER,{r:A,s:N,recovery:T}=this;if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");if(a*gC<E&&T>1)throw new Error("recovery id is ambiguous for h>1 curve");const x=T===2||T===3?A+a:A;if(!i.isValid(x))throw new Error("recovery id 2 or 3 invalid");const M=i.toBytes(x),H=t.fromBytes(zs(mC((T&1)===0),M)),ne=o.inv(x),Z=U(un("msgHash",y)),Q=o.create(-Z*ne),pe=o.create(N*ne),ye=t.BASE.multiplyUnsafe(Q).add(H.multiplyUnsafe(pe));if(ye.is0())throw new Error("point at infinify");return ye.assertValidity(),ye}hasHighS(){return b(this.s)}toBytes(y=w){if(sf(y),y==="der")return au(us.hexFromSig(this));const E=o.toBytes(this.r),A=o.toBytes(this.s);if(y==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return zs(Uint8Array.of(this.recovery),E,A)}return zs(E,A)}toHex(y){return Ro(this.toBytes(y))}assertValidity(){}static fromCompact(y){return S.fromBytes(un("sig",y),"compact")}static fromDER(y){return S.fromBytes(un("sig",y),"der")}normalizeS(){return this.hasHighS()?new S(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Ro(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Ro(this.toBytes("compact"))}}const O=n.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const y=Wu(P),E=P.length*8-c;return E>0?y>>BigInt(E):y},U=n.bits2int_modN||function(P){return o.create(O(P))},F=Pc(c);function q(P){return nf("num < 2^"+c,P,fs,F),o.toBytes(P)}function V(P,y){return Ni(P,void 0,"message"),y?Ni(e(P),void 0,"prehashed message"):P}function L(P,y,E){if(["recovered","canonical"].some(pe=>pe in E))throw new Error("sign() legacy options not supported");const{lowS:A,prehash:N,extraEntropy:T}=Gd(E,m);P=V(P,N);const x=U(P),M=vo(o,y),H=[q(M),q(x)];if(T!=null&&T!==!1){const pe=T===!0?r(p.secretKey):T;H.push(un("extraEntropy",pe))}const ne=zs(...H),Z=x;function Q(pe){const ye=O(pe);if(!o.isValidNot0(ye))return;const Te=o.inv(ye),ue=t.BASE.multiply(ye).toAffine(),Ae=o.create(ue.x);if(Ae===fs)return;const qe=o.create(Te*o.create(Z+Ae*M));if(qe===fs)return;let st=(ue.x===Ae?0:2)|Number(ue.y&ko),Qe=qe;return A&&b(qe)&&(Qe=o.neg(qe),st^=1),new S(Ae,Qe,st)}return{seed:ne,k2sig:Q}}function Y(P,y,E={}){P=un("message",P);const{seed:A,k2sig:N}=L(P,y,E);return o8(e.outputLen,o.BYTES,s)(A,N)}function G(P){let y;const E=typeof P=="string"||Uu(P),A=!E&&P!==null&&typeof P=="object"&&typeof P.r=="bigint"&&typeof P.s=="bigint";if(!E&&!A)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(A)y=new S(P.r,P.s);else if(E){try{y=S.fromBytes(un("sig",P),"der")}catch(N){if(!(N instanceof us.Err))throw N}if(!y)try{y=S.fromBytes(un("sig",P),"compact")}catch{return!1}}return y||!1}function W(P,y,E,A={}){const{lowS:N,prehash:T,format:x}=Gd(A,m);if(E=un("publicKey",E),y=V(un("message",y),T),"strict"in A)throw new Error("options.strict was renamed to lowS");const M=x===void 0?G(P):S.fromBytes(un("sig",P),x);if(M===!1)return!1;try{const H=t.fromBytes(E);if(N&&M.hasHighS())return!1;const{r:ne,s:Z}=M,Q=U(y),pe=o.inv(Z),ye=o.create(Q*pe),Te=o.create(ne*pe),ue=t.BASE.multiplyUnsafe(ye).add(H.multiplyUnsafe(Te));return ue.is0()?!1:o.create(ue.x)===ne}catch{return!1}}function D(P,y,E={}){const{prehash:A}=Gd(E,m);return y=V(y,A),S.fromBytes(P,"recovered").recoverPublicKey(y).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:h,lengths:p,Point:t,sign:Y,verify:W,recoverPublicKey:D,Signature:S,hash:e})}function B8(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp;let r=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=li(e.n,{BITS:t.nBitLength,allowedLengths:r,modFromBytes:t.wrapPrivateKey}),i={Fp:n,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function L8(t){const{CURVE:e,curveOpts:n}=B8(t),r={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,hash:t.hash,ecdsaOpts:r}}function M8(t,e){const n=e.Point;return Object.assign({},e,{ProjectivePoint:n,CURVE:Object.assign({},t,lC(n.Fn.ORDER,n.Fn.BITS))})}function F8(t){const{CURVE:e,curveOpts:n,hash:r,ecdsaOpts:s}=L8(t),i=D8(e,n),o=$8(i,r,s);return M8(t,o)}function of(t,e){const n=r=>F8({...t,hash:r});return{...n(e),create:n}}const wC={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},EC={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},bC={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},j8=li(wC.p),W8=li(EC.p),H8=li(bC.p),q8=of({...wC,Fp:j8,lowS:!1},Lu);of({...EC,Fp:W8,lowS:!1},YD),of({...bC,Fp:H8,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},GD);const z8=q8,CC="base10",En="base16",On="base64pad",Vs="base64url",Dc="utf8",vC=0,ws=1,Uc=2,V8=0,ay=1,$a=12,_p=32;function K8(){const t=rf.utils.randomPrivateKey(),e=rf.getPublicKey(t);return{privateKey:Dn(t,En),publicKey:Dn(e,En)}}function af(){const t=to(_p);return Dn(t,En)}function G8(t,e){const n=rf.getSharedSecret(ar(t,En),ar(e,En)),r=s8(ju,n,void 0,void 0,_p);return Dn(r,En)}function Rl(t){const e=ju(ar(t,En));return Dn(e,En)}function ir(t){const e=ju(ar(t,Dc));return Dn(e,En)}function _C(t){return ar(`${t}`,CC)}function Vi(t){return Number(Dn(t,CC))}function AC(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function SC(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function Y8(t){const e=_C(typeof t.type<"u"?t.type:vC);if(Vi(e)===ws&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?ar(t.senderPublicKey,En):void 0,r=typeof t.iv<"u"?ar(t.iv,En):to($a),s=ar(t.symKey,En),i=Jb(s,r).encrypt(ar(t.message,Dc)),o=IC({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===Vs?AC(o):o}function Z8(t){const e=ar(t.symKey,En),{sealed:n,iv:r}=gc({encoded:t.encoded,encoding:t.encoding}),s=Jb(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return Dn(s,Dc)}function J8(t,e){const n=_C(Uc),r=to($a),s=ar(t,Dc),i=IC({type:n,sealed:s,iv:r});return e===Vs?AC(i):i}function X8(t,e){const{sealed:n}=gc({encoded:t,encoding:e});return Dn(n,Dc)}function IC(t){if(Vi(t.type)===Uc)return Dn(Ua([t.type,t.sealed]),On);if(Vi(t.type)===ws){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Dn(Ua([t.type,t.senderPublicKey,t.iv,t.sealed]),On)}return Dn(Ua([t.type,t.iv,t.sealed]),On)}function gc(t){const e=(t.encoding||On)===Vs?SC(t.encoded):t.encoded,n=ar(e,On),r=n.slice(V8,ay),s=ay;if(Vi(r)===ws){const c=s+_p,l=c+$a,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(Vi(r)===Uc){const c=n.slice(s),l=to($a);return{type:r,sealed:c,iv:l}}const i=s+$a,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function Q8(t,e){const n=gc({encoded:t,encoding:e?.encoding});return TC({type:Vi(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Dn(n.senderPublicKey,En):void 0,receiverPublicKey:e?.receiverPublicKey})}function TC(t){const e=t?.type||vC;if(e===ws){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function cy(t){return t.type===ws&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function ly(t){return t.type===Uc}function e5(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return Ua([new Uint8Array([4]),e,n])}function t5(t,e){const[n,r,s]=t.split("."),i=Buffer.from(SC(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=ju(c),u=e5(e);if(!z8.verify(Ua([o,a]),l,u))throw new Error("Invalid signature");return Lh(t).payload}const n5="irn";function hu(t){return t?.relay||{protocol:n5}}function _o(t){const e=N3[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var r5=Object.defineProperty,s5=Object.defineProperties,i5=Object.getOwnPropertyDescriptors,uy=Object.getOwnPropertySymbols,o5=Object.prototype.hasOwnProperty,a5=Object.prototype.propertyIsEnumerable,dy=(t,e,n)=>e in t?r5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yd=(t,e)=>{for(var n in e||(e={}))o5.call(e,n)&&dy(t,n,e[n]);if(uy)for(var n of uy(e))a5.call(e,n)&&dy(t,n,e[n]);return t},c5=(t,e)=>s5(t,i5(e));function l5(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function hy(t){if(!t.includes("wc:")){const l=Ob(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:u5(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:l5(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function u5(t){return t.startsWith("//")?t.substring(2):t}function d5(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function fy(t){const e=new URLSearchParams,n=Yd(Yd(c5(Yd({},d5(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(n).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!==void 0&&e.append(r,String(s))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function dl(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var h5=Object.defineProperty,f5=Object.defineProperties,p5=Object.getOwnPropertyDescriptors,py=Object.getOwnPropertySymbols,g5=Object.prototype.hasOwnProperty,m5=Object.prototype.propertyIsEnumerable,gy=(t,e,n)=>e in t?h5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y5=(t,e)=>{for(var n in e||(e={}))g5.call(e,n)&&gy(t,n,e[n]);if(py)for(var n of py(e))m5.call(e,n)&&gy(t,n,e[n]);return t},w5=(t,e)=>f5(t,p5(e));function Yo(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function NC(t){const e=[];return Object.values(t).forEach(n=>{e.push(...Yo(n.accounts))}),[...new Set(e)]}function E5(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.methods)}),[...new Set(e)]}function b5(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.events)}),[...new Set(e)]}function C5(t,e){const n=[];return Object.values(t).forEach(r=>{Yo(r.accounts).includes(e)&&n.push(...r.methods)}),n}function v5(t,e){const n=[];return Object.values(t).forEach(r=>{Yo(r.accounts).includes(e)&&n.push(...r.events)}),n}function qu(t){return t.includes(":")}function Ao(t){return qu(t)?t.split(":")[0]:t}function my(t){var e,n,r;const s={};if(!zr(t))return s;for(const[i,o]of Object.entries(t)){const a=qu(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Ao(i);s[u]=w5(y5({},s[u]),{chains:qr(a,(e=s[u])==null?void 0:e.chains),methods:qr(c,(n=s[u])==null?void 0:n.methods),events:qr(l,(r=s[u])==null?void 0:r.events)})}return s}function _5(t){const e={};return t?.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function yy(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=_5(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=qr(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function A5(t,e){var n,r,s,i,o,a;const c=my(t),l=my(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:qr((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:qr((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:qr((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const S5={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},I5={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ae(t,e){const{message:n,code:r}=I5[t];return{message:e?`${n} ${e}`:n,code:r}}function gt(t,e){const{message:n,code:r}=S5[t];return{message:e?`${n} ${e}`:n,code:r}}function Es(t,e){return!!Array.isArray(t)}function zr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Ht(t){return typeof t>"u"}function Pt(t,e){return e&&Ht(t)?!0:typeof t=="string"&&!!t.trim().length}function Ap(t,e){return typeof t=="number"&&!isNaN(t)}function T5(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return Ti(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=Yo(a),d=n[o];(!Ti(Sb(o,d),u)||!Ti(d.methods,c)||!Ti(d.events,l))&&(i=!1)}),i):!1}function fu(t){return Pt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function N5(t){if(Pt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&fu(n)}}return!1}function x5(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(Pt(t,!1)){if(e(t))return!0;const n=Ob(t);return e(n)}}catch{}return!1}function O5(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function R5(t){return t?.topic}function k5(t,e){let n=null;return Pt(t?.publicKey,!1)||(n=ae("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function wy(t){let e=!0;return Es(t)?t.length&&(e=t.every(n=>Pt(n,!1))):e=!1,e}function P5(t,e,n){let r=null;return Es(e)&&e.length?e.forEach(s=>{r||fu(s)||(r=gt("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):fu(t)||(r=gt("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function D5(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=P5(s,Sb(s,i),`${e} ${n}`);o&&(r=o)}),r}function U5(t,e){let n=null;return Es(t)?t.forEach(r=>{n||N5(r)||(n=gt("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=gt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function $5(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=U5(r?.accounts,`${e} namespace`);s&&(n=s)}),n}function B5(t,e){let n=null;return wy(t?.methods)?wy(t?.events)||(n=gt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=gt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function xC(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=B5(r,`${e}, namespace`);s&&(n=s)}),n}function L5(t,e,n){let r=null;if(t&&zr(t)){const s=xC(t,e);s&&(r=s);const i=D5(t,e,n);i&&(r=i)}else r=ae("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function Zd(t,e){let n=null;if(t&&zr(t)){const r=xC(t,e);r&&(n=r);const s=$5(t,e);s&&(n=s)}else n=ae("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function OC(t){return Pt(t.protocol,!0)}function M5(t,e){let n=!1;return t?t&&Es(t)&&t.length&&t.forEach(r=>{n=OC(r)}):n=!0,n}function F5(t){return typeof t=="number"}function In(t){return typeof t<"u"&&typeof t!==null}function j5(t){return!(!t||typeof t!="object"||!t.code||!Ap(t.code)||!t.message||!Pt(t.message,!1))}function W5(t){return!(Ht(t)||!Pt(t.method,!1))}function H5(t){return!(Ht(t)||Ht(t.result)&&Ht(t.error)||!Ap(t.id)||!Pt(t.jsonrpc,!1))}function q5(t){return!(Ht(t)||!Pt(t.name,!1))}function Ey(t,e){return!(!fu(e)||!NC(t).includes(e))}function z5(t,e,n){return Pt(n,!1)?C5(t,e).includes(n):!1}function V5(t,e,n){return Pt(n,!1)?v5(t,e).includes(n):!1}function by(t,e,n){let r=null;const s=K5(t),i=G5(e),o=Object.keys(s),a=Object.keys(i),c=Cy(Object.keys(t)),l=Cy(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=ae("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Ti(o,a)||(r=ae("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const h=Yo(e[d].accounts);h.includes(d)||(r=ae("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(Ti(s[d].methods,i[d].methods)?Ti(s[d].events,i[d].events)||(r=ae("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=ae("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function K5(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function Cy(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function G5(t){const e={};return Object.keys(t).forEach(n=>{n.includes(":")?e[n]=t[n]:Yo(t[n].accounts)?.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}),e}function Y5(t,e){return Ap(t)&&t<=e.max&&t>=e.min}function vy(){const t=Rc();return new Promise(e=>{switch(t){case Yn.browser:e(Z5());break;case Yn.reactNative:e(J5());break;case Yn.node:e(X5());break;default:e(!0)}})}function Z5(){return Go()&&navigator?.onLine}async function J5(){return ci()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo?(await globalThis?.NetInfo.fetch())?.isConnected:!0}function X5(){return!0}function Q5(t){switch(Rc()){case Yn.browser:e$(t);break;case Yn.reactNative:t$(t);break}}function e$(t){!ci()&&Go()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function t$(t){ci()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo&&globalThis?.NetInfo.addEventListener(e=>t(e?.isConnected))}function n$(){var t;return Go()&&Hi()?((t=Hi())==null?void 0:t.visibilityState)==="visible":!0}const Jd={};class da{static get(e){return Jd[e]}static set(e,n){Jd[e]=n}static delete(e){delete Jd[e]}}function r$(t){const e=xc.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function s$({publicKey:t,signature:e,payload:n}){var r;const s=cf(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=a$(n.address),a=n.era==="00"?new Uint8Array([0]):cf(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${o$(n.tip)}`),d=l$(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),p=c$(h.length+1);return new Uint8Array([...p,i,...h])}function i$(t){const e=cf(t),n=F3.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function cf(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function o$(t){return t.startsWith("0x")?t.slice(2):t}function a$(t){const e=xc.decode(t)[0];return e===42?0:e===60?2:1}function c$(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function l$(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function u$(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=r$(t.transaction.address),r=s$({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return i$(s)}function Sp({logger:t,name:e}){const n=typeof t=="string"?Au({opts:{level:t,name:e}}).logger:t;return n.level=typeof t=="string"?t:t.level,n}const d$="PARSE_ERROR",h$="INVALID_REQUEST",f$="METHOD_NOT_FOUND",p$="INVALID_PARAMS",RC="INTERNAL_ERROR",Ip="SERVER_ERROR",g$=[-32700,-32600,-32601,-32602,-32603],Ba={[d$]:{code:-32700,message:"Parse error"},[h$]:{code:-32600,message:"Invalid Request"},[f$]:{code:-32601,message:"Method not found"},[p$]:{code:-32602,message:"Invalid params"},[RC]:{code:-32603,message:"Internal error"},[Ip]:{code:-32e3,message:"Server error"}},kC=Ip;function m$(t){return g$.includes(t)}function _y(t){return Object.keys(Ba).includes(t)?Ba[t]:Ba[kC]}function y$(t){const e=Object.values(Ba).find(n=>n.code===t);return e||Ba[kC]}function PC(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var DC={};var lf=function(t,e){return lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},lf(t,e)};function w$(t,e){lf(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var uf=function(){return uf=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},uf.apply(this,arguments)};function E$(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function b$(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function C$(t,e){return function(n,r){e(n,r,t)}}function v$(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function _$(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function A$(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function S$(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function I$(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function df(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function UC(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function T$(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(UC(arguments[e]));return t}function N$(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function mc(t){return this instanceof mc?(this.v=t,this):new mc(t)}function x$(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(p){return new Promise(function(m,w){i.push([h,p,m,w])>1||a(h,p)})})}function a(h,p){try{c(r[h](p))}catch(m){d(i[0][3],m)}}function c(h){h.value instanceof mc?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function O$(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:mc(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function R$(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof df=="function"?df(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function k$(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function P$(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function D$(t){return t&&t.__esModule?t:{default:t}}function U$(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function $$(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const B$=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return uf},__asyncDelegator:O$,__asyncGenerator:x$,__asyncValues:R$,__await:mc,__awaiter:_$,__classPrivateFieldGet:U$,__classPrivateFieldSet:$$,__createBinding:S$,__decorate:b$,__exportStar:I$,__extends:w$,__generator:A$,__importDefault:D$,__importStar:P$,__makeTemplateObject:k$,__metadata:v$,__param:C$,__read:UC,__rest:E$,__spread:T$,__spreadArrays:N$,__values:df},Symbol.toStringTag,{value:"Module"})),L$=Jw(B$);var ns={},Ay;function M$(){if(Ay)return ns;Ay=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.isBrowserCryptoAvailable=ns.getSubtleCrypto=ns.getBrowerCrypto=void 0;function t(){return globalThis?.crypto||globalThis?.msCrypto||{}}ns.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}ns.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return ns.isBrowserCryptoAvailable=n,ns}var rs={},Sy;function F$(){if(Sy)return rs;Sy=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.isBrowser=rs.isNode=rs.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}rs.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}rs.isNode=e;function n(){return!t()&&!e()}return rs.isBrowser=n,rs}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=L$;e.__exportStar(M$(),t),e.__exportStar(F$(),t)})(DC);function Ur(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function Js(t=6){return BigInt(Ur(t))}function Er(t,e,n){return{id:n||Ur(),jsonrpc:"2.0",method:t,params:e}}function yc(t,e){return{id:t,jsonrpc:"2.0",result:e}}function zu(t,e,n){return{id:t,jsonrpc:"2.0",error:j$(e)}}function j$(t,e){return typeof t>"u"?_y(RC):(typeof t=="string"&&(t=Object.assign(Object.assign({},_y(Ip)),{message:t})),m$(t.code)&&(t=y$(t.code)),t)}let W$=class{},H$=class extends W${constructor(){super()}},q$=class extends H${constructor(e){super()}};const z$="^https?:",V$="^wss?:";function K$(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function $C(t,e){const n=K$(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function Iy(t){return $C(t,z$)}function Ty(t){return $C(t,V$)}function G$(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function BC(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Tp(t){return BC(t)&&"method"in t}function Vu(t){return BC(t)&&($r(t)||or(t))}function $r(t){return"result"in t}function or(t){return"error"in t}let Np=class extends q${constructor(e){super(e),this.events=new lr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(Er(e.method,e.params||[],e.id||Js().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{or(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Vu(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};var Xd,Ny;function Y$(){return Ny||(Ny=1,Xd=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}),Xd}const Z$=()=>typeof WebSocket<"u"?WebSocket:typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:Y$(),J$=()=>typeof WebSocket<"u"||typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",xy=t=>t.split("?")[0],Oy=10,X$=Z$();let Q$=class{constructor(e){if(this.url=e,this.events=new lr.EventEmitter,this.registering=!1,!Ty(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Wi(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Ty(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=DC.isReactNative()?void 0:{rejectUnauthorized:!G$(e)},i=new X$(e,[],s);J$()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?ji(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=zu(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return PC(e,xy(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Oy&&this.events.setMaxListeners(Oy)}emitError(e){const n=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${xy(this.url)}`));return this.events.emit("register_error",n),n}};var e4={};const LC="wc",MC=2,hf="core",Gr=`${LC}@2:${hf}:`,t4={logger:"error"},n4={database:":memory:"},r4="crypto",Ry="client_ed25519_seed",s4=oe.ONE_DAY,i4="keychain",o4="0.3",a4="messages",c4="0.3",l4=oe.SIX_HOURS,u4="publisher",FC="irn",d4="error",jC="wss://relay.walletconnect.org",h4="relayer",kt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},f4="_subscription",Xn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},p4=.1,ff="2.23.2",dt={link_mode:"link_mode",relay:"relay"},kl={inbound:"inbound",outbound:"outbound"},g4="0.3",m4="WALLETCONNECT_CLIENT_ID",ky="WALLETCONNECT_LINK_MODE_APPS",Hn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},y4="subscription",w4="0.3",E4="pairing",b4="0.3",ha={wc_pairingDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:0},res:{ttl:oe.ONE_DAY,prompt:!1,tag:0}}},_i={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},C4="history",v4="0.3",_4="expirer",nr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},A4="0.3",S4="verify-api",I4="https://verify.walletconnect.com",WC="https://verify.walletconnect.org",La=WC,T4=`${La}/v3`,N4=[I4,WC],x4="echo",O4="https://echo.walletconnect.com",Dr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},is={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},fr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},pi={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},gi={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},fa={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},R4=.1,k4="event-client",P4=86400,D4="https://pulse.walletconnect.org/batch";function U4(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var w=0,b=0,R=0,k=m.length;R!==k&&m[R]===0;)R++,w++;for(var S=(k-R)*u+1>>>0,O=new Uint8Array(S);R!==k;){for(var U=m[R],F=0,q=S-1;(U!==0||F<b)&&q!==-1;q--,F++)U+=256*O[q]>>>0,O[q]=U%a>>>0,U=U/a>>>0;if(U!==0)throw new Error("Non-zero carry");b=F,R++}for(var V=S-b;V!==S&&O[V]===0;)V++;for(var L=c.repeat(w);V<S;++V)L+=t.charAt(O[V]);return L}function h(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var w=0;if(m[w]!==" "){for(var b=0,R=0;m[w]===c;)b++,w++;for(var k=(m.length-w)*l+1>>>0,S=new Uint8Array(k);m[w];){var O=n[m.charCodeAt(w)];if(O===255)return;for(var U=0,F=k-1;(O!==0||U<R)&&F!==-1;F--,U++)O+=a*S[F]>>>0,S[F]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");R=U,w++}if(m[w]!==" "){for(var q=k-R;q!==k&&S[q]===0;)q++;for(var V=new Uint8Array(b+(k-q)),L=b;q!==k;)V[L++]=S[q++];return V}}}function p(m){var w=h(m);if(w)return w;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var $4=U4,B4=$4;const HC=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},L4=t=>new TextEncoder().encode(t),M4=t=>new TextDecoder().decode(t);class F4{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class j4{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return qC(this,e)}}class W4{constructor(e){this.decoders=e}or(e){return qC(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const qC=(t,e)=>new W4({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class H4{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new F4(e,n,r),this.decoder=new j4(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ku=({name:t,prefix:e,encode:n,decode:r})=>new H4(t,e,n,r),$c=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=B4(n,e);return Ku({prefix:t,name:e,encode:r,decode:i=>HC(s(i))})},q4=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},z4=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},tn=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Ku({prefix:e,name:t,encode(s){return z4(s,r,n)},decode(s){return q4(s,r,n,t)}}),V4=Ku({prefix:"\0",name:"identity",encode:t=>M4(t),decode:t=>L4(t)});var K4=Object.freeze({__proto__:null,identity:V4});const G4=tn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Y4=Object.freeze({__proto__:null,base2:G4});const Z4=tn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var J4=Object.freeze({__proto__:null,base8:Z4});const X4=$c({prefix:"9",name:"base10",alphabet:"0123456789"});var Q4=Object.freeze({__proto__:null,base10:X4});const e6=tn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),t6=tn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var n6=Object.freeze({__proto__:null,base16:e6,base16upper:t6});const r6=tn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),s6=tn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),i6=tn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),o6=tn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),a6=tn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),c6=tn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l6=tn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u6=tn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d6=tn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var h6=Object.freeze({__proto__:null,base32:r6,base32upper:s6,base32pad:i6,base32padupper:o6,base32hex:a6,base32hexupper:c6,base32hexpad:l6,base32hexpadupper:u6,base32z:d6});const f6=$c({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),p6=$c({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var g6=Object.freeze({__proto__:null,base36:f6,base36upper:p6});const m6=$c({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),y6=$c({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var w6=Object.freeze({__proto__:null,base58btc:m6,base58flickr:y6});const E6=tn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),b6=tn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),C6=tn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v6=tn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var _6=Object.freeze({__proto__:null,base64:E6,base64pad:b6,base64url:C6,base64urlpad:v6});const zC=Array.from(""),A6=zC.reduce((t,e,n)=>(t[n]=e,t),[]),S6=zC.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function I6(t){return t.reduce((e,n)=>(e+=A6[n],e),"")}function T6(t){const e=[];for(const n of t){const r=S6[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const N6=Ku({prefix:"",name:"base256emoji",encode:I6,decode:T6});var x6=Object.freeze({__proto__:null,base256emoji:N6}),O6=VC,Py=128,R6=-128,k6=Math.pow(2,31);function VC(t,e,n){e=e||[],n=n||0;for(var r=n;t>=k6;)e[n++]=t&255|Py,t/=128;for(;t&R6;)e[n++]=t&255|Py,t>>>=7;return e[n]=t|0,VC.bytes=n-r+1,e}var P6=pf,D6=128,Dy=127;function pf(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw pf.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Dy)<<s:(o&Dy)*Math.pow(2,s),s+=7}while(o>=D6);return pf.bytes=i-r,n}var U6=Math.pow(2,7),$6=Math.pow(2,14),B6=Math.pow(2,21),L6=Math.pow(2,28),M6=Math.pow(2,35),F6=Math.pow(2,42),j6=Math.pow(2,49),W6=Math.pow(2,56),H6=Math.pow(2,63),q6=function(t){return t<U6?1:t<$6?2:t<B6?3:t<L6?4:t<M6?5:t<F6?6:t<j6?7:t<W6?8:t<H6?9:10},z6={encode:O6,decode:P6,encodingLength:q6},KC=z6;const Uy=(t,e,n=0)=>(KC.encode(t,e,n),e),$y=t=>KC.encodingLength(t),gf=(t,e)=>{const n=e.byteLength,r=$y(t),s=r+$y(n),i=new Uint8Array(s+n);return Uy(t,i,0),Uy(n,i,r),i.set(e,s),new V6(t,n,e,i)};class V6{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const GC=({name:t,code:e,encode:n})=>new K6(t,e,n);class K6{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?gf(this.code,n):n.then(r=>gf(this.code,r))}else throw Error("Unknown type, must be binary type")}}const YC=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),G6=GC({name:"sha2-256",code:18,encode:YC("SHA-256")}),Y6=GC({name:"sha2-512",code:19,encode:YC("SHA-512")});var Z6=Object.freeze({__proto__:null,sha256:G6,sha512:Y6});const ZC=0,J6="identity",JC=HC,X6=t=>gf(ZC,JC(t)),Q6={code:ZC,name:J6,encode:JC,digest:X6};var eB=Object.freeze({__proto__:null,identity:Q6});new TextEncoder,new TextDecoder;const By={...K4,...Y4,...J4,...Q4,...n6,...h6,...g6,...w6,..._6,...x6};({...Z6,...eB});function XC(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function tB(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?XC(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function QC(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Ly=QC("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Qd=QC("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=tB(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),nB={utf8:Ly,"utf-8":Ly,hex:By.base16,latin1:Qd,ascii:Qd,binary:Qd,...By};function rB(t,e="utf8"){const n=nB[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?XC(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var sB=Object.defineProperty,iB=(t,e,n)=>e in t?sB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kr=(t,e,n)=>iB(t,typeof e!="symbol"?e+"":e,n);class oB{constructor(e,n){this.core=e,this.logger=n,kr(this,"keychain",new Map),kr(this,"name",i4),kr(this,"version",o4),kr(this,"initialized",!1),kr(this,"storagePrefix",Gr),kr(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),kr(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),kr(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),kr(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=ae("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),kr(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Bn(n,this.name)}get context(){return $n(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Gh(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Yh(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}var aB=Object.defineProperty,cB=(t,e,n)=>e in t?aB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mt=(t,e,n)=>cB(t,typeof e!="symbol"?e+"":e,n);class lB{constructor(e,n,r){this.core=e,this.logger=n,Mt(this,"name",r4),Mt(this,"keychain"),Mt(this,"randomSessionIdentifier",af()),Mt(this,"initialized",!1),Mt(this,"clientId"),Mt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Mt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Mt(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=Xg(s),o=mE(i.publicKey);return this.clientId=o,o}),Mt(this,"generateKeyPair",()=>{this.isInitialized();const s=K8();return this.setPrivateKey(s.publicKey,s.privateKey)}),Mt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=Xg(i),a=this.randomSessionIdentifier;return await mO(a,s,s4,o)}),Mt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=G8(a,i);return this.setSymKey(c,o)}),Mt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Rl(s);return await this.keychain.set(o,s),o}),Mt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Mt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Mt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=TC(o),c=Wi(i);if(ly(a))return J8(c,o?.encoding);if(cy(a)){const h=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(h,p)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return Y8({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Mt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=Q8(i,o);if(ly(a)){const c=X8(i,o?.encoding);return ji(c)}if(cy(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=Z8({symKey:c,encoded:i,encoding:o?.encoding});return ji(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Mt(this,"getPayloadType",(s,i=On)=>{const o=gc({encoded:s,encoding:i});return Vi(o.type)}),Mt(this,"getPayloadSenderPublicKey",(s,i=On)=>{const o=gc({encoded:s,encoding:i});return o.senderPublicKey?Dn(o.senderPublicKey,En):void 0}),this.core=e,this.logger=Bn(n,this.name),this.keychain=r||new oB(this.core,this.logger)}get context(){return $n(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ry)}catch{e=af(),await this.keychain.set(Ry,e)}return rB(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}var uB=Object.defineProperty,dB=Object.defineProperties,hB=Object.getOwnPropertyDescriptors,My=Object.getOwnPropertySymbols,fB=Object.prototype.hasOwnProperty,pB=Object.prototype.propertyIsEnumerable,mf=(t,e,n)=>e in t?uB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gB=(t,e)=>{for(var n in e||(e={}))fB.call(e,n)&&mf(t,n,e[n]);if(My)for(var n of My(e))pB.call(e,n)&&mf(t,n,e[n]);return t},mB=(t,e)=>dB(t,hB(e)),jn=(t,e,n)=>mf(t,typeof e!="symbol"?e+"":e,n);class yB extends pN{constructor(e,n){super(e,n),this.logger=e,this.core=n,jn(this,"messages",new Map),jn(this,"messagesWithoutClientAck",new Map),jn(this,"name",a4),jn(this,"version",c4),jn(this,"initialized",!1),jn(this,"storagePrefix",Gr),jn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),jn(this,"set",async(r,s,i)=>{this.isInitialized();const o=ir(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===kl.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,mB(gB({},c),{[o]:s}))}return await this.persist(),o}),jn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),jn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),jn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=ir(s);return typeof i[o]<"u"}),jn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=ir(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),jn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Bn(e,this.name),this.core=n}get context(){return $n(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Gh(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Gh(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Yh(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Yh(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}var wB=Object.defineProperty,EB=Object.defineProperties,bB=Object.getOwnPropertyDescriptors,Fy=Object.getOwnPropertySymbols,CB=Object.prototype.hasOwnProperty,vB=Object.prototype.propertyIsEnumerable,yf=(t,e,n)=>e in t?wB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,po=(t,e)=>{for(var n in e||(e={}))CB.call(e,n)&&yf(t,n,e[n]);if(Fy)for(var n of Fy(e))vB.call(e,n)&&yf(t,n,e[n]);return t},jy=(t,e)=>EB(t,bB(e)),Qn=(t,e,n)=>yf(t,typeof e!="symbol"?e+"":e,n);class _B extends gN{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Qn(this,"events",new lr.EventEmitter),Qn(this,"name",u4),Qn(this,"queue",new Map),Qn(this,"publishTimeout",oe.toMiliseconds(oe.ONE_MINUTE)),Qn(this,"initialPublishTimeout",oe.toMiliseconds(oe.ONE_SECOND*15)),Qn(this,"needsTransportRestart",!1),Qn(this,"publish",async(r,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const d=i?.ttl||l4,h=i?.prompt||!1,p=i?.tag||0,m=i?.id||Js().toString(),w=_o(hu().protocol),b={id:m,method:i?.publishMethod||w.publish,params:po({topic:r,message:s,ttl:d,prompt:h,tag:p,attestation:i?.attestation},i?.tvf)},R=`Failed to publish payload, please try again. id:${m} tag:${p}`;try{Ht((o=b.params)==null?void 0:o.prompt)&&((a=b.params)==null||delete a.prompt),Ht((c=b.params)==null?void 0:c.tag)&&((l=b.params)==null||delete l.tag);const k=new Promise(async S=>{const O=({id:F})=>{var q;((q=b.id)==null?void 0:q.toString())===F.toString()&&(this.removeRequestFromQueue(F),this.relayer.events.removeListener(kt.publish,O),S())};this.relayer.events.on(kt.publish,O);const U=jr(new Promise((F,q)=>{this.rpcPublish(b,i).then(F).catch(V=>{this.logger.warn(V,V?.message),q(V)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${m} tag:${p}`);try{await U,this.events.removeListener(kt.publish,O)}catch(F){this.queue.set(m,{request:b,opts:i,attempt:1}),this.logger.warn(F,F?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:m,topic:r,message:s,opts:i}}),await jr(k,this.publishTimeout,R)}catch(k){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(k),(u=i?.internal)!=null&&u.throwOnFailedPublish)throw k}finally{this.queue.delete(m)}}),Qn(this,"publishCustom",async r=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:l,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:p,prompt:m,tag:w,ttl:b=oe.FIVE_MINUTES}=u,R=u.id||Js().toString(),k=_o(hu().protocol),S=p||k.publish,O={id:R,method:S,params:po(jy(po({},l),{ttl:b,prompt:m,tag:w,attestation:d}),h)},U=`Failed to publish custom payload, please try again. id:${R} tag:${w}`;try{Ht((s=O.params)==null?void 0:s.prompt)&&((i=O.params)==null||delete i.prompt),Ht((o=O.params)==null?void 0:o.tag)&&((a=O.params)==null||delete a.tag);const F=new Promise(async q=>{const V=({id:Y})=>{var G;((G=O.id)==null?void 0:G.toString())===Y.toString()&&(this.removeRequestFromQueue(Y),this.relayer.events.removeListener(kt.publish,V),q())};this.relayer.events.on(kt.publish,V);const L=jr(new Promise((Y,G)=>{this.rpcPublish(O,u).then(Y).catch(W=>{this.logger.warn(W,W?.message),G(W)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${S} id:${R} tag:${w}`);try{await L,this.events.removeListener(kt.publish,V)}catch(Y){this.queue.set(R,{request:O,opts:u,attempt:1}),this.logger.warn(Y,Y?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:R,payload:l,opts:u}}),await jr(F,this.publishTimeout,U)}catch(F){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(F),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw F}finally{this.queue.delete(R)}}),Qn(this,"on",(r,s)=>{this.events.on(r,s)}),Qn(this,"once",(r,s)=>{this.events.once(r,s)}),Qn(this,"off",(r,s)=>{this.events.off(r,s)}),Qn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=Bn(n,this.name),this.registerEventListeners()}get context(){return $n(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(kt.publish,po(po({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,jy(po({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Xi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(kt.connection_stalled);return}this.checkQueue()}),this.relayer.on(kt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var AB=Object.defineProperty,SB=(t,e,n)=>e in t?AB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,go=(t,e,n)=>SB(t,typeof e!="symbol"?e+"":e,n);class IB{constructor(){go(this,"map",new Map),go(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),go(this,"get",e=>this.map.get(e)||[]),go(this,"exists",(e,n)=>this.get(e).includes(n)),go(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),go(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var TB=Object.defineProperty,NB=Object.defineProperties,xB=Object.getOwnPropertyDescriptors,Wy=Object.getOwnPropertySymbols,OB=Object.prototype.hasOwnProperty,RB=Object.prototype.propertyIsEnumerable,wf=(t,e,n)=>e in t?TB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pa=(t,e)=>{for(var n in e||(e={}))OB.call(e,n)&&wf(t,n,e[n]);if(Wy)for(var n of Wy(e))RB.call(e,n)&&wf(t,n,e[n]);return t},eh=(t,e)=>NB(t,xB(e)),ct=(t,e,n)=>wf(t,typeof e!="symbol"?e+"":e,n);class kB extends wN{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,ct(this,"subscriptions",new Map),ct(this,"topicMap",new IB),ct(this,"events",new lr.EventEmitter),ct(this,"name",y4),ct(this,"version",w4),ct(this,"pending",new Map),ct(this,"cached",[]),ct(this,"initialized",!1),ct(this,"storagePrefix",Gr),ct(this,"subscribeTimeout",oe.toMiliseconds(oe.ONE_MINUTE)),ct(this,"initialSubscribeTimeout",oe.toMiliseconds(oe.ONE_SECOND*15)),ct(this,"clientId"),ct(this,"batchSubscribeTopicsLimit",500),ct(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ct(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=hu(s),a={topic:r,relay:o,transportType:s?.transportType};(i=s?.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),ct(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),ct(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),ct(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),ct(this,"on",(r,s)=>{this.events.on(r,s)}),ct(this,"once",(r,s)=>{this.events.once(r,s)}),ct(this,"off",(r,s)=>{this.events.off(r,s)}),ct(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),ct(this,"start",async()=>{await this.onConnect()}),ct(this,"stop",async()=>{await this.onDisconnect()}),ct(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ct(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),ct(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Xi.pulse,async()=>{await this.checkPending()}),this.events.on(Hn.created,async r=>{const s=Hn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Hn.deleted,async r=>{const s=Hn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=Bn(n,this.name),this.clientId=""}get context(){return $n(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=hu(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=gt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r?.internal)!=null&&s.skipSubscribe)return o;(!r||r?.transportType===dt.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const a={method:_o(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=r?.internal)==null?void 0:i.throwOnFailedPublish;try{if(r?.transportType===dt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},oe.toMiliseconds(oe.ONE_SECOND)),o;const l=new Promise(async d=>{const h=p=>{p.topic===e&&(this.events.removeListener(Hn.created,h),d(p.id))};this.events.on(Hn.created,h);try{const p=await jr(new Promise((m,w)=>{this.relayer.request(a).catch(b=>{this.logger.warn(b,b?.message),w(b)}).then(m)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Hn.created,h),d(p)}catch{}}),u=await jr(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(kt.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:_o(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await jr(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(kt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:_o(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await jr(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(kt.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:_o(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,eh(pa({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,pa({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,pa({},n)),this.topicMap.set(n.topic,e),this.events.emit(Hn.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Hn.deleted,eh(pa({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Hn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Hn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>eh(pa({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await fD(oe.toMiliseconds(oe.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return ir(e+await this.getClientId())}}var PB=Object.defineProperty,Hy=Object.getOwnPropertySymbols,DB=Object.prototype.hasOwnProperty,UB=Object.prototype.propertyIsEnumerable,Ef=(t,e,n)=>e in t?PB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qy=(t,e)=>{for(var n in e||(e={}))DB.call(e,n)&&Ef(t,n,e[n]);if(Hy)for(var n of Hy(e))UB.call(e,n)&&Ef(t,n,e[n]);return t},Ye=(t,e,n)=>Ef(t,typeof e!="symbol"?e+"":e,n);class $B extends mN{constructor(e){var n;super(e),Ye(this,"protocol","wc"),Ye(this,"version",2),Ye(this,"core"),Ye(this,"logger"),Ye(this,"events",new lr.EventEmitter),Ye(this,"provider"),Ye(this,"messages"),Ye(this,"subscriber"),Ye(this,"publisher"),Ye(this,"name",h4),Ye(this,"transportExplicitlyClosed",!1),Ye(this,"initialized",!1),Ye(this,"connectionAttemptInProgress",!1),Ye(this,"relayUrl"),Ye(this,"projectId"),Ye(this,"packageName"),Ye(this,"bundleId"),Ye(this,"hasExperiencedNetworkDisruption",!1),Ye(this,"pingTimeout"),Ye(this,"heartBeatTimeout",oe.toMiliseconds(oe.THIRTY_SECONDS+oe.FIVE_SECONDS)),Ye(this,"reconnectTimeout"),Ye(this,"connectPromise"),Ye(this,"reconnectInProgress",!1),Ye(this,"requestsInFlight",[]),Ye(this,"connectTimeout",oe.toMiliseconds(oe.ONE_SECOND*15)),Ye(this,"request",async r=>{var s,i;this.logger.debug("Publishing Request Payload");const o=r.id||Js().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(s=r.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),Ye(this,"resetPingTimeout",()=>{ou()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),Ye(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),Ye(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(kt.connect)}),Ye(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Ye(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(kt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Ye(this,"registerProviderListeners",()=>{this.provider.on(Xn.payload,this.onPayloadHandler),this.provider.on(Xn.connect,this.onConnectHandler),this.provider.on(Xn.disconnect,this.onDisconnectHandler),this.provider.on(Xn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=Sp({logger:(n=e.logger)!=null?n:d4,name:this.name}),this.messages=new yB(this.logger,e.core),this.subscriber=new kB(this,this.logger),this.publisher=new _B(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||jC,J3()?this.packageName=Om():X3()&&(this.bundleId=Om()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return $n(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:dt.relay},kl.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Hn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Hn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,qy({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await jr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await vy())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=Rt(oe.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(kt.message,e),await this.recordMessageEvent(e,kl.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Xn.disconnect,i),await jr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Xn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Xn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Xn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,oe.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(ou())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Np(new Q$(rD({sdkVersion:ff,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Tp(e)){if(!e.method.endsWith(f4))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:dt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(qy({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Vu(e)&&this.events.emit(kt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,kl.inbound),this.events.emit(kt.message,e))}async acknowledgePayload(e){const n=yc(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(Xn.payload,this.onPayloadHandler),this.provider.off(Xn.connect,this.onConnectHandler),this.provider.off(Xn.disconnect,this.onDisconnectHandler),this.provider.off(Xn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await vy();Q5(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Xi.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&n$())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(kt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},oe.toMiliseconds(p4)))))}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function BB(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function zy(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Vy(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const LB="[object RegExp]",MB="[object String]",FB="[object Number]",jB="[object Boolean]",Ky="[object Arguments]",WB="[object Symbol]",HB="[object Date]",qB="[object Map]",zB="[object Set]",VB="[object Array]",KB="[object Function]",GB="[object ArrayBuffer]",th="[object Object]",YB="[object Error]",ZB="[object DataView]",JB="[object Uint8Array]",XB="[object Uint8ClampedArray]",QB="[object Uint16Array]",eL="[object Uint32Array]",tL="[object BigUint64Array]",nL="[object Int8Array]",rL="[object Int16Array]",sL="[object Int32Array]",iL="[object BigInt64Array]",oL="[object Float32Array]",aL="[object Float64Array]";function cL(){}function Gy(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function lL(t,e,n){return xa(t,e,void 0,void 0,void 0,void 0,n)}function xa(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Ma(t,e,i,o)}return Ma(t,e,i,o)}function Ma(t,e,n,r){if(Object.is(t,e))return!0;let s=Vy(t),i=Vy(e);if(s===Ky&&(s=th),i===Ky&&(i=th),s!==i)return!1;switch(s){case MB:return t.toString()===e.toString();case FB:{const c=t.valueOf(),l=e.valueOf();return BB(c,l)}case jB:case HB:case WB:return Object.is(t.valueOf(),e.valueOf());case LB:return t.source===e.source&&t.flags===e.flags;case KB:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case qB:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!xa(l,e.get(c),c,t,e,n,r))return!1;return!0}case zB:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(p=>xa(d,p,void 0,t,e,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case VB:case JB:case XB:case QB:case eL:case tL:case nL:case rL:case sL:case iL:case oL:case aL:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!xa(t[c],e[c],c,t,e,n,r))return!1;return!0}case GB:return t.byteLength!==e.byteLength?!1:Ma(new Uint8Array(t),new Uint8Array(e),n,r);case ZB:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Ma(new Uint8Array(t),new Uint8Array(e),n,r);case YB:return t.name===e.name&&t.message===e.message;case th:{if(!(Ma(t.constructor,e.constructor,n,r)||Gy(t)&&Gy(e)))return!1;const c=[...Object.keys(t),...zy(t)],l=[...Object.keys(e),...zy(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const p=e[d];if(!xa(h,p,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function uL(t,e){return lL(t,e,cL)}var dL=Object.defineProperty,Yy=Object.getOwnPropertySymbols,hL=Object.prototype.hasOwnProperty,fL=Object.prototype.propertyIsEnumerable,bf=(t,e,n)=>e in t?dL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zy=(t,e)=>{for(var n in e||(e={}))hL.call(e,n)&&bf(t,n,e[n]);if(Yy)for(var n of Yy(e))fL.call(e,n)&&bf(t,n,e[n]);return t},An=(t,e,n)=>bf(t,typeof e!="symbol"?e+"":e,n);class no extends yN{constructor(e,n,r,s=Gr,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,An(this,"map",new Map),An(this,"version",g4),An(this,"cached",[]),An(this,"initialized",!1),An(this,"getKey"),An(this,"storagePrefix",Gr),An(this,"recentlyDeleted",[]),An(this,"recentlyDeletedLimit",200),An(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Ht(o)?this.map.set(this.getKey(o),o):O5(o)?this.map.set(o.id,o):R5(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),An(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),An(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),An(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>uL(a[c],o[c]))):this.values)),An(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Zy(Zy({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),An(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Bn(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return $n(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=ae("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}var pL=Object.defineProperty,gL=(t,e,n)=>e in t?pL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,We=(t,e,n)=>gL(t,typeof e!="symbol"?e+"":e,n);class mL{constructor(e,n){this.core=e,this.logger=n,We(this,"name",E4),We(this,"version",b4),We(this,"events",new zf),We(this,"pairings"),We(this,"initialized",!1),We(this,"storagePrefix",Gr),We(this,"ignoredPayloadTypes",[ws]),We(this,"registeredMethods",[]),We(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),We(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),We(this,"create",async r=>{this.isInitialized();const s=af(),i=await this.core.crypto.setSymKey(s),o=Rt(oe.FIVE_MINUTES),a={protocol:FC},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},l=fy({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(_i.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType,internal:r?.internal}),{topic:i,uri:l}}),We(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[Dr.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=hy(r.uri);s.props.properties.topic=i,s.addTrace(Dr.pairing_uri_validation_success),s.addTrace(Dr.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Dr.existing_pairing),u.active)throw s.setError(is.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Dr.pairing_not_expired)}const d=c||Rt(oe.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(Dr.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(_i.create,h),s.addTrace(Dr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Dr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(is.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(p){throw s.setError(is.subscribe_pairing_topic_failure),p}return s.addTrace(Dr.subscribe_pairing_topic_success),h}),We(this,"activate",async({topic:r})=>{this.isInitialized();const s=Rt(oe.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),We(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Ci();this.events.once(nt("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),We(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),We(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),We(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),We(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",gt("USER_DISCONNECTED")),await this.deletePairing(s))}),We(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return fy({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),We(this,"sendRequest",async(r,s,i)=>{const o=Er(s,i),a=await this.core.crypto.encode(r,o),c=ha[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),We(this,"sendResult",async(r,s,i)=>{const o=yc(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=ha[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),We(this,"sendError",async(r,s,i)=>{const o=zu(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=ha[c]?ha[c].res:ha.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),We(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),We(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>Br(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),We(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),We(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),We(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(_i.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),We(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{$r(s)?this.events.emit(nt("pairing_ping",i),{}):or(s)&&this.events.emit(nt("pairing_ping",i),{error:s.error})},500)}),We(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(_i.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),We(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=gt("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),We(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(gt("WC_METHOD_UNSUPPORTED",r))}),We(this,"isValidPair",(r,s)=>{var i;if(!In(r)){const{message:a}=ae("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(is.malformed_pairing_uri),new Error(a)}if(!x5(r.uri)){const{message:a}=ae("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(is.malformed_pairing_uri),new Error(a)}const o=hy(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=ae("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(is.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=ae("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(is.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&oe.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(is.pairing_expired);const{message:a}=ae("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),We(this,"isValidPing",async r=>{if(!In(r)){const{message:i}=ae("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),We(this,"isValidDisconnect",async r=>{if(!In(r)){const{message:i}=ae("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),We(this,"isValidPairingTopic",async r=>{if(!Pt(r,!1)){const{message:s}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(Br(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=ae("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=Bn(n,this.name),this.pairings=new no(this.core,this.logger,this.name,this.storagePrefix)}get context(){return $n(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(kt.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==dt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Tp(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):Vu(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(nr.expired,async e=>{const{topic:n}=xb(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(_i.expire,{topic:n}))})}}var yL=Object.defineProperty,wL=(t,e,n)=>e in t?yL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yt=(t,e,n)=>wL(t,typeof e!="symbol"?e+"":e,n);class EL extends fN{constructor(e,n){super(e,n),this.core=e,this.logger=n,Yt(this,"records",new Map),Yt(this,"events",new lr.EventEmitter),Yt(this,"name",C4),Yt(this,"version",v4),Yt(this,"cached",[]),Yt(this,"initialized",!1),Yt(this,"storagePrefix",Gr),Yt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Yt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:Rt(oe.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(hr.created,o)}),Yt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=or(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(hr.updated,s))}),Yt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Yt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(hr.deleted,i)}}),this.persist()}),Yt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Yt(this,"on",(r,s)=>{this.events.on(r,s)}),Yt(this,"once",(r,s)=>{this.events.once(r,s)}),Yt(this,"off",(r,s)=>{this.events.off(r,s)}),Yt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Bn(n,this.name)}get context(){return $n(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:Er(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(hr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(hr.created,e=>{const n=hr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(hr.updated,e=>{const n=hr.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(hr.deleted,e=>{const n=hr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(Xi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{oe.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(hr.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}var bL=Object.defineProperty,CL=(t,e,n)=>e in t?bL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cn=(t,e,n)=>CL(t,typeof e!="symbol"?e+"":e,n);class vL extends EN{constructor(e,n){super(e,n),this.core=e,this.logger=n,cn(this,"expirations",new Map),cn(this,"events",new lr.EventEmitter),cn(this,"name",_4),cn(this,"version",A4),cn(this,"cached",[]),cn(this,"initialized",!1),cn(this,"storagePrefix",Gr),cn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),cn(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),cn(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(nr.created,{target:i,expiration:o})}),cn(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),cn(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(nr.deleted,{target:s,expiration:i})}}),cn(this,"on",(r,s)=>{this.events.on(r,s)}),cn(this,"once",(r,s)=>{this.events.once(r,s)}),cn(this,"off",(r,s)=>{this.events.off(r,s)}),cn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Bn(n,this.name)}get context(){return $n(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return sD(e);if(typeof e=="number")return iD(e);const{message:n}=ae("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(nr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;oe.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(nr.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(Xi.pulse,()=>this.checkExpirations()),this.events.on(nr.created,e=>{const n=nr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(nr.expired,e=>{const n=nr.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(nr.deleted,e=>{const n=nr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}var _L=Object.defineProperty,AL=(t,e,n)=>e in t?_L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ot=(t,e,n)=>AL(t,typeof e!="symbol"?e+"":e,n);class SL extends bN{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,Ot(this,"name",S4),Ot(this,"abortController"),Ot(this,"isDevEnv"),Ot(this,"verifyUrlV3",T4),Ot(this,"storagePrefix",Gr),Ot(this,"version",MC),Ot(this,"publicKey"),Ot(this,"fetchPromise"),Ot(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&oe.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Ot(this,"register",async s=>{if(!Go()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Hi(),u=this.startAbortTimer(oe.ONE_SECOND*5),d=await new Promise((h,p)=>{const m=()=>{window.removeEventListener("message",b),l.body.removeChild(w),p("attestation aborted")};this.abortController.signal.addEventListener("abort",m);const w=l.createElement("iframe");w.src=c,w.style.display="none",w.addEventListener("error",m,{signal:this.abortController.signal});const b=R=>{if(R.data&&typeof R.data=="string")try{const k=JSON.parse(R.data);if(k.type==="verify_attestation"){if(Lh(k.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(w),this.abortController.signal.removeEventListener("abort",m),window.removeEventListener("message",b),h(k.attestation===null?"":k.attestation)}}catch(k){this.logger.warn(k)}};l.body.appendChild(w),window.addEventListener("message",b,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),Ot(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Lh(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),Ot(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(oe.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Ot(this,"getVerifyUrl",s=>{let i=s||La;return N4.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${La}`),i=La),i}),Ot(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(oe.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),Ot(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),Ot(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Ot(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Ot(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Ot(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),Ot(this,"validateAttestation",(s,i)=>{const o=t5(s,i.publicKey),a={hasExpired:oe.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Bn(n,this.name),this.abortController=new AbortController,this.isDevEnv=pp(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return $n(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),oe.toMiliseconds(e))}}var IL=Object.defineProperty,TL=(t,e,n)=>e in t?IL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jy=(t,e,n)=>TL(t,typeof e!="symbol"?e+"":e,n);class NL extends CN{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,Jy(this,"context",x4),Jy(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${O4}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Bn(n,this.context)}}var xL=Object.defineProperty,Xy=Object.getOwnPropertySymbols,OL=Object.prototype.hasOwnProperty,RL=Object.prototype.propertyIsEnumerable,Cf=(t,e,n)=>e in t?xL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ga=(t,e)=>{for(var n in e||(e={}))OL.call(e,n)&&Cf(t,n,e[n]);if(Xy)for(var n of Xy(e))RL.call(e,n)&&Cf(t,n,e[n]);return t},Ft=(t,e,n)=>Cf(t,typeof e!="symbol"?e+"":e,n);class kL extends vN{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,Ft(this,"context",k4),Ft(this,"storagePrefix",Gr),Ft(this,"storageVersion",R4),Ft(this,"events",new Map),Ft(this,"shouldPersist",!1),Ft(this,"init",async()=>{if(!pp())try{const s={eventId:km(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Tb(this.core.relayer.protocol,this.core.relayer.version,ff)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Ft(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=km(),u=this.core.projectId||"",d=Date.now(),h=ga({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),Ft(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return ga(ga({},a),this.setMethods(a.eventId))}),Ft(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Ft(this,"setEventListeners",()=>{this.core.heartbeat.on(Xi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{oe.fromMiliseconds(Date.now())-oe.fromMiliseconds(s.timestamp)>P4&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Ft(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Ft(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Ft(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Ft(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Ft(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,ga(ga({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Ft(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Ft(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${D4}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${ff}${i}`,{method:"POST",body:JSON.stringify(s)})}),Ft(this,"getAppDomain",()=>Ib().url),this.logger=Bn(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var PL=Object.defineProperty,Qy=Object.getOwnPropertySymbols,DL=Object.prototype.hasOwnProperty,UL=Object.prototype.propertyIsEnumerable,vf=(t,e,n)=>e in t?PL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ew=(t,e)=>{for(var n in e||(e={}))DL.call(e,n)&&vf(t,n,e[n]);if(Qy)for(var n of Qy(e))UL.call(e,n)&&vf(t,n,e[n]);return t},lt=(t,e,n)=>vf(t,typeof e!="symbol"?e+"":e,n);let $L=class ev extends lN{constructor(e){var n;super(e),lt(this,"protocol",LC),lt(this,"version",MC),lt(this,"name",hf),lt(this,"relayUrl"),lt(this,"projectId"),lt(this,"customStoragePrefix"),lt(this,"events",new lr.EventEmitter),lt(this,"logger"),lt(this,"heartbeat"),lt(this,"relayer"),lt(this,"crypto"),lt(this,"storage"),lt(this,"history"),lt(this,"expirer"),lt(this,"pairing"),lt(this,"verify"),lt(this,"echoClient"),lt(this,"linkModeSupportedApps"),lt(this,"eventClient"),lt(this,"initialized",!1),lt(this,"logChunkController"),lt(this,"on",(a,c)=>this.events.on(a,c)),lt(this,"once",(a,c)=>this.events.once(a,c)),lt(this,"off",(a,c)=>this.events.off(a,c)),lt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),lt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:dt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||jC,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Hf({level:typeof e?.logger=="string"&&e.logger?e.logger:t4.logger,name:hf}),{logger:i,chunkLoggerController:o}=Au({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Bn(i,this.name),this.heartbeat=new AT,this.crypto=new lB(this,this.logger,e?.keychain),this.history=new EL(this,this.logger),this.expirer=new vL(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new oN(ew(ew({},n4),e?.storageOptions)),this.relayer=new $B({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new mL(this,this.logger),this.verify=new SL(this,this.logger,this.storage),this.echoClient=new NL(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new kL(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new ev(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(m4,r),n}get context(){return $n(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(ky,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ky)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&e4.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const BL=$L,tv="wc",nv=2,rv="client",xp=`${tv}@${nv}:${rv}:`,nh={name:rv,logger:"error"},tw="WALLETCONNECT_DEEPLINK_CHOICE",LL="proposal",nw="Proposal expired",ML="session",mo=oe.SEVEN_DAYS,FL="engine",Zt={wc_sessionPropose:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1114},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:oe.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:oe.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1119}}},rh={min:oe.FIVE_MINUTES,max:oe.SEVEN_DAYS},Pr={idle:"IDLE",active:"ACTIVE"},jL={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},WL="request",HL=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],qL="wc",zL="auth",VL="authKeys",KL="pairingTopics",GL="requests",Gu=`${qL}@${1.5}:${zL}:`,Pl=`${Gu}:PUB_KEY`;var YL=Object.defineProperty,ZL=Object.defineProperties,JL=Object.getOwnPropertyDescriptors,rw=Object.getOwnPropertySymbols,XL=Object.prototype.hasOwnProperty,QL=Object.prototype.propertyIsEnumerable,_f=(t,e,n)=>e in t?YL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xe=(t,e)=>{for(var n in e||(e={}))XL.call(e,n)&&_f(t,n,e[n]);if(rw)for(var n of rw(e))QL.call(e,n)&&_f(t,n,e[n]);return t},Jt=(t,e)=>ZL(t,JL(e)),ee=(t,e,n)=>_f(t,typeof e!="symbol"?e+"":e,n);class eM extends IN{constructor(e){super(e),ee(this,"name",FL),ee(this,"events",new zf),ee(this,"initialized",!1),ee(this,"requestQueue",{state:Pr.idle,queue:[]}),ee(this,"sessionRequestQueue",{state:Pr.idle,queue:[]}),ee(this,"emittedSessionRequests",new pD({limit:500})),ee(this,"requestQueueDelay",oe.ONE_SECOND),ee(this,"expectedPairingMethodMap",new Map),ee(this,"recentlyDeletedMap",new Map),ee(this,"recentlyDeletedLimit",200),ee(this,"relayMessageCache",[]),ee(this,"pendingSessions",new Map),ee(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Zt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay)))}),ee(this,"connect",async n=>{var r;this.isInitialized(),await this.confirmOnlineStateOrThrow();const s=Jt(Xe({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(s),s.optionalNamespaces=A5(s.requiredNamespaces,s.optionalNamespaces),s.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:d,walletPay:h}=s,p=((r=d?.[0])==null?void 0:r.ttl)||Zt.wc_sessionPropose.req.ttl||oe.FIVE_MINUTES;this.validateRequestExpiry(p);let m=i,w,b=!1;try{if(m){const L=this.client.core.pairing.pairings.get(m);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),b=L.active}}catch(L){throw this.client.logger.error(`connect() -> pairing.get(${m}) failed`),L}if(!m||!b){const{topic:L,uri:Y}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});m=L,w=Y}if(!m){const{message:L}=ae("NO_MATCHING_KEY",`connect() pairing topic: ${m}`);throw new Error(L)}const R=await this.client.core.crypto.generateKeyPair(),k=Rt(p),S=Xe(Jt(Xe(Xe({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:FC}],proposer:{publicKey:R,metadata:this.client.metadata},expiryTimestamp:k,pairingTopic:m},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Ur()}),(d||h)&&{requests:{authentication:d?.map(L=>{const{domain:Y,chains:G,nonce:W,uri:D,exp:P,nbf:y,type:E,statement:A,requestId:N,resources:T,signatureTypes:x}=L;return{domain:Y,chains:G,nonce:W,type:E??"caip122",aud:D,version:"1",iat:new Date().toISOString(),exp:P,nbf:y,statement:A,requestId:N,resources:T,signatureTypes:x}}),walletPay:h}}),O=nt("session_connect",S.id),{reject:U,resolve:F,done:q}=Ci(p,nw),V=({id:L})=>{L===S.id&&(this.client.events.off("proposal_expire",V),this.pendingSessions.delete(S.id),this.events.emit(O,{error:{message:nw,code:0}}))};return this.client.events.on("proposal_expire",V),this.events.once(O,({error:L,session:Y})=>{this.client.events.off("proposal_expire",V),L?U(L):Y&&F(Y)}),await this.setProposal(S.id,S),await this.sendProposeSession({proposal:S,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:S.id}}}).catch(L=>{throw this.deleteProposal(S.id),L}),{uri:w,approval:q}}),ee(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),ee(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[fr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(Y){throw o.setError(pi.no_internet_connection),Y}try{await this.isValidProposalId(n?.id)}catch(Y){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(pi.proposal_not_found),Y}try{await this.isValidApprove(n)}catch(Y){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(pi.session_approve_namespace_validation_failure),Y}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:p}=n,m=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:w,proposer:b,requiredNamespaces:R,optionalNamespaces:k}=m;let S=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:w});S||(S=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:fr.session_approve_started,properties:{topic:w,trace:[fr.session_approve_started,fr.session_namespaces_validation_success]}}));const O=await this.client.core.crypto.generateKeyPair(),U=b.publicKey,F=await this.client.core.crypto.generateSharedKey(O,U),q=Jt(Xe(Xe(Xe({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:O,metadata:this.client.metadata},expiry:Rt(mo)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{proposalRequestsResponses:p}),V=dt.relay;S.addTrace(fr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(F,{transportType:V,internal:{skipSubscribe:!0}})}catch(Y){throw S.setError(pi.subscribe_session_topic_failure),Y}S.addTrace(fr.subscribe_session_topic_success);const L=Jt(Xe({},q),{topic:F,requiredNamespaces:R,optionalNamespaces:k,pairingTopic:w,acknowledged:!1,self:q.controller,peer:{publicKey:b.publicKey,metadata:b.metadata},controller:O,transportType:dt.relay,authentication:p?.authentication,walletPayResult:p?.walletPay});await this.client.session.set(F,L),S.addTrace(fr.store_session);try{await this.sendApproveSession({sessionTopic:F,proposal:m,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:O},sessionSettleRequest:q,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:Xe({correlationId:a},this.getTVFApproveParams(L))}}),S.addTrace(fr.session_approve_publish_success)}catch(Y){throw this.client.logger.error(Y),this.client.session.delete(F,gt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(F),Y}return this.client.core.eventClient.deleteEvent({eventId:S.eventId}),await this.client.core.pairing.updateMetadata({topic:w,metadata:b.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:w}),await this.setExpiry(F,Rt(mo)),{topic:F,acknowledged:()=>Promise.resolve(this.client.session.get(F))}}),ee(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Zt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),ee(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=Ci(oe.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Ur(),l=Js().toString(),u=this.client.session.get(r).namespaces;return this.events.once(nt("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),ee(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=Ur(),{done:i,resolve:o,reject:a}=Ci(oe.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(nt("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,Rt(mo)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),ee(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(b){throw this.client.logger.error("request() -> isValidRequest() failed"),b}const{chainId:r,request:s,topic:i,expiry:o=Zt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===dt.relay&&await this.confirmOnlineStateOrThrow();const c=Ur(),l=Js().toString(),{done:u,resolve:d,reject:h}=Ci(o,"Request expired. Please try again.");this.events.once(nt("session_request",c),({error:b,result:R})=>{b?h(b):d(R)});const p="wc_sessionRequest",m=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(m)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:{request:Jt(Xe({},s),{expiryTimestamp:Rt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:m}).catch(b=>h(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const w={request:Jt(Xe({},s),{expiryTimestamp:Rt(o)}),chainId:r};return await Promise.all([new Promise(async b=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:w,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,w)}).catch(R=>h(R)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),b()}),new Promise(async b=>{var R;if(!((R=a.sessionConfig)!=null&&R.disableDeepLink)){const k=await lD(this.client.core.storage,tw);await oD({id:c,topic:i,wcDeepLink:k})}b()}),u()]).then(b=>b[2])}),ee(this,"respond",async n=>{var r,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:n?.topic||((s=(r=n?.response)==null?void 0:r.id)==null?void 0:s.toString()),trace:[fr.session_request_response_started]}});try{await this.isValidRespond(n)}catch(d){throw i.addTrace(d?.message),i.setError(pi.session_request_response_validation_failure),d}i.addTrace(fr.session_request_response_validation_success);const{topic:o,response:a}=n,{id:c}=a,l=this.client.session.get(o);l.transportType===dt.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(fr.session_request_response_publish_started),$r(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):or(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(n)}catch(d){throw i.addTrace(d?.message),i.setError(pi.session_request_response_publish_failure),d}}),ee(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=Ur(),i=Js().toString(),{done:o,resolve:a,reject:c}=Ci(oe.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(nt("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),ee(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=Js().toString(),a=Ur();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),ee(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=ae("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),ee(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>T5(r,n)))),ee(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),ee(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?dt.link_mode:dt.relay;o===dt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:p,nbf:m,methods:w=[],expiry:b}=n,R=[...n.resources||[]],{topic:k,uri:S}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:k,uri:S}});const O=await this.client.core.crypto.generateKeyPair(),U=Rl(O);if(await Promise.all([this.client.auth.authKeys.set(Pl,{responseTopic:U,publicKey:O}),this.client.auth.pairingTopics.set(U,{topic:U,pairingTopic:k})]),await this.client.core.relayer.subscribe(U,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${k}`),w.length>0){const{namespace:T}=ys(a[0]);let x=TU(T,"request",w);Ol(R)&&(x=xU(x,R.pop())),R.push(x)}const F=b&&b>Zt.wc_sessionAuthenticate.req.ttl?b:Zt.wc_sessionAuthenticate.req.ttl,q={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:p,nbf:m,resources:R},requester:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:Rt(F)},V={eip155:{chains:a,methods:[...new Set(["personal_sign",...w])],events:["chainChanged","accountsChanged"]}},L={requiredNamespaces:{},optionalNamespaces:V,relays:[{protocol:"irn"}],pairingTopic:k,proposer:{publicKey:O,metadata:this.client.metadata},expiryTimestamp:Rt(Zt.wc_sessionPropose.req.ttl),id:Ur()},{done:Y,resolve:G,reject:W}=Ci(F,"Request expired"),D=Ur(),P=nt("session_connect",L.id),y=nt("session_request",D),E=async({error:T,session:x})=>{this.events.off(y,A),T?W(T):x&&G({session:x})},A=async T=>{var x,M,H;if(await this.deletePendingAuthRequest(D,{message:"fulfilled",code:0}),T.error){const ue=gt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return T.error.code===ue.code?void 0:(this.events.off(P,E),W(T.error.message))}await this.deleteProposal(L.id),this.events.off(P,E);const{cacaos:ne,responder:Z}=T.result,Q=[],pe=[];for(const ue of ne){await Hm({cacao:ue,projectId:this.client.core.projectId})||(this.client.logger.error(ue,"Signature verification failed"),W(gt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Ae}=ue,qe=Ol(Ae.resources),st=[Zh(Ae.iss)],Qe=cu(Ae.iss);if(qe){const Tt=qm(qe),Zn=zm(qe);Q.push(...Tt),st.push(...Zn)}for(const Tt of st)pe.push(`${Tt}:${Qe}`)}const ye=await this.client.core.crypto.generateSharedKey(O,Z.publicKey);let Te;Q.length>0&&(Te={topic:ye,acknowledged:!0,self:{publicKey:O,metadata:this.client.metadata},peer:Z,controller:Z.publicKey,expiry:Rt(mo),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:k,namespaces:yy([...new Set(Q)],[...new Set(pe)]),transportType:o},await this.client.core.relayer.subscribe(ye,{transportType:o}),await this.client.session.set(ye,Te),k&&await this.client.core.pairing.updateMetadata({topic:k,metadata:Z.metadata}),Te=this.client.session.get(ye)),(x=this.client.metadata.redirect)!=null&&x.linkMode&&(M=Z.metadata.redirect)!=null&&M.linkMode&&(H=Z.metadata.redirect)!=null&&H.universal&&r&&(this.client.core.addLinkModeSupportedApp(Z.metadata.redirect.universal),this.client.session.update(ye,{transportType:dt.link_mode})),G({auths:ne,session:Te})};this.events.once(P,E),this.events.once(y,A);let N;try{if(i){const T=Er("wc_sessionAuthenticate",q,D);this.client.core.history.set(k,T);const x=await this.client.core.crypto.encode("",T,{type:Uc,encoding:Vs});N=dl(r,k,x)}else await Promise.all([this.sendRequest({topic:k,method:"wc_sessionAuthenticate",params:q,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:D}),this.sendRequest({topic:k,method:"wc_sessionPropose",params:L,expiry:Zt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:L.id})])}catch(T){throw this.events.off(P,E),this.events.off(y,A),T}return await this.setProposal(L.id,L),await this.setAuthRequest(D,{request:Jt(Xe({},q),{verifyContext:{}}),pairingTopic:k,transportType:o}),{uri:N??S,response:Y}}),ee(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[gi.authenticated_session_approve_started]}});try{this.isInitialized()}catch(b){throw i.setError(fa.no_internet_connection),b}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(fa.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||dt.relay;a===dt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Rl(c),d={type:ws,receiverPublicKey:c,senderPublicKey:l},h=[],p=[];for(const b of s){if(!await Hm({cacao:b,projectId:this.client.core.projectId})){i.setError(fa.invalid_cacao);const U=gt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:U,encodeOpts:d}),new Error(U.message)}i.addTrace(gi.cacaos_verified);const{p:R}=b,k=Ol(R.resources),S=[Zh(R.iss)],O=cu(R.iss);if(k){const U=qm(k),F=zm(k);h.push(...U),S.push(...F)}for(const U of S)p.push(`${U}:${O}`)}const m=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(gi.create_authenticated_session_topic);let w;if(h?.length>0){w={topic:m,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Rt(mo),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:yy([...new Set(h)],[...new Set(p)]),transportType:a},i.addTrace(gi.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(m,{transportType:a})}catch(b){throw i.setError(fa.subscribe_authenticated_session_topic_failure),b}i.addTrace(gi.subscribe_authenticated_session_topic_success),await this.client.session.set(m,w),i.addTrace(gi.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(gi.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(b){throw i.setError(fa.authenticated_session_approve_publish_failure),b}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:w}}),ee(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===dt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Rl(o),l={type:ws,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:Zt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),ee(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return Vb(r,s)}),ee(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),ee(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),ee(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,gt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(tw).catch(l=>this.client.logger.warn(l)),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=Pr.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===s).map(l=>this.deletePendingSessionRequest(l.id,gt("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),ee(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(pi.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,gt("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),ee(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=Pr.idle,this.client.events.emit("session_request_expire",{id:n}))}),ee(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),ee(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),ee(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,Rt(Zt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),ee(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=dt.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),ee(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||Rt(Zt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),ee(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=n,p=Er(s,i,c);let m;const w=!!u;try{const k=w?Vs:On;m=await this.client.core.crypto.encode(r,p,{encoding:k})}catch(k){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),k}let b;if(HL.includes(s)){const k=ir(JSON.stringify(p)),S=ir(m);b=await this.client.core.verify.register({id:S,decryptedId:k})}const R=Xe(Xe({},Zt[s].req),h);if(R.attestation=b,o&&(R.ttl=o),a&&(R.id=a),this.client.core.history.set(r,p),w){const k=dl(u,r,m);await globalThis.Linking.openURL(k,this.client.name)}else R.tvf=Jt(Xe({},d),{correlationId:p.id}),l?(R.internal=Jt(Xe({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,m,R)):this.client.core.relayer.publish(r,m,R).catch(k=>this.client.logger.error(k));return p.id}),ee(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=Er("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:On}),a=ir(JSON.stringify(i)),c=ir(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Jt(Xe({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),ee(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=n,c=yc(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:On}),u=Er("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(r,u,{encoding:On});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:Jt(Xe({},a),{publishMethod:"wc_approveSession"})})}),ee(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=yc(r,i);let u;const d=c&&typeof globalThis?.Linking<"u";try{const m=d?Vs:On;u=await this.client.core.crypto.encode(s,l,Jt(Xe({},a||{}),{encoding:m}))}catch(m){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),m}let h,p;try{h=await this.client.core.history.get(s,r);const m=h.request;try{p=this.getTVFParams(r,m.params,i)}catch(w){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${w?.message}`)}}catch(m){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),m}if(d){const m=dl(c,s,u);await globalThis.Linking.openURL(m,this.client.name)}else{const m=h.request.method,w=Zt[m].res;w.tvf=Jt(Xe({},p),{correlationId:r}),o?(w.internal=Jt(Xe({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,w)):this.client.core.relayer.publish(s,u,w).catch(b=>this.client.logger.error(b))}await this.client.core.history.resolve(l)}),ee(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=zu(r,i);let u;const d=c&&typeof globalThis?.Linking<"u";try{const p=d?Vs:On;u=await this.client.core.crypto.encode(s,l,Jt(Xe({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let h;try{h=await this.client.core.history.get(s,r)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),p}if(d){const p=dl(c,s,u);await globalThis.Linking.openURL(p,this.client.name)}else{const p=h.request.method,m=a||Zt[p].res;this.client.core.relayer.publish(s,u,m)}await this.client.core.history.resolve(l)}),ee(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;Br(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Br(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),ee(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),ee(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),ee(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Pr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Pr.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=Pr.idle}),ee(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),ee(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),ee(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=ae("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),ee(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),ee(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(is.proposal_listener_not_found)),this.isValidConnect(Xe({},s.params));const u=a.expiryTimestamp||Rt(Zt.wc_sessionPropose.req.ttl),d=Xe({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:ir(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(Dr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Zt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),ee(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if($r(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(or(r)){await this.deleteProposal(i);const o=nt("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),ee(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h,proposalRequestsResponses:p}=r.params,m=[...this.pendingSessions.values()].find(R=>R.sessionTopic===n);if(!m)return this.client.logger.error(`Pending session not found for topic ${n}`);const w=this.client.proposal.get(m.proposalId),b=Jt(Xe(Xe(Xe({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:m.pairingTopic,requiredNamespaces:w.requiredNamespaces,optionalNamespaces:w.optionalNamespaces,controller:a.publicKey,self:{publicKey:m.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:dt.relay,authentication:p?.authentication,walletPayResult:p?.walletPay});await this.client.session.set(b.topic,b),await this.setExpiry(b.topic,b.expiry),await this.client.core.pairing.updateMetadata({topic:m.pairingTopic,metadata:b.peer.metadata}),this.pendingSessions.delete(m.proposalId),this.deleteProposal(m.proposalId,!1),this.cleanupDuplicatePairings(b),await this.sendResult({id:r.id,topic:n,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:b}),this.events.emit(nt("session_connect",m.proposalId),{session:b})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),ee(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;$r(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(nt("session_approve",s),{})):or(r)&&(await this.client.session.delete(n,gt("USER_DISCONNECTED")),this.events.emit(nt("session_approve",s),{error:r.error}))}),ee(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=da.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:gt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Xe({topic:n},s));try{da.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw da.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),ee(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),ee(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=nt("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);$r(r)?this.events.emit(nt("session_update",s),{}):or(r)&&this.events.emit(nt("session_update",s),{error:r.error})}),ee(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,Rt(mo)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),ee(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=nt("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);$r(r)?this.events.emit(nt("session_extend",s),{}):or(r)&&this.events.emit(nt("session_extend",s),{error:r.error})}),ee(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),ee(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=nt("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);$r(r)?this.events.emit(nt("session_ping",s),{}):or(r)&&this.events.emit(nt("session_ping",s),{error:r.error})},500)}),ee(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{await this.isValidDisconnect({topic:n,reason:r.params}),this.cleanupPendingSentRequestsForTopic({topic:n,error:gt("USER_DISCONNECTED")}),await this.deleteSession({topic:n,id:s})}catch(i){this.client.logger.error(i)}}),ee(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(Xe({topic:o},h));const p=this.client.session.get(o),m=await this.getVerifyContext({attestationId:c,hash:ir(JSON.stringify(Er("wc_sessionRequest",h,d))),encryptedId:l,metadata:p.peer.metadata,transportType:u}),w={id:d,topic:o,params:h,verifyContext:m};await this.setPendingSessionRequest(w),u===dt.link_mode&&(r=p.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(w):(this.addSessionRequestToSessionRequestQueue(w),this.processSessionRequestQueue())}catch(p){await this.sendError({id:d,topic:o,error:p}),this.client.logger.error(p)}}),ee(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=nt("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);$r(r)?this.events.emit(nt("session_request",s),{result:r.result}):or(r)&&this.events.emit(nt("session_request",s),{error:r.error})}),ee(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=da.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Xe({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),da.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),ee(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),$r(r)?this.events.emit(nt("session_request",s),{result:r.result}):or(r)&&this.events.emit(nt("session_request",s),{error:r.error})}),ee(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:ir(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),p={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:c}),c===dt.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),p={type:ws,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:p,rpcOpts:Zt.wc_sessionAuthenticate.autoReject,appLink:h})}}),ee(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),ee(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Pr.idle,this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay))}),ee(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(nt("session_request",i.request.id),{error:r})})}),ee(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Pr.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),ee(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=Pr.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),ee(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:Er("wc_sessionPropose",Jt(Xe({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),ee(this,"isValidConnect",async n=>{if(!In(n)){const{message:l}=ae("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(Ht(r)||await this.isValidPairingTopic(r),!M5(c)){const{message:l}=ae("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(s&&!Ht(s)&&zr(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(i&&!Ht(i)&&zr(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!Ht(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Ht(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),ee(this,"validateNamespaces",(n,r)=>{const s=L5(n,"connect()",r);if(s)throw new Error(s.message)}),ee(this,"isValidApprove",async n=>{if(!In(n))throw new Error(ae("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=Zd(s,"approve()");if(l)throw new Error(l.message);const u=by(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Pt(i,!0)){const{message:d}=ae("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(o&&!Ht(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Ht(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),ee(this,"isValidReject",async n=>{if(!In(n)){const{message:i}=ae("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!j5(s)){const{message:i}=ae("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),ee(this,"isValidSessionSettleRequest",n=>{if(!In(n)){const{message:l}=ae("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!OC(r)){const{message:l}=ae("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=k5(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Zd(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Br(o)){const{message:l}=ae("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),ee(this,"isValidUpdate",async n=>{if(!In(n)){const{message:c}=ae("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Zd(s,"update()");if(o)throw new Error(o.message);const a=by(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),ee(this,"isValidExtend",async n=>{if(!In(n)){const{message:s}=ae("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),ee(this,"isValidRequest",async n=>{if(!In(n)){const{message:c}=ae("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!Ey(a,i)){const{message:c}=ae("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!W5(s)){const{message:c}=ae("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!z5(a,i,s.method)){const{message:c}=ae("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),ee(this,"isValidRespond",async n=>{var r;if(!In(n)){const{message:a}=ae("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(a)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(a){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),a}if(!H5(i)){const{message:a}=ae("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=ae("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),ee(this,"isValidPing",async n=>{if(!In(n)){const{message:s}=ae("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),ee(this,"isValidEmit",async n=>{if(!In(n)){const{message:a}=ae("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!Ey(o,i)){const{message:a}=ae("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!q5(s)){const{message:a}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!V5(o,i,s.name)){const{message:a}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),ee(this,"isValidDisconnect",async n=>{if(!In(n)){const{message:s}=ae("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),ee(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!Pt(s,!1))throw new Error("uri is required parameter");if(!Pt(i,!1))throw new Error("domain is required parameter");if(!Pt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>ys(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=ys(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),ee(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||La,validation:"UNKNOWN",origin:o.url||""}};try{if(a===dt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),ee(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=ae("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),ee(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),ee(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),ee(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=ae("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),ee(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==dt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n?.redirect)==null?void 0:u.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((h=n?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof globalThis?.Linking<"u"}),ee(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),ee(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=Rm(n,"topic")||"",s=decodeURIComponent(Rm(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:dt.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),ee(this,"registerLinkModeListeners",async()=>{var n;if(pp()||ci()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=globalThis?.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),ee(this,"getTVFApproveParams",n=>{try{const r=NC(n.namespaces),s=E5(n.namespaces),i=b5(n.namespaces),o=n.sessionProperties,a=n.scopedProperties;return{approvedChains:r,approvedMethods:s,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(r){return this.client.logger.warn(r,"Error getting TVF approve params"),{}}}),ee(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),ee(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),ee(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=jL[i];if(i==="sui_signTransaction")return[cU(r.transactionBytes)];if(i==="near_signTransaction")return[Mm(r)];if(i==="near_signTransactions")return r.map(c=>Mm(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[u$({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return Es(r)?r.map(c=>Fm(c)):[Fm(r)];if(i==="cosmos_signDirect")return[uU(r)];if(i==="wallet_sendCalls")return dU(r);if(typeof r=="string")return[r];const a=r[o.key];if(Es(a))return i==="solana_signAllTransactions"?a.map(c=>aU(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(kt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Pl)?this.client.auth.authKeys.get(Pl):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===dt.link_mode?Vs:On});Tp(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:ir(r)})):Vu(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${r}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(nr.expired,async e=>{const{topic:n,id:r}=xb(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,ae("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,ae("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(_i.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(_i.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Pt(e,!1)){const{message:n}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(Br(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=ae("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!Pt(e,!1)){const{message:n}=ae("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=ae("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(Br(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=ae("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=ae("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Pt(e,!1)){const{message:n}=ae("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=ae("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!F5(e)){const{message:n}=ae("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=ae("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(Br(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=ae("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}validateRequestExpiry(e){if(e&&!Y5(e,rh)){const{message:n}=ae("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${rh.min} and ${rh.max}`);throw new Error(n)}}}class tM extends no{constructor(e,n){super(e,n,LL,xp),this.core=e,this.logger=n}}let nM=class extends no{constructor(e,n){super(e,n,ML,xp),this.core=e,this.logger=n}};class rM extends no{constructor(e,n){super(e,n,WL,xp,r=>r.id),this.core=e,this.logger=n}}class sM extends no{constructor(e,n){super(e,n,VL,Gu,()=>Pl),this.core=e,this.logger=n}}class iM extends no{constructor(e,n){super(e,n,KL,Gu),this.core=e,this.logger=n}}class oM extends no{constructor(e,n){super(e,n,GL,Gu,r=>r.id),this.core=e,this.logger=n}}var aM=Object.defineProperty,cM=(t,e,n)=>e in t?aM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sh=(t,e,n)=>cM(t,typeof e!="symbol"?e+"":e,n);class lM{constructor(e,n){this.core=e,this.logger=n,sh(this,"authKeys"),sh(this,"pairingTopics"),sh(this,"requests"),this.authKeys=new sM(this.core,this.logger),this.pairingTopics=new iM(this.core,this.logger),this.requests=new oM(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var uM=Object.defineProperty,dM=(t,e,n)=>e in t?uM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,He=(t,e,n)=>dM(t,typeof e!="symbol"?e+"":e,n);class Op extends SN{constructor(e){super(e),He(this,"protocol",tv),He(this,"version",nv),He(this,"name",nh.name),He(this,"metadata"),He(this,"core"),He(this,"logger"),He(this,"events",new lr.EventEmitter),He(this,"engine"),He(this,"session"),He(this,"proposal"),He(this,"pendingRequest"),He(this,"auth"),He(this,"signConfig"),He(this,"on",(r,s)=>this.events.on(r,s)),He(this,"once",(r,s)=>this.events.once(r,s)),He(this,"off",(r,s)=>this.events.off(r,s)),He(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),He(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),He(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),He(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),He(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),He(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||nh.name,this.metadata=eD(e?.metadata),this.signConfig=e?.signConfig;const n=Sp({logger:e?.logger||nh.logger,name:this.name});this.logger=n,this.core=e?.core||new BL(e),this.session=new nM(this.core,this.logger),this.proposal=new tM(this.core,this.logger),this.pendingRequest=new rM(this.core,this.logger),this.engine=new eM(this),this.auth=new lM(this.core,this.logger)}static async init(e){const n=new Op(e);return await n.initialize(),n}get context(){return $n(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const hM=Op;var Af={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof globalThis<"u"&&globalThis,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof i<"u"&&i||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(y){return y&&DataView.prototype.isPrototypeOf(y)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(y){return y&&u.indexOf(Object.prototype.toString.call(y))>-1};function h(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(y)||y==="")throw new TypeError('Invalid character in header field name: "'+y+'"');return y.toLowerCase()}function p(y){return typeof y!="string"&&(y=String(y)),y}function m(y){var E={next:function(){var A=y.shift();return{done:A===void 0,value:A}}};return c.iterable&&(E[Symbol.iterator]=function(){return E}),E}function w(y){this.map={},y instanceof w?y.forEach(function(E,A){this.append(A,E)},this):Array.isArray(y)?y.forEach(function(E){if(E.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+E.length);this.append(E[0],E[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(E){this.append(E,y[E])},this)}w.prototype.append=function(y,E){y=h(y),E=p(E);var A=this.map[y];this.map[y]=A?A+", "+E:E},w.prototype.delete=function(y){delete this.map[h(y)]},w.prototype.get=function(y){return y=h(y),this.has(y)?this.map[y]:null},w.prototype.has=function(y){return this.map.hasOwnProperty(h(y))},w.prototype.set=function(y,E){this.map[h(y)]=p(E)},w.prototype.forEach=function(y,E){for(var A in this.map)this.map.hasOwnProperty(A)&&y.call(E,this.map[A],A,this)},w.prototype.keys=function(){var y=[];return this.forEach(function(E,A){y.push(A)}),m(y)},w.prototype.values=function(){var y=[];return this.forEach(function(E){y.push(E)}),m(y)},w.prototype.entries=function(){var y=[];return this.forEach(function(E,A){y.push([A,E])}),m(y)},c.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function b(y){if(!y._noBody){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}}function R(y){return new Promise(function(E,A){y.onload=function(){E(y.result)},y.onerror=function(){A(y.error)}})}function k(y){var E=new FileReader,A=R(E);return E.readAsArrayBuffer(y),A}function S(y){var E=new FileReader,A=R(E),N=/charset=([A-Za-z0-9_-]+)/.exec(y.type),T=N?N[1]:"utf-8";return E.readAsText(y,T),A}function O(y){for(var E=new Uint8Array(y),A=new Array(E.length),N=0;N<E.length;N++)A[N]=String.fromCharCode(E[N]);return A.join("")}function U(y){if(y.slice)return y.slice(0);var E=new Uint8Array(y.byteLength);return E.set(new Uint8Array(y)),E.buffer}function F(){return this.bodyUsed=!1,this._initBody=function(y){this.bodyUsed=this.bodyUsed,this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:c.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:c.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():c.arrayBuffer&&c.blob&&l(y)?(this._bodyArrayBuffer=U(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||d(y))?this._bodyArrayBuffer=U(y):this._bodyText=y=Object.prototype.toString.call(y):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var y=b(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var y=b(this);return y||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(k);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var y=b(this);if(y)return y;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(O(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(Y)}),this.json=function(){return this.text().then(JSON.parse)},this}var q=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function V(y){var E=y.toUpperCase();return q.indexOf(E)>-1?E:y}function L(y,E){if(!(this instanceof L))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');E=E||{};var A=E.body;if(y instanceof L){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,E.headers||(this.headers=new w(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!A&&y._bodyInit!=null&&(A=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new w(E.headers)),this.method=V(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal||function(){if("AbortController"in a){var x=new AbortController;return x.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&A)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(A),(this.method==="GET"||this.method==="HEAD")&&(E.cache==="no-store"||E.cache==="no-cache")){var N=/([?&])_=[^&]*/;if(N.test(this.url))this.url=this.url.replace(N,"$1_="+new Date().getTime());else{var T=/\?/;this.url+=(T.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}L.prototype.clone=function(){return new L(this,{body:this._bodyInit})};function Y(y){var E=new FormData;return y.trim().split("&").forEach(function(A){if(A){var N=A.split("="),T=N.shift().replace(/\+/g," "),x=N.join("=").replace(/\+/g," ");E.append(decodeURIComponent(T),decodeURIComponent(x))}}),E}function G(y){var E=new w,A=y.replace(/\r?\n[\t ]+/g," ");return A.split("\r").map(function(N){return N.indexOf(`
`)===0?N.substr(1,N.length):N}).forEach(function(N){var T=N.split(":"),x=T.shift().trim();if(x){var M=T.join(":").trim();try{E.append(x,M)}catch(H){console.warn("Response "+H.message)}}}),E}F.call(L.prototype);function W(y,E){if(!(this instanceof W))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=E.statusText===void 0?"":""+E.statusText,this.headers=new w(E.headers),this.url=E.url||"",this._initBody(y)}F.call(W.prototype),W.prototype.clone=function(){return new W(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},W.error=function(){var y=new W(null,{status:200,statusText:""});return y.ok=!1,y.status=0,y.type="error",y};var D=[301,302,303,307,308];W.redirect=function(y,E){if(D.indexOf(E)===-1)throw new RangeError("Invalid status code");return new W(null,{status:E,headers:{location:y}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(E,A){this.message=E,this.name=A;var N=Error(E);this.stack=N.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function P(y,E){return new Promise(function(A,N){var T=new L(y,E);if(T.signal&&T.signal.aborted)return N(new o.DOMException("Aborted","AbortError"));var x=new XMLHttpRequest;function M(){x.abort()}x.onload=function(){var Z={statusText:x.statusText,headers:G(x.getAllResponseHeaders()||"")};T.url.indexOf("file://")===0&&(x.status<200||x.status>599)?Z.status=200:Z.status=x.status,Z.url="responseURL"in x?x.responseURL:Z.headers.get("X-Request-URL");var Q="response"in x?x.response:x.responseText;setTimeout(function(){A(new W(Q,Z))},0)},x.onerror=function(){setTimeout(function(){N(new TypeError("Network request failed"))},0)},x.ontimeout=function(){setTimeout(function(){N(new TypeError("Network request timed out"))},0)},x.onabort=function(){setTimeout(function(){N(new o.DOMException("Aborted","AbortError"))},0)};function H(Z){try{return Z===""&&a.location.href?a.location.href:Z}catch{return Z}}if(x.open(T.method,H(T.url),!0),T.credentials==="include"?x.withCredentials=!0:T.credentials==="omit"&&(x.withCredentials=!1),"responseType"in x&&(c.blob?x.responseType="blob":c.arrayBuffer&&(x.responseType="arraybuffer")),E&&typeof E.headers=="object"&&!(E.headers instanceof w||a.Headers&&E.headers instanceof a.Headers)){var ne=[];Object.getOwnPropertyNames(E.headers).forEach(function(Z){ne.push(h(Z)),x.setRequestHeader(Z,p(E.headers[Z]))}),T.headers.forEach(function(Z,Q){ne.indexOf(Q)===-1&&x.setRequestHeader(Q,Z)})}else T.headers.forEach(function(Z,Q){x.setRequestHeader(Q,Z)});T.signal&&(T.signal.addEventListener("abort",M),x.onreadystatechange=function(){x.readyState===4&&T.signal.removeEventListener("abort",M)}),x.send(typeof T._bodyInit>"u"?null:T._bodyInit)})}return P.polyfill=!0,a.fetch||(a.fetch=P,a.Headers=w,a.Request=L,a.Response=W),o.Headers=w,o.Request=L,o.Response=W,o.fetch=P,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Af,Af.exports);var fM=Af.exports;const sw=zo(fM);var pM=Object.defineProperty,gM=Object.defineProperties,mM=Object.getOwnPropertyDescriptors,iw=Object.getOwnPropertySymbols,yM=Object.prototype.hasOwnProperty,wM=Object.prototype.propertyIsEnumerable,ow=(t,e,n)=>e in t?pM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,aw=(t,e)=>{for(var n in e||(e={}))yM.call(e,n)&&ow(t,n,e[n]);if(iw)for(var n of iw(e))wM.call(e,n)&&ow(t,n,e[n]);return t},cw=(t,e)=>gM(t,mM(e));const EM={Accept:"application/json","Content-Type":"application/json"},bM="POST",lw={headers:EM,method:bM},uw=10;let sv=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new lr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Iy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=Wi(e),r=await(await sw(this.url,cw(aw({},lw),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!Iy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=Wi({id:1,jsonrpc:"2.0",method:"test",params:[]});await sw(e,cw(aw({},lw),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?ji(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=zu(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return PC(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>uw&&this.events.setMaxListeners(uw)}};function Rp(t){return t==null||typeof t!="object"&&typeof t!="function"}function iv(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function ov(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const CM="[object RegExp]",av="[object String]",cv="[object Number]",lv="[object Boolean]",uv="[object Arguments]",vM="[object Symbol]",_M="[object Date]",AM="[object Map]",SM="[object Set]",IM="[object Array]",TM="[object ArrayBuffer]",NM="[object Object]",xM="[object DataView]",OM="[object Uint8Array]",RM="[object Uint8ClampedArray]",kM="[object Uint16Array]",PM="[object Uint32Array]",DM="[object Int8Array]",UM="[object Int16Array]",$M="[object Int32Array]",BM="[object Float32Array]",LM="[object Float64Array]";function kp(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function MM(t,e){return So(t,void 0,t,new Map,e)}function So(t,e,n,r=new Map,s=void 0){const i=s?.(t,e,n,r);if(i!=null)return i;if(Rp(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=So(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,So(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(So(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(kp(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=So(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Ai(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Ai(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Ai(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Ai(o,t,n,r,s),o}if(typeof t=="object"&&FM(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Ai(o,t,n,r,s),o}return t}function Ai(t,e,n=t,r,s){const i=[...Object.keys(e),...iv(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=So(e[a],a,n,r,s))}}function FM(t){switch(ov(t)){case uv:case IM:case TM:case xM:case lv:case _M:case BM:case LM:case DM:case UM:case $M:case AM:case cv:case NM:case CM:case SM:case av:case vM:case OM:case RM:case kM:case PM:return!0;default:return!1}}function jM(t,e){return MM(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case cv:case av:case lv:{const o=new t.constructor(t?.valueOf());return Ai(o,t),o}case uv:{const o={};return Ai(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function dw(t){return jM(t)}function hw(t){return t!==null&&typeof t=="object"&&ov(t)==="[object Arguments]"}function fw(t){return typeof t=="object"&&t!==null}function WM(){}function HM(t){return kp(t)}function qM(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function zM(t){if(Rp(t))return t;if(Array.isArray(t)||kp(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function VM(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=Sf(s,o,r,new Map)}return s}function Sf(t,e,n,r){if(Rp(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return zM(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...iv(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(hw(a)&&(a={...a}),hw(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=dw(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const p=d[h];u[p]=c[p]}c=u}else c=[];const l=n(c,a,o,t,e,r);l!=null?t[o]=l:Array.isArray(a)||fw(c)&&fw(a)?t[o]=Sf(c,a,n,r):c==null&&qM(a)?t[o]=Sf({},a,n,r):c==null&&HM(a)?t[o]=dw(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function KM(t,...e){return VM(t,...e,WM)}const pw="error",GM="wss://relay.walletconnect.org",YM="wc",dv="universal_provider",hl=`${YM}@2:${dv}:`,hv="https://rpc.walletconnect.org/v1/",fv="generic",ZM=`${hv}bundler`,Po="call_status",JM=86400,Pp={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var XM=Object.defineProperty,QM=Object.defineProperties,eF=Object.getOwnPropertyDescriptors,gw=Object.getOwnPropertySymbols,tF=Object.prototype.hasOwnProperty,nF=Object.prototype.propertyIsEnumerable,mw=(t,e,n)=>e in t?XM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fl=(t,e)=>{for(var n in e||(e={}))tF.call(e,n)&&mw(t,n,e[n]);if(gw)for(var n of gw(e))nF.call(e,n)&&mw(t,n,e[n]);return t},rF=(t,e)=>QM(t,eF(e));function pv(t,e,n){var r;const s=ys(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${hv}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function sF(t){return t.includes(":")?t.split(":")[1]:t}function gv(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function iF(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function yw(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function pl(t={},e={}){const n=yw(ww(t)),r=yw(ww(e));return KM(n,r)}function ww(t){var e,n,r,s,i;const o={};if(!zr(t))return o;for(const[a,c]of Object.entries(t)){const l=qu(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},p=Ao(a);o[p]=rF(fl(fl({},o[p]),c),{chains:qr(l,(e=o[p])==null?void 0:e.chains),methods:qr(u,(n=o[p])==null?void 0:n.methods),events:qr(d,(r=o[p])==null?void 0:r.events)}),(zr(h)||zr(((s=o[p])==null?void 0:s.rpcMap)||{}))&&(o[p].rpcMap=fl(fl({},h),(i=o[p])==null?void 0:i.rpcMap))}return o}function Ew(t){return t.includes(":")?t.split(":")[2]:t}function bw(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=qu(n)?[n]:r.chains?r.chains:gv(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function ih(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}function oF(t){try{const e=JSON.parse(t);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const mv={},Do=t=>mv[t],oh=(t,e)=>{mv[t]=e};var aF=Object.defineProperty,Cw=Object.getOwnPropertySymbols,cF=Object.prototype.hasOwnProperty,lF=Object.prototype.propertyIsEnumerable,vw=(t,e,n)=>e in t?aF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_w=(t,e)=>{for(var n in e||(e={}))cF.call(e,n)&&vw(t,n,e[n]);if(Cw)for(var n of Cw(e))lF.call(e,n)&&vw(t,n,e[n]);return t};const Aw="eip155",uF=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],dF=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,ah=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,Sw=t=>Object.keys(t).filter(e=>uF.includes(e)).reduce((e,n)=>(e[n]=hF(t[n]),e),{}),hF=t=>typeof t=="string"&&oF(t)?JSON.parse(t):t,fF=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!zr(s)&&!zr(r))return;const o=Sw(r);for(const a of n){const c=dF(a);if(!c)continue;i[ah(c)]=o;const l=s?.[`${Aw}:${c}`];if(l){const u=l?.[`${Aw}:${c}:${e}`];i[ah(c)]=_w(_w({},i[ah(c)]),Sw(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var pF=Object.defineProperty,gF=(t,e,n)=>e in t?pF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mF=(t,e,n)=>gF(t,e+"",n);let ch;class Dp{constructor(e){mF(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,n){return await this.storage.setItem(e,n)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return ch||(ch=new Dp(e)),ch}}var yF=Object.defineProperty,wF=Object.defineProperties,EF=Object.getOwnPropertyDescriptors,Iw=Object.getOwnPropertySymbols,bF=Object.prototype.hasOwnProperty,CF=Object.prototype.propertyIsEnumerable,Tw=(t,e,n)=>e in t?yF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vF=(t,e)=>{for(var n in e||(e={}))bF.call(e,n)&&Tw(t,n,e[n]);if(Iw)for(var n of Iw(e))CF.call(e,n)&&Tw(t,n,e[n]);return t},_F=(t,e)=>wF(t,EF(e));async function AF(t,e){const n=ys(t.result.capabilities.caip345.caip2),r=t.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(r.map(d=>SF(n.reference,d,e))),i=s.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);s.filter(d=>d.status==="rejected").forEach(d=>console.warn("Failed to fetch transaction receipt:",d.reason));const o=!i.length||i.some(d=>!d),a=i.every(d=>d?.status==="0x1"),c=i.every(d=>d?.status==="0x0"),l=i.some(d=>d?.status==="0x0");let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:i,status:u}}async function SF(t,e,n){return await n(parseInt(t)).request(Er("eth_getTransactionReceipt",[e]))}async function IF({sendCalls:t,storage:e}){const n=await e.getItem(Po);await e.setItem(Po,_F(vF({},n),{[t.result.id]:{request:t.request,result:t.result,expiry:Rt(JM)}}))}async function TF({resultId:t,storage:e}){const n=await e.getItem(Po);if(n){delete n[t],await e.setItem(Po,n);for(const r in n)Br(n[r].expiry)&&delete n[r];await e.setItem(Po,n)}}async function NF({resultId:t,storage:e}){const n=await e.getItem(Po),r=n?.[t];if(r&&!Br(r.expiry))return r;await TF({resultId:t,storage:e})}var xF=Object.defineProperty,OF=Object.defineProperties,RF=Object.getOwnPropertyDescriptors,Nw=Object.getOwnPropertySymbols,kF=Object.prototype.hasOwnProperty,PF=Object.prototype.propertyIsEnumerable,If=(t,e,n)=>e in t?xF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lh=(t,e)=>{for(var n in e||(e={}))kF.call(e,n)&&If(t,n,e[n]);if(Nw)for(var n of Nw(e))PF.call(e,n)&&If(t,n,e[n]);return t},uh=(t,e)=>OF(t,RF(e)),mi=(t,e,n)=>If(t,typeof e!="symbol"?e+"":e,n);class DF{constructor(e){mi(this,"name","eip155"),mi(this,"client"),mi(this,"chainId"),mi(this,"namespace"),mi(this,"httpProviders"),mi(this,"events"),mi(this,"storage"),this.namespace=e.namespace,this.events=Do("events"),this.client=Do("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=Dp.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n);const r=this.chainId;this.chainId=parseInt(e),this.events.emit(Pp.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||pv(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Np(new sv(r,Do("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(sF(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(e){const n=e||this.chainId;return this.httpProviders[n]||(this.httpProviders=uh(lh({},this.httpProviders),{[n]:this.createHttpProvider(n)}),this.httpProviders[n])}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=c.length>0?c.join(","):`0x${this.chainId.toString(16)}`,h=`${a}${d}`,p=u?.[h];if(p)return p;let m;try{m=fF(l,a,c)}catch(b){console.warn("Failed to extract capabilities from session",b)}if(m)return m;const w=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:uh(lh({},l.sessionProperties||{}),{capabilities:uh(lh({},u||{}),{[h]:w})})})}catch(b){console.warn("Failed to update session with capabilities",b)}return w}async getCallStatus(e){var n,r,s;const i=this.client.session.get(e.topic),o=(n=i.sessionProperties)==null?void 0:n.bundler_name;if(o){const l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}const a=(r=i.sessionProperties)==null?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}const c=await NF({resultId:(s=e.request.params)==null?void 0:s[0],storage:this.storage});if(c)try{return await AF(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Er("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${ZM}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}async sendCalls(e){var n,r,s;const i=await this.client.request(e),o=(n=e.request.params)==null?void 0:n[0],a=i?.id,c=i?.capabilities||{},l=(r=c?.caip345)==null?void 0:r.caip2,u=(s=c?.caip345)==null?void 0:s.transactionHashes;return!a||!l||!(u!=null&&u.length)||await IF({sendCalls:{request:o,result:i},storage:this.storage}),i}}var UF=Object.defineProperty,$F=(t,e,n)=>e in t?UF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yo=(t,e,n)=>$F(t,typeof e!="symbol"?e+"":e,n);class BF{constructor(e){yo(this,"name",fv),yo(this,"client"),yo(this,"httpProviders"),yo(this,"events"),yo(this,"namespace"),yo(this,"chainId"),this.namespace=e.namespace,this.events=Do("events"),this.client=Do("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n);const r=this.chainId;this.chainId=e,this.events.emit(Pp.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return ys(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{var i,o;const a=ys(s),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];r[a.reference]=this.createHttpProvider(s,c)}),r}getHttpProvider(e){const n=ys(e).reference,r=this.httpProviders[n];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||pv(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Np(new sv(r,Do("disableProviderPing")))}}var LF=Object.defineProperty,MF=Object.defineProperties,FF=Object.getOwnPropertyDescriptors,xw=Object.getOwnPropertySymbols,jF=Object.prototype.hasOwnProperty,WF=Object.prototype.propertyIsEnumerable,Tf=(t,e,n)=>e in t?LF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ma=(t,e)=>{for(var n in e||(e={}))jF.call(e,n)&&Tf(t,n,e[n]);if(xw)for(var n of xw(e))WF.call(e,n)&&Tf(t,n,e[n]);return t},gl=(t,e)=>MF(t,FF(e)),Wn=(t,e,n)=>Tf(t,typeof e!="symbol"?e+"":e,n);let HF=class yv{constructor(e){Wn(this,"client"),Wn(this,"namespaces"),Wn(this,"optionalNamespaces"),Wn(this,"sessionProperties"),Wn(this,"scopedProperties"),Wn(this,"events",new zf),Wn(this,"rpcProviders",{}),Wn(this,"session"),Wn(this,"providerOpts"),Wn(this,"logger"),Wn(this,"uri"),Wn(this,"disableProviderPing",!1),Wn(this,"connectParams");var n,r;this.providerOpts=e,this.logger=Sp({logger:(n=e.logger)!=null?n:pw,name:(r=this.providerOpts.name)!=null?r:dv}),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const n=new yv(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:ma({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,yc(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:gt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=e,this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=bw(this.session.namespaces);this.namespaces=pl(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){var n,r;const{uri:s,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(n=this.connectParams)==null?void 0:n.authentication,walletPay:(r=this.connectParams)==null?void 0:r.walletPay});s&&(this.uri=s,this.events.emit("display_uri",s));const o=await i();this.session=o;const a=bw(o.namespaces);return this.namespaces=pl(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!Es(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn(n,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await hM.init({core:this.providerOpts.core,logger:this.providerOpts.logger||pw,relayUrl:this.providerOpts.relayUrl||GM,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>Ao(n)))];oh("client",this.client),oh("events",this.events),oh("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=iF(n,this.session);if(r?.length===0)return;const s=gv(r),i=pl(this.namespaces,this.optionalNamespaces),o=gl(ma({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new DF({namespace:o});break;default:this.rpcProviders[n]=new BF({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&Es(o)&&this.events.emit("accountsChanged",o.map(Ew))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Ao(o),l=ih(o)!==ih(a)?`${c}:${ih(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=gl(ma({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",gl(ma({},gt("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Pp.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(gl(ma({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[fv]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=pl(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Ao(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Ao(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:n,internal:r=!1}){if(!this.namespaces)return;const[s,i]=this.validateChain(e);i&&(this.updateNamespaceChain(s,i),r?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:s,currentCaipChainId:e,previousCaipChainId:n})):this.getProvider(s).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:n,previousCaipChainId:r}){var s,i;try{if(r===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(Ew);if(!Es(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${hl}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${hl}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${hl}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(hl)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn(n,"Failed to cleanup storage")}}};const Ow=2147483648,qF={convertEVMChainIdToCoinType(t){if(t>=Ow)throw new Error("Invalid chainId");return(Ow|t)>>>0}},er=tt({suggestions:[],loading:!1}),zF={state:er,subscribe(t){return xt(er,()=>t(er))},subscribeKey(t,e){return It(er,t,e)},async resolveName(t){try{return await _e.lookupEnsName(t)}catch(e){const n=e;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(t){try{return await _e.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{er.loading=!0,er.suggestions=[];const e=await _e.getEnsNameSuggestions(t);return er.suggestions=e.suggestions||[],er.suggestions}catch(e){const n=Fa.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{er.loading=!1}},async getNamesForAddress(t){try{if(!v.state.activeCaipNetwork)return[];const n=J.getEnsFromCacheForAddress(t);if(n)return n;const r=await _e.reverseLookupEnsName({address:t});return J.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Fa.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=v.state.activeCaipNetwork,n=v.getAccountData(e?.chainNamespace)?.address,r=te.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");er.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});he.pushTransactionStack({onCancel(){he.replace("RegisterAccountName")}});const i=await re.signMessage(s);er.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=qF.convertEVMChainIdToCoinType(Number(o));await _e.registerEnsName({coinType:a,address:n,signature:i,message:s}),v.setAccountProp("profileName",t,e.chainNamespace),J.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),he.replace("RegisterAccountNameSuccess")}catch(s){const i=Fa.parseEnsApiError(s,`Error registering name ${t}`);throw he.replace("RegisterAccountName"),new Error(i)}finally{er.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){return t?.reasons?.[0]?.description||e}},Fa=Ln(zF);function Nf(t){try{return new URL(t)}catch{return null}}function VF(t){const e=t.split("/"),n=e.length>0&&e[0]!==void 0?e[0]:"",r=n.lastIndexOf(":");return r===-1?{host:n}:{host:n.slice(0,r),port:n.slice(r+1)}}function KF(t){const e=t.indexOf("://");if(e===-1)return null;const n=t.slice(0,e),r=e+3;let s=t.indexOf("/",r);s===-1&&(s=t.length);const i=t.slice(r,s),o=i.lastIndexOf(":");return o===-1?{scheme:n,host:i}:{scheme:n,host:i.slice(0,o),port:i.slice(o+1)}}function GF(t,e){if(e.includes("://")){const o=Nf(e);return o?o.origin===t:!1}const{host:n,port:r}=VF(e),s=t.indexOf("://");if(s!==-1){const o=s+3;let a=t.indexOf("/",o);a===-1&&(a=t.length);const c=t.slice(o,a);if(r!==void 0)return`${n}:${r}`===c;const l=c.split(":")[0];return n===l}const i=Nf(t);return i?r!==void 0?n===i.hostname&&r===(i.port||void 0):n===i.hostname:!1}function YF(t,e,n){let r=n,s;const i=r.indexOf("://");i!==-1&&(s=r.slice(0,i),r=r.slice(i+3));const o=r.indexOf("/");o!==-1&&(r=r.slice(0,o));let a=r,c;const l=a.lastIndexOf(":");l!==-1&&(c=a.slice(l+1),a=a.slice(0,l));const u=a.split(".");for(const w of u)if(w.includes("*")&&w!=="*")return!1;const d=t.protocol.replace(/:$/u,"");if(s&&s!==d||c!==void 0&&c!=="*"&&c!==t.port)return!1;const h=KF(e),m=(h?h.host:t.hostname).split(".");if(u.length!==m.length)return!1;for(let w=u.length-1;w>=0;w-=1){const b=u[w],R=m[w];if(b!=="*"&&b!==R)return!1}return!0}const ZF={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},bs={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return ZF[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":u.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":u.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K");break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{const e=await Fa.resolveName(t);return(e?.addresses?Object.values(e.addresses):[])[0]?.address||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===bs.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===bs.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){const r=[...e,...n];if(e.length===0)return!0;const s=Nf(t);if(!s)return r.some(i=>!i.includes("*")&&i===t);if(s.hostname==="localhost"||s.hostname==="127.0.0.1")return!0;for(const i of r)if(i.includes("*")){if(YF(s,t,i))return!0}else if(GF(t,i))return!0;return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=bs.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",a=>{try{const c=t.session?.namespaces?.[e]?.accounts||[],l=t.rpcProviders?.[e]?.getDefaultChain(),u=a.map(d=>{const h=c.find(w=>w.includes(`${e}:${l}:${d}`));if(!h)return;const{chainId:p,chainNamespace:m}=Lt.parseCaipAddress(h);return{address:d,chainId:p,chainNamespace:m}}).filter(d=>d!==void 0);u.length>0&&s(u)}catch(c){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,c)}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){const n=new Set,r=t?.session?.namespaces?.[e]?.accounts?.map(s=>Lt.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}},JF=[$.CONNECTOR_ID.AUTH,$.CONNECTOR_ID.WALLET_CONNECT];class wv{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>v.getCaipNetworks(n),this.getConnectorId=n=>te.getConnectorId(n),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());e&&r&&this.addConnection({connectorId:$.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:$.CONNECTOR_ID.AUTH,type:"AUTH",name:$.CONNECTOR_NAMES.AUTH,provider:e,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>n.connectorId.toLowerCase()!==e.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){v.setAccountProp("status",e,n)}on(e,n){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw bs.isUserRejectedRequestError(n)?new Co(n):n}}async switchNetwork(e){const{caipNetwork:n}=e,r=it.getProviderId(n.chainNamespace),s=it.getProvider(n.chainNamespace);if(!s)throw new Error("Provider not found");if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(r==="AUTH"){const i=te.getAuthConnector()?.provider;if(!i)throw new Error("Auth provider not found");const o=zt(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n.id==="walletConnect");if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=se.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=se.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){if(e.length>0){const{address:s}=se.getAccount(e[0]),i=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&this.getConnectorId($.CHAIN.EVM)?.toLowerCase()===n.toLowerCase()&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:e.map(o=>{const{address:a}=se.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),this.getConnectorId($.CHAIN.EVM)?.toLowerCase()===e.toLowerCase()&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){const r=typeof e=="string"&&e.startsWith("0x")?parseInt(e,16).toString():e.toString(),s=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),this.getConnectorId($.CHAIN.EVM)?.toLowerCase()===n.toLowerCase()&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(JF.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[n]=e.accounts;this.emit("accountChanged",{address:n?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>l.connectorId.toLowerCase()===n.toLowerCase());if(!o)return null;const a=s.find(l=>l.id.toLowerCase()===o.connectorId.toLowerCase()),c=e?o.accounts.find(l=>l.address.toLowerCase()===e.toLowerCase()):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>a.id.toLowerCase()===o.connectorId.toLowerCase()));if(i){const[o]=i.accounts,a=s.find(c=>c.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:o,connector:a}}return null}}let yi=null;const Rn={getSIWX(){return K.state.siwx},async initializeIfEnabled(t=v.getActiveCaipAddress()){const e=K.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(v.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(K.state.remoteFeatures?.emailCapture){const o=v.getAccountData(n)?.user;await $e.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(yi&&await yi,(await e.getSessions(`${n}:${r}`,s)).length)return;await $e.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),xe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(i)}),await re._getClient()?.disconnect().catch(console.error),he.reset("Connect"),pt.showError("A problem occurred while trying initialize authentication")}},async isAuthenticated(t=v.getActiveCaipAddress()){if(!K.state.siwx||!t)return!0;const{chainNamespace:n,chainId:r,address:s}=Lt.parseCaipAddress(t),i=`${n}:${r}`;return(await Rn.getSessions({address:s,caipNetworkId:i})).length>0},async requestSignMessage(){const t=K.state.siwx,e=se.getPlainAddress(v.getActiveCaipAddress()),n=hs();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");try{const r=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),s=r.toString();let i="";t.signMessage?i=await t.signMessage({message:s,chainId:n.caipNetworkId,accountAddress:e}):(te.getConnectorId(n.chainNamespace)===$.CONNECTOR_ID.AUTH&&he.pushTransactionStack({}),i=await re.signMessage(s)||""),await t.addSession({data:r,message:s,signature:i}),v.setLastConnectedSIWECaipNetwork(n),$e.close(),xe.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(r){(!$e.state.open||he.state.view==="ApproveTransaction")&&await $e.open({view:"SIWXSignMessage"}),pt.showError("Error signing message"),xe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(r)}),console.error("SWIXUtil:requestSignMessage",r)}},async cancelSignMessage(){try{const t=this.getSIWX();if(t?.getRequired?.()){const n=v.getLastConnectedSIWECaipNetwork();if(n){const r=await t?.getSessions(n?.caipNetworkId,se.getPlainAddress(v.getActiveCaipAddress())||"");r&&r.length>0?await v.switchActiveNetwork(n):await re.disconnect()}else await re.disconnect()}else $e.close();$e.close(),xe.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(t){console.error("SIWXUtil:cancelSignMessage",t)}},async getAllSessions(){const t=this.getSIWX(),e=v.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await t?.getSessions(r.caipNetworkId,se.getPlainAddress(v.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(t){const e=K.state.siwx;let n=t?.address;if(!n){const s=v.getActiveCaipAddress();n=se.getPlainAddress(s)}let r=t?.caipNetworkId;return r||(r=v.getActiveCaipNetwork()?.caipNetworkId),e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){const t=this.getSIWX();if(t){const e=he.state.view==="ApproveTransaction",n=he.state.view==="SIWXSignMessage";if(e||n)return t.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=Rn.getSIWX(),o=hs();if(!i||!s.includes($.CHAIN.EVM)||K.state.remoteFeatures?.emailCapture){const d=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await t.connect({chainId:e,socialUri:n,siwxMessage:l,preferredAccountType:r});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await Rn.addEmbeddedWalletSession(l,u.message,u.signature),v.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,n){if(yi)return yi;const r=Rn.getSIWX();return r?(yi=r.addSession({data:t,message:e,signature:n}).finally(()=>{yi=null}),yi):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){const r=Rn.getSIWX(),s=hs(),i=new Set(e.map(l=>l.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:hs()?.caipNetworkId||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(l=>l!==o.chainId)]});pt.showLoading("Authenticating...",{autoClose:!1});const c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(v.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),a?.auths?.length){const l=a.auths.map(u=>{const d=t.client.formatAuthMessage({request:u.p,iss:u.p.iss});return{data:{...u.p,accountAddress:u.p.iss.split(":").slice(-1).join(""),chainId:u.p.iss.split(":").slice(2,4).join(":"),uri:u.p.aud??"",version:u.p.version||o.version,expirationTime:u.p.exp,issuedAt:u.p.iat,notBefore:u.p.nbf},message:d,signature:u.s.s,cacao:u}});try{await r.setSessions(l),s&&v.setLastConnectedSIWECaipNetwork(s),xe.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Rn.getSIWXEventProperties()})}catch(u){throw console.error("SIWX:universalProviderAuth - failed to set sessions",u),xe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Rn.getSIWXEventProperties(u)}),await t.disconnect().catch(console.error),u}finally{pt.hide()}}return!0},getSIWXEventProperties(t){const e=v.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:v.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:zt(e)===yt.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?se.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}};class Ev{constructor({provider:e,namespace:n}){this.id=$.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=v.getCaipNetworks.bind(v),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=K.state.universalProviderConfigOverride,s=bs.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return Rn.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:XF})}}const XF=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],Ms={getGasPriceInEther(t,e){const n=e*t;return Number(n)/1e18},getGasPriceInUSD(t,e,n){const r=Ms.getGasPriceInEther(e,n);return bt.bigNumber(t).times(r).toNumber()},getPriceImpact({sourceTokenAmount:t,sourceTokenPriceInUSD:e,toTokenPriceInUSD:n,toTokenAmount:r}){const s=bt.bigNumber(t).times(e),i=bt.bigNumber(r).times(n);return s.minus(i).div(s).times(100).toNumber()},getMaxSlippage(t,e){const n=bt.bigNumber(t).div(100);return bt.multiply(e,n).toNumber()},getProviderFee(t,e=.0085){return bt.bigNumber(t).times(e).toString()},isInsufficientNetworkTokenForGas(t,e){const n=e||"0";return bt.bigNumber(t).eq(0)?!0:bt.bigNumber(bt.bigNumber(n)).gt(t)},isInsufficientSourceTokenForSwap(t,e,n){const r=n?.find(i=>i.address===e)?.quantity?.numeric;return bt.bigNumber(r||"0").lt(t)}},pr=tt({message:"",variant:"info",open:!1}),QF={state:pr,subscribeKey(t,e){return It(pr,t,e)},open(t,e){const{debug:n}=K.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(pr.message=s,pr.variant=e,pr.open=!0)},warn(t,e,n){pr.open=!0,pr.message=t,pr.variant="warning",e&&console.warn(e,n)},close(){pr.open=!1,pr.message="",pr.variant="info"}},Et=Ln(QF),Rw=15e4,e9=6,ln={initializing:!1,initialized:!1,loadingPrices:!1,loadingQuote:!1,loadingApprovalTransaction:!1,loadingBuildTransaction:!1,loadingTransaction:!1,switchingTokens:!1,fetchError:!1,approvalTransaction:void 0,swapTransaction:void 0,transactionError:void 0,sourceToken:void 0,sourceTokenAmount:"",sourceTokenPriceInUSD:0,toToken:void 0,toTokenAmount:"",toTokenPriceInUSD:0,networkPrice:"0",networkBalanceInUSD:"0",networkTokenSymbol:"",inputError:void 0,slippage:Pe.CONVERT_SLIPPAGE_TOLERANCE,tokens:void 0,popularTokens:void 0,suggestedTokens:void 0,foundTokens:void 0,myTokensWithBalance:void 0,tokensPriceMap:{},gasFee:"0",gasPriceInUSD:0,priceImpact:void 0,maxSlippage:void 0,providerFee:void 0},j=tt({...ln}),Dl={state:j,subscribe(t){return xt(j,()=>t(j))},subscribeKey(t,e){return It(j,t,e)},getParams(){const t=v.state.activeChain,e=v.getAccountData(t)?.caipAddress??v.state.activeCaipAddress,n=se.getPlainAddress(e),r=cc(),s=te.getConnectorId(v.state.activeChain);if(!n)throw new Error("No address found to swap the tokens from.");const i=!j.toToken?.address||!j.toToken?.decimals,o=!j.sourceToken?.address||!j.sourceToken?.decimals||!bt.bigNumber(j.sourceTokenAmount).gt(0),a=!j.sourceTokenAmount;return{networkAddress:r,fromAddress:n,fromCaipAddress:e,sourceTokenAddress:j.sourceToken?.address,toTokenAddress:j.toToken?.address,toTokenAmount:j.toTokenAmount,toTokenDecimals:j.toToken?.decimals,sourceTokenAmount:j.sourceTokenAmount,sourceTokenDecimals:j.sourceToken?.decimals,invalidToToken:i,invalidSourceToken:o,invalidSourceTokenAmount:a,availableToSwap:e&&!i&&!o&&!a,isAuthConnector:s===$.CONNECTOR_ID.AUTH}},async setSourceToken(t){if(!t){j.sourceToken=t,j.sourceTokenAmount="",j.sourceTokenPriceInUSD=0;return}j.sourceToken=t,await Ne.setTokenPrice(t.address,"sourceToken")},setSourceTokenAmount(t){j.sourceTokenAmount=t},async setToToken(t){if(!t){j.toToken=t,j.toTokenAmount="",j.toTokenPriceInUSD=0;return}j.toToken=t,await Ne.setTokenPrice(t.address,"toToken")},setToTokenAmount(t){j.toTokenAmount=t?bt.toFixed(t,e9):""},async setTokenPrice(t,e){let n=j.tokensPriceMap[t]||0;n||(j.loadingPrices=!0,n=await Ne.getAddressPrice(t)),e==="sourceToken"?j.sourceTokenPriceInUSD=n:e==="toToken"&&(j.toTokenPriceInUSD=n),j.loadingPrices&&(j.loadingPrices=!1),Ne.getParams().availableToSwap&&!j.switchingTokens&&Ne.swapTokens()},async switchTokens(){if(!(j.initializing||!j.initialized||j.switchingTokens)){j.switchingTokens=!0;try{const t=j.toToken?{...j.toToken}:void 0,e=j.sourceToken?{...j.sourceToken}:void 0,n=t&&j.toTokenAmount===""?"1":j.toTokenAmount;Ne.setSourceTokenAmount(n),Ne.setToTokenAmount(""),await Ne.setSourceToken(t),await Ne.setToToken(e),j.switchingTokens=!1,Ne.swapTokens()}catch(t){throw j.switchingTokens=!1,t}}},resetState(){j.myTokensWithBalance=ln.myTokensWithBalance,j.tokensPriceMap=ln.tokensPriceMap,j.initialized=ln.initialized,j.initializing=ln.initializing,j.switchingTokens=ln.switchingTokens,j.sourceToken=ln.sourceToken,j.sourceTokenAmount=ln.sourceTokenAmount,j.sourceTokenPriceInUSD=ln.sourceTokenPriceInUSD,j.toToken=ln.toToken,j.toTokenAmount=ln.toTokenAmount,j.toTokenPriceInUSD=ln.toTokenPriceInUSD,j.networkPrice=ln.networkPrice,j.networkTokenSymbol=ln.networkTokenSymbol,j.networkBalanceInUSD=ln.networkBalanceInUSD,j.inputError=ln.inputError},resetValues(){const{networkAddress:t}=Ne.getParams(),e=j.tokens?.find(n=>n.address===t);Ne.setSourceToken(e),Ne.setToToken(void 0)},getApprovalLoadingState(){return j.loadingApprovalTransaction},clearError(){j.transactionError=void 0},async initializeState(){if(!j.initializing){if(j.initializing=!0,!j.initialized)try{await Ne.fetchTokens(),j.initialized=!0}catch{j.initialized=!1,pt.showError("Failed to initialize swap"),he.goBack()}j.initializing=!1}},async fetchTokens(){const{networkAddress:t}=Ne.getParams();await Ne.getNetworkTokenPrice(),await Ne.getMyTokensWithBalance();const e=j.myTokensWithBalance?.find(n=>n.address===t);e&&(j.networkTokenSymbol=e.symbol,Ne.setSourceToken(e),Ne.setSourceTokenAmount("0"))},async getTokenList(){const t=v.state.activeCaipNetwork?.caipNetworkId;if(!(j.caipNetworkId===t&&j.tokens))try{j.tokensLoading=!0;const e=await Eo.getTokenList(t);j.tokens=e,j.caipNetworkId=t,j.popularTokens=e.sort((o,a)=>o.symbol<a.symbol?-1:o.symbol>a.symbol?1:0);const r=(t&&Pe.SUGGESTED_TOKENS_BY_CHAIN?.[t]||[]).map(o=>e.find(a=>a.symbol===o)).filter(o=>!!o),i=(Pe.SWAP_SUGGESTED_TOKENS||[]).map(o=>e.find(a=>a.symbol===o)).filter(o=>!!o).filter(o=>!r.some(a=>a.address===o.address));j.suggestedTokens=[...r,...i]}catch{j.tokens=[],j.popularTokens=[],j.suggestedTokens=[]}finally{j.tokensLoading=!1}},async getAddressPrice(t){const e=j.tokensPriceMap[t];if(e)return e;const r=(await _e.fetchTokenPrice({addresses:[t]}))?.fungibles||[],i=[...j.tokens||[],...j.myTokensWithBalance||[]]?.find(c=>c.address===t)?.symbol,o=r.find(c=>c.symbol.toLowerCase()===i?.toLowerCase())?.price||0,a=parseFloat(o.toString());return j.tokensPriceMap[t]=a,a},async getNetworkTokenPrice(){const{networkAddress:t}=Ne.getParams(),n=(await _e.fetchTokenPrice({addresses:[t]}).catch(()=>(pt.showError("Failed to fetch network token price"),{fungibles:[]}))).fungibles?.[0],r=n?.price.toString()||"0";j.tokensPriceMap[t]=parseFloat(r),j.networkTokenSymbol=n?.symbol||"",j.networkPrice=r},async getMyTokensWithBalance(t){const e=await Su.getMyTokensWithBalance({forceUpdate:t,caipNetwork:v.state.activeCaipNetwork,address:v.getAccountData()?.address}),n=Eo.mapBalancesToSwapTokens(e);n&&(await Ne.getInitialGasPrice(),Ne.setBalances(n))},setBalances(t){const{networkAddress:e}=Ne.getParams(),n=v.state.activeCaipNetwork;if(!n)return;const r=t.find(s=>s.address===e);t.forEach(s=>{j.tokensPriceMap[s.address]=s.price||0}),j.myTokensWithBalance=t.filter(s=>s.address.startsWith(n.caipNetworkId)),j.networkBalanceInUSD=r?bt.multiply(r.quantity.numeric,r.price).toString():"0"},async getInitialGasPrice(){const t=await Eo.fetchGasPrice();if(!t)return{gasPrice:null,gasPriceInUSD:null};switch(v.state?.activeCaipNetwork?.chainNamespace){case $.CHAIN.SOLANA:return j.gasFee=t.standard??"0",j.gasPriceInUSD=bt.multiply(t.standard,j.networkPrice).div(1e9).toNumber(),{gasPrice:BigInt(j.gasFee),gasPriceInUSD:Number(j.gasPriceInUSD)};case $.CHAIN.EVM:default:const e=t.standard??"0",n=BigInt(e),r=BigInt(Rw),s=Ms.getGasPriceInUSD(j.networkPrice,r,n);return j.gasFee=e,j.gasPriceInUSD=s,{gasPrice:n,gasPriceInUSD:s}}},async swapTokens(){const t=v.getAccountData()?.address,e=j.sourceToken,n=j.toToken,r=bt.bigNumber(j.sourceTokenAmount).gt(0);if(r||Ne.setToTokenAmount(""),!n||!e||j.loadingPrices||!r||!t)return;j.loadingQuote=!0;const s=bt.bigNumber(j.sourceTokenAmount).times(10**e.decimals).round(0).toFixed(0);try{const i=await _e.fetchSwapQuote({userAddress:t,from:e.address,to:n.address,gasPrice:j.gasFee,amount:s.toString()});j.loadingQuote=!1;const o=i?.quotes?.[0]?.toAmount;if(!o){Et.open({displayMessage:"Incorrect amount",debugMessage:"Please enter a valid amount"},"error");return}const a=bt.bigNumber(o).div(10**n.decimals).toString();Ne.setToTokenAmount(a),Ne.hasInsufficientToken(j.sourceTokenAmount,e.address)?j.inputError="Insufficient balance":(j.inputError=void 0,Ne.setTransactionDetails())}catch(i){const o=await Eo.handleSwapError(i);j.loadingQuote=!1,j.inputError=o||"Insufficient balance"}},async getTransaction(){const{fromCaipAddress:t,availableToSwap:e}=Ne.getParams(),n=j.sourceToken,r=j.toToken;if(!(!t||!e||!n||!r||j.loadingQuote))try{j.loadingBuildTransaction=!0;const s=await Eo.fetchSwapAllowance({userAddress:t,tokenAddress:n.address,sourceTokenAmount:j.sourceTokenAmount,sourceTokenDecimals:n.decimals});let i;return s?i=await Ne.createSwapTransaction():i=await Ne.createAllowanceTransaction(),j.loadingBuildTransaction=!1,j.fetchError=!1,i}catch{he.goBack(),pt.showError("Failed to check allowance"),j.loadingBuildTransaction=!1,j.approvalTransaction=void 0,j.swapTransaction=void 0,j.fetchError=!0;return}},async createAllowanceTransaction(){const{fromCaipAddress:t,sourceTokenAddress:e,toTokenAddress:n}=Ne.getParams();if(!(!t||!n)){if(!e)throw new Error("createAllowanceTransaction - No source token address found.");try{const r=await _e.generateApproveCalldata({from:e,to:n,userAddress:t}),s=se.getPlainAddress(r.tx.from);if(!s)throw new Error("SwapController:createAllowanceTransaction - address is required");const i={data:r.tx.data,to:s,gasPrice:BigInt(r.tx.eip155.gasPrice),value:BigInt(r.tx.value),toAmount:j.toTokenAmount};return j.swapTransaction=void 0,j.approvalTransaction={data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount},{data:i.data,to:i.to,gasPrice:i.gasPrice,value:i.value,toAmount:i.toAmount}}catch{he.goBack(),pt.showError("Failed to create approval transaction"),j.approvalTransaction=void 0,j.swapTransaction=void 0,j.fetchError=!0;return}}},async createSwapTransaction(){const{networkAddress:t,fromCaipAddress:e,sourceTokenAmount:n}=Ne.getParams(),r=j.sourceToken,s=j.toToken;if(!e||!n||!r||!s)return;const i=re.parseUnits(n,r.decimals)?.toString();try{const o=await _e.generateSwapCalldata({userAddress:e,from:r.address,to:s.address,amount:i,disableEstimate:!0}),a=r.address===t,c=BigInt(o.tx.eip155.gas),l=BigInt(o.tx.eip155.gasPrice),u=se.getPlainAddress(o.tx.to);if(!u)throw new Error("SwapController:createSwapTransaction - address is required");const d={data:o.tx.data,to:u,gas:c,gasPrice:l,value:BigInt(a?i??"0":"0"),toAmount:j.toTokenAmount};return j.gasPriceInUSD=Ms.getGasPriceInUSD(j.networkPrice,c,l),j.approvalTransaction=void 0,j.swapTransaction=d,d}catch{he.goBack(),pt.showError("Failed to create transaction"),j.approvalTransaction=void 0,j.swapTransaction=void 0,j.fetchError=!0;return}},onEmbeddedWalletApprovalSuccess(){pt.showLoading("Approve limit increase in your wallet"),he.replace("SwapPreview")},async sendTransactionForApproval(t){const{fromAddress:e,isAuthConnector:n}=Ne.getParams();j.loadingApprovalTransaction=!0,n?he.pushTransactionStack({onSuccess:Ne.onEmbeddedWalletApprovalSuccess}):pt.showLoading("Approve limit increase in your wallet");try{await re.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:$.CHAIN.EVM}),await Ne.swapTokens(),await Ne.getTransaction(),j.approvalTransaction=void 0,j.loadingApprovalTransaction=!1}catch(s){const i=s;j.transactionError=i?.displayMessage,j.loadingApprovalTransaction=!1,pt.showError(i?.displayMessage||"Transaction error"),xe.sendEvent({type:"track",event:"SWAP_APPROVAL_ERROR",properties:{message:i?.displayMessage||i?.message||"Unknown",network:v.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:Ne.state.sourceToken?.symbol||"",swapToToken:Ne.state.toToken?.symbol||"",swapFromAmount:Ne.state.sourceTokenAmount||"",swapToAmount:Ne.state.toTokenAmount||"",isSmartAccount:zt($.CHAIN.EVM)===yt.ACCOUNT_TYPES.SMART_ACCOUNT}})}},async sendTransactionForSwap(t){if(!t)return;const{fromAddress:e,toTokenAmount:n,isAuthConnector:r}=Ne.getParams();j.loadingTransaction=!0;const s=`Swapping ${j.sourceToken?.symbol} to ${bt.formatNumberToLocalString(n,3)} ${j.toToken?.symbol}`,i=`Swapped ${j.sourceToken?.symbol} to ${bt.formatNumberToLocalString(n,3)} ${j.toToken?.symbol}`;r?he.pushTransactionStack({onSuccess(){he.replace("Account"),pt.showLoading(s),Dl.resetState()}}):pt.showLoading("Confirm transaction in your wallet");try{const o=[j.sourceToken?.address,j.toToken?.address].join(","),a=await re.sendTransaction({address:e,to:t.to,data:t.data,value:t.value,chainNamespace:$.CHAIN.EVM});return j.loadingTransaction=!1,pt.showSuccess(i),xe.sendEvent({type:"track",event:"SWAP_SUCCESS",properties:{network:v.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:Ne.state.sourceToken?.symbol||"",swapToToken:Ne.state.toToken?.symbol||"",swapFromAmount:Ne.state.sourceTokenAmount||"",swapToAmount:Ne.state.toTokenAmount||"",isSmartAccount:zt($.CHAIN.EVM)===yt.ACCOUNT_TYPES.SMART_ACCOUNT}}),Dl.resetState(),r||he.replace("Account"),Dl.getMyTokensWithBalance(o),a}catch(o){const a=o;j.transactionError=a?.displayMessage,j.loadingTransaction=!1,pt.showError(a?.displayMessage||"Transaction error"),xe.sendEvent({type:"track",event:"SWAP_ERROR",properties:{message:a?.displayMessage||a?.message||"Unknown",network:v.state.activeCaipNetwork?.caipNetworkId||"",swapFromToken:Ne.state.sourceToken?.symbol||"",swapToToken:Ne.state.toToken?.symbol||"",swapFromAmount:Ne.state.sourceTokenAmount||"",swapToAmount:Ne.state.toTokenAmount||"",isSmartAccount:zt($.CHAIN.EVM)===yt.ACCOUNT_TYPES.SMART_ACCOUNT}});return}},hasInsufficientToken(t,e){return Ms.isInsufficientSourceTokenForSwap(t,e,j.myTokensWithBalance)},setTransactionDetails(){const{toTokenAddress:t,toTokenDecimals:e}=Ne.getParams();!t||!e||(j.gasPriceInUSD=Ms.getGasPriceInUSD(j.networkPrice,BigInt(j.gasFee),BigInt(Rw)),j.priceImpact=Ms.getPriceImpact({sourceTokenAmount:j.sourceTokenAmount,sourceTokenPriceInUSD:j.sourceTokenPriceInUSD,toTokenPriceInUSD:j.toTokenPriceInUSD,toTokenAmount:j.toTokenAmount}),j.maxSlippage=Ms.getMaxSlippage(j.slippage,j.toTokenAmount),j.providerFee=Ms.getProviderFee(j.sourceTokenAmount))}},Ne=Ln(Dl),gr=tt({message:"",open:!1,triggerRect:{width:0,height:0,top:0,left:0},variant:"shade"}),t9={state:gr,subscribe(t){return xt(gr,()=>t(gr))},subscribeKey(t,e){return It(gr,t,e)},showTooltip({message:t,triggerRect:e,variant:n}){gr.open=!0,gr.message=t,gr.triggerRect=e,gr.variant=n},hide(){gr.open=!1,gr.message="",gr.triggerRect={width:0,height:0,top:0,left:0}}},Rj=Ln(t9),ya=tt({isLegalCheckboxChecked:!1}),kj={state:ya,subscribe(t){return xt(ya,()=>t(ya))},subscribeKey(t,e){return It(ya,t,e)},setIsLegalCheckboxChecked(t){ya.isLegalCheckboxChecked=t}},n9={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class r9 extends Error{}function s9(){const{sdkType:t,sdkVersion:e,projectId:n}=K.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function Up(t,e){const n=s9(),{projectId:r}=K.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new r9(o.error.message);return o}async function i9(t){return(await Up("reown_getExchanges",t)).result}async function o9(t){return(await Up("reown_getExchangePayUrl",t)).result}async function a9(t){return(await Up("reown_getExchangeBuyStatus",t)).result}function kw(t,e){const{chainNamespace:n,chainId:r}=Lt.parseCaipNetworkId(t),s=n9[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const c9={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},l9={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},bv={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},u9={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},d9={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},h9={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},f9={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},p9={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},g9={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},m9={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},y9={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},w9={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},E9={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},b9={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},C9={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},v9={ethereumETH:c9,baseETH:l9,baseUSDC:bv,baseSepoliaETH:d9,ethereumUSDC:h9,arbitrumUSDC:f9,polygonUSDC:p9,solanaUSDC:g9,ethereumUSDT:m9,optimismUSDT:y9,arbitrumUSDT:w9,polygonUSDT:E9,solanaUSDT:b9,solanaSOL:C9};function _9(t){return Object.values(v9).filter(e=>e.network===t)}const A9=0,Cv={paymentAsset:null,amount:null,tokenAmount:0,priceLoading:!1,error:null,exchanges:[],isLoading:!1,currentPayment:void 0,isPaymentInProgress:!1,paymentId:"",assets:[]},Se=tt(Cv),wi={state:Se,subscribe(t){return xt(Se,()=>t(Se))},subscribeKey(t,e){return It(Se,t,e)},resetState(){Object.assign(Se,{...Cv})},async getAssetsForNetwork(t){const e=_9(t),n=await wi.getAssetsImageAndPrice(e),r=e.map(s=>{const i=s.asset==="native"?cc():`${s.network}:${s.asset}`,o=n.find(a=>a.fungibles?.[0]?.address?.toLowerCase()===i.toLowerCase());return{...s,price:o?.fungibles?.[0]?.price||1,metadata:{...s.metadata,iconUrl:o?.fungibles?.[0]?.iconUrl}}});return Se.assets=r,r},async getAssetsImageAndPrice(t){const e=t.map(r=>r.asset==="native"?cc():`${r.network}:${r.asset}`);return await Promise.all(e.map(r=>_e.fetchTokenPrice({addresses:[r]})))},getTokenAmount(){if(!Se?.paymentAsset?.price)throw new Error("Cannot get token price");const t=bt.bigNumber(Se.amount??0).round(8),e=bt.bigNumber(Se.paymentAsset.price).round(8);return t.div(e).round(8).toNumber()},setAmount(t){Se.amount=t,Se.paymentAsset?.price&&(Se.tokenAmount=wi.getTokenAmount())},setPaymentAsset(t){Se.paymentAsset=t},isPayWithExchangeEnabled(){return K.state.remoteFeatures?.payWithExchange},isPayWithExchangeSupported(){return wi.isPayWithExchangeEnabled()&&v.state.activeCaipNetwork&&Pe.PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES.includes(v.state.activeCaipNetwork.chainNamespace)},async fetchExchanges(){try{const t=wi.isPayWithExchangeSupported();if(!Se.paymentAsset||!t){Se.exchanges=[],Se.isLoading=!1;return}Se.isLoading=!0;const e=await i9({page:A9,asset:kw(Se.paymentAsset.network,Se.paymentAsset.asset),amount:Se.amount?.toString()??"0"});Se.exchanges=e.exchanges.slice(0,2)}catch{throw pt.showError("Unable to get exchanges"),new Error("Unable to get exchanges")}finally{Se.isLoading=!1}},async getPayUrl(t,e){try{const n=Number(e.amount),r=await o9({exchangeId:t,asset:kw(e.network,e.asset),amount:n.toString(),recipient:`${e.network}:${e.recipient}`});return xe.sendEvent({type:"track",event:"PAY_EXCHANGE_SELECTED",properties:{exchange:{id:t},configuration:{network:e.network,asset:e.asset,recipient:e.recipient,amount:n},currentPayment:{type:"exchange",exchangeId:t},source:"fund-from-exchange",headless:!1}}),r}catch(n){throw n instanceof Error&&n.message.includes("is not supported")?new Error("Asset not supported"):new Error(n.message)}},async handlePayWithExchange(t){try{const e=v.getAccountData()?.address;if(!e)throw new Error("No account connected");if(!Se.paymentAsset)throw new Error("No payment asset selected");const n=se.returnOpenHref("","popupWindow","scrollbar=yes,width=480,height=720");if(!n)throw new Error("Could not create popup window");Se.isPaymentInProgress=!0,Se.paymentId=crypto.randomUUID(),Se.currentPayment={type:"exchange",exchangeId:t};const{network:r,asset:s}=Se.paymentAsset,i={network:r,asset:s,amount:Se.tokenAmount,recipient:e},o=await wi.getPayUrl(t,i);if(!o){try{n.close()}catch(a){console.error("Unable to close popup window",a)}throw new Error("Unable to initiate payment")}Se.currentPayment.sessionId=o.sessionId,Se.currentPayment.status="IN_PROGRESS",Se.currentPayment.exchangeId=t,n.location.href=o.url}catch{Se.error="Unable to initiate payment",pt.showError(Se.error)}},async waitUntilComplete({exchangeId:t,sessionId:e,paymentId:n,retries:r=20}){const s=await wi.getBuyStatus(t,e,n);if(s.status==="SUCCESS"||s.status==="FAILED")return s;if(r===0)throw new Error("Unable to get deposit status");return await new Promise(i=>{setTimeout(i,5e3)}),wi.waitUntilComplete({exchangeId:t,sessionId:e,paymentId:n,retries:r-1})},async getBuyStatus(t,e,n){try{if(!Se.currentPayment)throw new Error("No current payment");const r=await a9({sessionId:e,exchangeId:t});if(Se.currentPayment.status=r.status,r.status==="SUCCESS"||r.status==="FAILED"){const s=v.getAccountData()?.address;Se.currentPayment.result=r.txHash,Se.isPaymentInProgress=!1,xe.sendEvent({type:"track",event:r.status==="SUCCESS"?"PAY_SUCCESS":"PAY_ERROR",properties:{message:r.status==="FAILED"?se.parseError(Se.error):void 0,source:"fund-from-exchange",paymentId:n,configuration:{network:Se.paymentAsset?.network||"",asset:Se.paymentAsset?.asset||"",recipient:s||"",amount:Se.amount??0},currentPayment:{type:"exchange",exchangeId:Se.currentPayment?.exchangeId,sessionId:Se.currentPayment?.sessionId,result:r.txHash}}})}return r}catch{return{status:"UNKNOWN",txHash:""}}},reset(){Se.currentPayment=void 0,Se.isPaymentInProgress=!1,Se.paymentId="",Se.paymentAsset=null,Se.amount=0,Se.tokenAmount=0,Se.priceLoading=!1,Se.error=null,Se.exchanges=[],Se.isLoading=!1}},Pj={isUnsupportedChainView(){return he.state.view==="UnsupportedChain"||he.state.view==="SwitchNetwork"&&he.state.history.includes("UnsupportedChain")},async safeClose(){if(this.isUnsupportedChainView()){$e.shake();return}if(await Rn.isSIWXCloseDisabled()){$e.shake();return}(he.state.view==="DataCapture"||he.state.view==="DataCaptureOtpConfirm")&&re.disconnect(),$e.close()}},mn={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:$.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},S9={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700","-239":"20f673c0-095e-49b2-07cf-eb5049dcf600","-3":"20f673c0-095e-49b2-07cf-eb5049dcf600"}},ps={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${mn.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const t=v.state.activeChain;return $.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>te.getConnectorId(e)===$.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return $.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?$.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=J.getConnections()[e]??[];return{hasDisconnected:J.isConnectorDisconnected(t,e),hasConnected:r.some(s=>ps.isLowerCaseMatch(s.connectorId,t))}}},I9=new AbortController,mt={EmbeddedWalletAbortController:I9,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${Sa()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com. [PID: ${K.state.projectId}]`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},vv={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:bv.asset,84532:u9.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(vv.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},T9={createLogger(t,e="error"){const n=Hf({level:e}),{logger:r}=Au({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},N9="rpc.walletconnect.org";function Pw(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const dh=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Fr={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===N9}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:$.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${$.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){const r=t.rpcUrls?.default?.http?.[0];return dh.includes(e)?Pw(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=t.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(t,i,n),c=t?.rpcUrls?.chainDefault?.http?.[0]||o,l=r?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:S9.NetworkImageIds[t.id],imageUrl:e?.[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>Fr.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){const r=[];return n?.forEach(s=>{r.push(Wc(s.url,s.config))}),dh.includes(t.caipNetworkId)&&r.push(Wc(Pw(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),t?.rpcUrls?.default?.http?.forEach(s=>{r.push(Wc(s))}),Fp(r)},extendWagmiTransports(t,e,n){if(dh.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return Fp([n,Wc(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:$.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){const e=J.getActiveCaipNetworkId(),n=v.getAllRequestedCaipNetworks(),r=Array.from(v.state.chains?.keys()||[]),s=e?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||n?.[0]}};class Ui{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){const{metadata:c,sdkVersion:l,sdkType:u}=K.getSnapshot();return Ui.instance||(Ui.instance=new pI({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!K.state.remoteFeatures?.emailCapture,metadata:c,sdkVersion:l,sdkType:u})),Ui.instance}}const Dj={interpolate(t,e,n){if(t.length!==2||e.length!==2)throw new Error("inputRange and outputRange must be an array of length 2");const r=t[0]||0,s=t[1]||0,i=e[0]||0,o=e[1]||0;return n<r?i:n>s?o:(o-i)/(s-r)*(n-r)+i}};const Ul=globalThis,$p=Ul.ShadowRoot&&(Ul.ShadyCSS===void 0||Ul.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Bp=Symbol(),Dw=new WeakMap;let _v=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==Bp)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if($p&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=Dw.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Dw.set(n,e))}return e}toString(){return this.cssText}};const wr=t=>new _v(typeof t=="string"?t:t+"",void 0,Bp),Ks=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new _v(n,t,Bp)},x9=(t,e)=>{if($p)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=Ul.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},Uw=$p?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return wr(n)})(t):t;const{is:O9,defineProperty:R9,getOwnPropertyDescriptor:k9,getOwnPropertyNames:P9,getOwnPropertySymbols:D9,getPrototypeOf:U9}=Object,ti=globalThis,$w=ti.trustedTypes,$9=$w?$w.emptyScript:"",B9=ti.reactiveElementPolyfillSupport,ja=(t,e)=>t,xf={toAttribute(t,e){switch(e){case Boolean:t=t?$9:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},Av=(t,e)=>!O9(t,e),Bw={attribute:!0,type:String,converter:xf,reflect:!1,useDefault:!1,hasChanged:Av};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ti.litPropertyMetadata??(ti.litPropertyMetadata=new WeakMap);let bo=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=Bw){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&R9(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=k9(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Bw}static _$Ei(){if(this.hasOwnProperty(ja("elementProperties")))return;const e=U9(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(ja("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(ja("properties"))){const n=this.properties,r=[...P9(n),...D9(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(Uw(s))}else e!==void 0&&n.push(Uw(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return x9(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:xf).toAttribute(n,r.type);this._$Em=e,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(e,n){const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:xf;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,n,r,s=!1,i){if(e!==void 0){const o=this.constructor;if(s===!1&&(i=this[e]),r??(r=o.getPropertyOptions(e)),!((r.hasChanged??Av)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};bo.elementStyles=[],bo.shadowRootOptions={mode:"open"},bo[ja("elementProperties")]=new Map,bo[ja("finalized")]=new Map,B9?.({ReactiveElement:bo}),(ti.reactiveElementVersions??(ti.reactiveElementVersions=[])).push("2.1.2");const Wa=globalThis,Lw=t=>t,pu=Wa.trustedTypes,Mw=pu?pu.createPolicy("lit-html",{createHTML:t=>t}):void 0,Sv="$lit$",Gs=`lit$${Math.random().toFixed(9).slice(2)}$`,Iv="?"+Gs,L9=`<${Iv}>`,Ki=document,wc=()=>Ki.createComment(""),Ec=t=>t===null||typeof t!="object"&&typeof t!="function",Lp=Array.isArray,M9=t=>Lp(t)||typeof t?.[Symbol.iterator]=="function",hh=`[ 	
\f\r]`,wa=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Fw=/-->/g,jw=/>/g,Ei=RegExp(`>|${hh}(?:([^\\s"'>=/]+)(${hh}*=${hh}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ww=/'/g,Hw=/"/g,Tv=/^(?:script|style|textarea|title)$/i,Nv=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),Bj=Nv(1),Lj=Nv(2),Ho=Symbol.for("lit-noChange"),qt=Symbol.for("lit-nothing"),qw=new WeakMap,Ri=Ki.createTreeWalker(Ki,129);function xv(t,e){if(!Lp(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Mw!==void 0?Mw.createHTML(e):e}const F9=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=wa;for(let a=0;a<n;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===wa?u[1]==="!--"?o=Fw:u[1]!==void 0?o=jw:u[2]!==void 0?(Tv.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Ei):u[3]!==void 0&&(o=Ei):o===Ei?u[0]===">"?(o=s??wa,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Ei:u[3]==='"'?Hw:Ww):o===Hw||o===Ww?o=Ei:o===Fw||o===jw?o=wa:(o=Ei,s=void 0);const p=o===Ei&&t[a+1].startsWith("/>")?" ":"";i+=o===wa?c+L9:d>=0?(r.push(l),c.slice(0,d)+Sv+c.slice(d)+Gs+p):c+Gs+(d===-2?a:p)}return[xv(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class bc{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=F9(e,n);if(this.el=bc.createElement(l,r),Ri.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Ri.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(Sv)){const h=u[o++],p=s.getAttribute(d).split(Gs),m=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:m[2],strings:p,ctor:m[1]==="."?W9:m[1]==="?"?H9:m[1]==="@"?q9:Yu}),s.removeAttribute(d)}else d.startsWith(Gs)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(Tv.test(s.tagName)){const d=s.textContent.split(Gs),h=d.length-1;if(h>0){s.textContent=pu?pu.emptyScript:"";for(let p=0;p<h;p++)s.append(d[p],wc()),Ri.nextNode(),c.push({type:2,index:++i});s.append(d[h],wc())}}}else if(s.nodeType===8)if(s.data===Iv)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Gs,d+1))!==-1;)c.push({type:7,index:i}),d+=Gs.length-1}i++}}static createElement(e,n){const r=Ki.createElement("template");return r.innerHTML=e,r}}function qo(t,e,n=t,r){if(e===Ho)return e;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=Ec(e)?void 0:e._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??(n._$Co=[]))[r]=s:n._$Cl=s),s!==void 0&&(e=qo(t,s._$AS(t,e.values),s,r)),e}class j9{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=(e?.creationScope??Ki).importNode(n,!0);Ri.currentNode=s;let i=Ri.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new Bc(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new z9(i,this,e)),this._$AV.push(l),c=r[++a]}o!==c?.index&&(i=Ri.nextNode(),o++)}return Ri.currentNode=Ki,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class Bc{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=qt,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=qo(this,e,n),Ec(e)?e===qt||e==null||e===""?(this._$AH!==qt&&this._$AR(),this._$AH=qt):e!==this._$AH&&e!==Ho&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):M9(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==qt&&Ec(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ki.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=bc.createElement(xv(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new j9(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(e){let n=qw.get(e.strings);return n===void 0&&qw.set(e.strings,n=new bc(e)),n}k(e){Lp(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new Bc(this.O(wc()),this.O(wc()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=Lw(e).nextSibling;Lw(e).remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class Yu{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=qt,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=qt}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=qo(this,e,n,0),o=!Ec(e)||e!==this._$AH&&e!==Ho,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=qo(this,a[r+c],n,c),l===Ho&&(l=this._$AH[c]),o||(o=!Ec(l)||l!==this._$AH[c]),l===qt?e=qt:e!==qt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===qt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class W9 extends Yu{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===qt?void 0:e}}class H9 extends Yu{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==qt)}}class q9 extends Yu{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=qo(this,e,n,0)??qt)===Ho)return;const r=this._$AH,s=e===qt&&r!==qt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==qt&&(r===qt||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class z9{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){qo(this,e)}}const V9=Wa.litHtmlPolyfillSupport;V9?.(bc,Bc),(Wa.litHtmlVersions??(Wa.litHtmlVersions=[])).push("3.3.2");const K9=(t,e,n)=>{const r=n?.renderBefore??e;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new Bc(e.insertBefore(wc(),i),i,void 0,n??{})}return s._$AI(t),s};const Ha=globalThis;class $l extends bo{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var n;const e=super.createRenderRoot();return(n=this.renderOptions).renderBefore??(n.renderBefore=e.firstChild),e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=K9(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Ho}}$l._$litElement$=!0,$l.finalized=!0,Ha.litElementHydrateSupport?.({LitElement:$l});const G9=Ha.litElementPolyfillSupport;G9?.({LitElement:$l});(Ha.litElementVersions??(Ha.litElementVersions=[])).push("4.2.2");const Y9={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},gu={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},Z9={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},J9={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},X9={regular:"KHTeka",mono:"KHTekaMono"},Q9={regular:"400",medium:"500"},e7={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},t7={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},n7={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},r7={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},Of={colors:Y9,fontFamily:X9,fontWeight:Q9,textSize:e7,typography:t7,tokens:{core:gu.core,theme:gu.dark},borderRadius:Z9,spacing:J9,durations:r7,easings:n7},zw="--apkt";function ml(t){if(!t)return{};const e={};return e["font-family"]=t["--apkt-font-family"]??t["--w3m-font-family"]??"KHTeka",e.accent=t["--apkt-accent"]??t["--w3m-accent"]??"#0988F0",e["color-mix"]=t["--apkt-color-mix"]??t["--w3m-color-mix"]??"#000",e["color-mix-strength"]=t["--apkt-color-mix-strength"]??t["--w3m-color-mix-strength"]??0,e["font-size-master"]=t["--apkt-font-size-master"]??t["--w3m-font-size-master"]??"10px",e["border-radius-master"]=t["--apkt-border-radius-master"]??t["--w3m-border-radius-master"]??"4px",t["--apkt-z-index"]!==void 0?e["z-index"]=t["--apkt-z-index"]:t["--w3m-z-index"]!==void 0&&(e["z-index"]=t["--w3m-z-index"]),e}const cs={createCSSVariables(t){const e={},n={};function r(i,o,a=""){for(const[c,l]of Object.entries(i)){const u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},r(l,o[c],u)):typeof l=="string"&&(o[c]=`${zw}-${u}`)}}function s(i,o){for(const[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},s(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[a,c]of Object.entries(s)){const l=o?`${o}-${a}`:a,u=i[a];c&&typeof c=="object"?r(c,u,l):typeof u=="string"&&(n[`${zw}-${l}`]=u)}}return r(t,e),n},createRootStyles(t,e){const n={...Of,tokens:{...Of.tokens,theme:t==="light"?gu.light:gu.dark}},{cssVariables:r}=cs.createCSSVariables(n),s=cs.assignCSSVariables(r,n),i=cs.generateW3MVariables(e),o=cs.generateW3MOverrides(e),a=cs.generateScaledVariables(e),c=cs.generateBaseVariables(s),l={...s,...c,...i,...o,...a},u=cs.applyColorMixToVariables(e,l),d={...l,...u};return`:root {${Object.entries(d).map(([p,m])=>`${p}:${m.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e=ml(t),n={};return n["--w3m-font-family"]=e["font-family"],n["--w3m-accent"]=e.accent,n["--w3m-color-mix"]=e["color-mix"],n["--w3m-color-mix-strength"]=`${e["color-mix-strength"]}%`,n["--w3m-font-size-master"]=e["font-size-master"],n["--w3m-border-radius-master"]=e["border-radius-master"],n},generateW3MOverrides(t){if(!t)return{};const e=ml(t),n={};if(t["--apkt-accent"]||t["--w3m-accent"]){const r=e.accent;n["--apkt-tokens-core-iconAccentPrimary"]=r,n["--apkt-tokens-core-borderAccentPrimary"]=r,n["--apkt-tokens-core-textAccentPrimary"]=r,n["--apkt-tokens-core-backgroundAccentPrimary"]=r}return(t["--apkt-font-family"]||t["--w3m-font-family"])&&(n["--apkt-fontFamily-regular"]=e["font-family"]),e["z-index"]!==void 0&&(n["--apkt-tokens-core-zIndex"]=`${e["z-index"]}`),n},generateScaledVariables(t){if(!t)return{};const e=ml(t),n={};if(t["--apkt-font-size-master"]||t["--w3m-font-size-master"]){const r=parseFloat(e["font-size-master"].replace("px",""));n["--apkt-textSize-h1"]=`${Number(r)*5}px`,n["--apkt-textSize-h2"]=`${Number(r)*4.4}px`,n["--apkt-textSize-h3"]=`${Number(r)*3.8}px`,n["--apkt-textSize-h4"]=`${Number(r)*3.2}px`,n["--apkt-textSize-h5"]=`${Number(r)*2.6}px`,n["--apkt-textSize-h6"]=`${Number(r)*2}px`,n["--apkt-textSize-large"]=`${Number(r)*1.6}px`,n["--apkt-textSize-medium"]=`${Number(r)*1.4}px`,n["--apkt-textSize-small"]=`${Number(r)*1.2}px`}if(t["--apkt-border-radius-master"]||t["--w3m-border-radius-master"]){const r=parseFloat(e["border-radius-master"].replace("px",""));n["--apkt-borderRadius-1"]=`${Number(r)}px`,n["--apkt-borderRadius-2"]=`${Number(r)*2}px`,n["--apkt-borderRadius-3"]=`${Number(r)*3}px`,n["--apkt-borderRadius-4"]=`${Number(r)*4}px`,n["--apkt-borderRadius-5"]=`${Number(r)*5}px`,n["--apkt-borderRadius-6"]=`${Number(r)*6}px`,n["--apkt-borderRadius-8"]=`${Number(r)*8}px`,n["--apkt-borderRadius-16"]=`${Number(r)*16}px`,n["--apkt-borderRadius-20"]=`${Number(r)*20}px`,n["--apkt-borderRadius-32"]=`${Number(r)*32}px`,n["--apkt-borderRadius-64"]=`${Number(r)*64}px`,n["--apkt-borderRadius-128"]=`${Number(r)*128}px`}return n},generateColorMixCSS(t,e){if(!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=e?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${a});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};e?.["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)");const r=ml(t),s=r["color-mix"],i=r["color-mix-strength"];if(!i||i===0)return n;const o=Object.keys(e||{}).filter(a=>{const c=a.includes("-tokens-core-background")||a.includes("-tokens-core-text")||a.includes("-tokens-core-border")||a.includes("-tokens-core-foreground")||a.includes("-tokens-core-icon")||a.includes("-tokens-theme-background")||a.includes("-tokens-theme-text")||a.includes("-tokens-theme-border")||a.includes("-tokens-theme-foreground")||a.includes("-tokens-theme-icon")||a.includes("-tokens-theme-overlay"),l=a.includes("-borderRadius-")||a.includes("-spacing-")||a.includes("-textSize-")||a.includes("-fontFamily-")||a.includes("-fontWeight-")||a.includes("-typography-")||a.includes("-duration-")||a.includes("-ease-")||a.includes("-path-")||a.includes("-width-")||a.includes("-height-")||a.includes("-visual-size-")||a.includes("-modal-width")||a.includes("-cover");return c&&!l});return o.length===0||o.forEach(a=>{const c=e?.[a]||"";a.endsWith("-base")||(a==="--apkt-tokens-theme-backgroundPrimary"||a==="--apkt-tokens-core-backgroundAccentPrimary"?n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base))`:c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?n[a]=`color-mix(in srgb, ${s} ${i}%, ${c})`:n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base, ${c}))`)}),n}},{cssVariablesVarPrefix:s7}=cs.createCSSVariables(Of);function Mj(t,...e){return Ks(t,...e.map(n=>wr(typeof n=="function"?n(s7):n)))}let Si,ki,Wr,Cr,mu;const os={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function yu(t,e="dark"){Si&&document.head.removeChild(Si),Si=document.createElement("style"),Si.textContent=cs.createRootStyles(e,t),document.head.appendChild(Si)}function Fj(t,e="dark"){if(mu=t,ki=document.createElement("style"),Wr=document.createElement("style"),Cr=document.createElement("style"),ki.textContent=Uo(t).core.cssText,Wr.textContent=Uo(t).dark.cssText,Cr.textContent=Uo(t).light.cssText,document.head.appendChild(ki),document.head.appendChild(Wr),document.head.appendChild(Cr),yu(t,e),Rf(e),!(t?.["--apkt-font-family"]||t?.["--w3m-font-family"]))for(const[r,s]of Object.entries(os)){const i=document.createElement("link");i.rel="preload",i.href=s,i.as="font",i.type=r.includes("woff2")?"font/woff2":"font/woff",i.crossOrigin="anonymous",document.head.appendChild(i)}Rf(e)}function Rf(t="dark"){Wr&&Cr&&Si&&(t==="light"?(yu(mu,t),Wr.removeAttribute("media"),Cr.media="enabled"):(yu(mu,t),Cr.removeAttribute("media"),Wr.media="enabled"))}function i7(t){if(mu=t,ki&&Wr&&Cr){ki.textContent=Uo(t).core.cssText,Wr.textContent=Uo(t).dark.cssText,Cr.textContent=Uo(t).light.cssText;const e=t?.["--apkt-font-family"]||t?.["--w3m-font-family"];e&&(ki.textContent=ki.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),Wr.textContent=Wr.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),Cr.textContent=Cr.textContent?.replace("font-family: KHTeka",`font-family: ${e}`))}if(Si){const e=Cr?.media==="enabled"?"light":"dark";yu(t,e)}}function Uo(t){const e=!!(t?.["--apkt-font-family"]||t?.["--w3m-font-family"]);return{core:Ks`
      ${e?Ks``:Ks`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${wr(os["KHTeka-400-woff2"])}) format('woff2'),
                url(${wr(os["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${wr(os["KHTeka-300-woff2"])}) format('woff2'),
                url(${wr(os["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${wr(os["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${wr(os["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${wr(os["KHTeka-400-woff2"])}) format('woff2'),
                url(${wr(os["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:Ks`
      :root {
      }
    `,light:Ks`
      :root {
      }
    `}}const jj=Ks`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,Wj=Ks`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,yl=".",Vw={getSpacingStyles(t,e){if(Array.isArray(t))return t[e]?`var(--apkt-spacing-${t[e]})`:void 0;if(typeof t=="string")return`var(--apkt-spacing-${t})`},getFormattedDate(t){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(t)},formatCurrency(t=0,e={}){const n=Number(t);return isNaN(n)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2,...e}).format(n)},getHostName(t){try{return new URL(t).hostname}catch{return""}},getTruncateString({string:t,charsStart:e,charsEnd:n,truncate:r}){return t.length<=e+n?t:r==="end"?`${t.substring(0,e)}...`:r==="start"?`...${t.substring(t.length-n)}`:`${t.substring(0,Math.floor(e))}...${t.substring(t.length-Math.floor(n))}`},generateAvatarColors(t){const n=t.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),r=this.hexToRgb(n),s=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),o=100-3*Number(s?.replace("px","")),a=`${o}% ${o}% at 65% 40%`,c=[];for(let l=0;l<5;l+=1){const u=this.tintColor(r,.15*l);c.push(`rgb(${u[0]}, ${u[1]}, ${u[2]})`)}return`
    --local-color-1: ${c[0]};
    --local-color-2: ${c[1]};
    --local-color-3: ${c[2]};
    --local-color-4: ${c[3]};
    --local-color-5: ${c[4]};
    --local-radial-circle: ${a}
   `},hexToRgb(t){const e=parseInt(t,16),n=e>>16&255,r=e>>8&255,s=e&255;return[n,r,s]},tintColor(t,e){const[n,r,s]=t,i=Math.round(n+(255-n)*e),o=Math.round(r+(255-r)*e),a=Math.round(s+(255-s)*e);return[i,o,a]},isNumber(t){return{number:/^[0-9]+$/u}.number.test(t)},getColorTheme(t){return t||(typeof window<"u"&&window.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark")},splitBalance(t){const e=t.split(".");return e.length===2?[e[0],e[1]]:["0","00"]},roundNumber(t,e,n){return t.toString().length>=e?Number(t).toFixed(n):t},cssDurationToNumber(t){return t.endsWith("s")?Number(t.replace("s",""))*1e3:t.endsWith("ms")?Number(t.replace("ms","")):0},maskInput({value:t,decimals:e,integers:n}){if(t=t.replace(",","."),t===yl)return`0${yl}`;const[r="",s]=t.split(yl).map(u=>u.replace(/[^0-9]/gu,"")),i=n?r.substring(0,n):r,o=i.length===2?String(Number(i)):i,a=typeof e=="number"?s?.substring(0,e):s,c=typeof e!="number"||e>0;return(typeof a=="string"&&c?[o,a].join(yl):o)??""},capitalize(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}},o7=3,wl=.1,a7=["receive","deposit","borrow","claim"],c7=["withdraw","repay","burn"],Kw={getTransactionGroupTitle(t,e){const n=Yp.getYear(),r=Yp.getMonthNameByIndex(e);return t===n?r:`${r} ${t}`},getTransactionImages(t){const[e]=t;return t?.length>1?t.map(r=>this.getTransactionImage(r)):[this.getTransactionImage(e)]},getTransactionImage(t){return{type:Kw.getTransactionTransferTokenType(t),url:Kw.getTransactionImageURL(t)}},getTransactionImageURL(t){let e;const n=!!t?.nft_info,r=!!t?.fungible_info;return t&&n?e=t?.nft_info?.content?.preview?.url:t&&r&&(e=t?.fungible_info?.icon?.url),e},getTransactionTransferTokenType(t){if(t?.fungible_info)return"FUNGIBLE";if(t?.nft_info)return"NFT"},getTransactionDescriptions(t,e){const n=t?.metadata?.operationType,r=e||t?.transfers,s=r&&r.length>0,i=r&&r.length>1,o=s&&r.every(h=>!!h?.fungible_info),[a,c]=r||[];let l=this.getTransferDescription(a),u=this.getTransferDescription(c);if(!s)return(n==="send"||n==="receive")&&o?(l=Vw.getTruncateString({string:t?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),u=Vw.getTruncateString({string:t?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[l,u]):[t.metadata.status];if(i)return r?.map(h=>this.getTransferDescription(h));let d="";return a7.includes(n)?d="+":c7.includes(n)&&(d="-"),l=d.concat(l),[l]},getTransferDescription(t){let e="";return t&&(t?.nft_info?e=t?.nft_info?.name||"-":t?.fungible_info&&(e=this.getFungibleTransferDescription(t)||"-")),e},getFungibleTransferDescription(t){return t?[this.getQuantityFixedValue(t?.quantity.numeric),t?.fungible_info?.symbol].join(" ").trim():null},mergeTransfers(t){if(t?.length<=1)return t;const n=this.filterGasFeeTransfers(t).reduce((s,i)=>{const o=i?.fungible_info?.name,a=s.find(({fungible_info:c,direction:l})=>o&&o===c?.name&&l===i.direction);if(a){const c=Number(a.quantity.numeric)+Number(i.quantity.numeric);a.quantity.numeric=c.toString(),a.value=(a.value||0)+(i.value||0)}else s.push(i);return s},[]);let r=n;return n.length>2&&(r=n.sort((s,i)=>(i.value||0)-(s.value||0)).slice(0,2)),r=r.sort((s,i)=>s.direction==="out"&&i.direction==="in"?-1:s.direction==="in"&&i.direction==="out"?1:0),r},filterGasFeeTransfers(t){const e=t?.reduce((r,s)=>{const i=s?.fungible_info?.name;return i&&(r[i]||(r[i]=[]),r[i].push(s)),r},{}),n=[];return Object.values(e??{}).forEach(r=>{if(r.length===1){const s=r[0];s&&n.push(s)}else{const s=r.filter(o=>o.direction==="in"),i=r.filter(o=>o.direction==="out");if(s.length===1&&i.length===1){const o=s[0],a=i[0];let c=!1;if(o&&a){const l=Number(o.quantity.numeric),u=Number(a.quantity.numeric);u<l*wl?(n.push(o),c=!0):l<u*wl&&(n.push(a),c=!0)}c||n.push(...r)}else{const o=this.filterGasFeesFromTokenGroup(r);n.push(...o)}}}),t?.forEach(r=>{r?.fungible_info?.name||n.push(r)}),n},filterGasFeesFromTokenGroup(t){if(t.length<=1)return t;const e=t?.map(a=>Number(a.quantity.numeric)),n=Math.max(...e),r=Math.min(...e),s=.01;if(r<n*s)return t?.filter(c=>Number(c.quantity.numeric)>=n*s);const i=t?.filter(a=>a.direction==="in"),o=t?.filter(a=>a.direction==="out");if(i.length===1&&o.length===1){const a=i[0],c=o[0];if(a&&c){const l=Number(a.quantity.numeric),u=Number(c.quantity.numeric);if(u<l*wl)return[a];if(l<u*wl)return[c]}}return t},getQuantityFixedValue(t){return t?parseFloat(t).toFixed(o7):null}};function l7(t,e){const{kind:n,elements:r}=e;return{kind:n,elements:r,finisher(s){customElements.get(t)||customElements.define(t,s)}}}function u7(t,e){return customElements.get(t)||customElements.define(t,e),e}function Hj(t){return function(n){return typeof n=="function"?u7(t,n):l7(t,n)}}function d7(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const m=(p-h)*i+1>>>0,w=new Uint8Array(m);for(;h!==p;){let k=l[h],S=0;for(let O=m-1;(k!==0||S<d)&&O!==-1;O--,S++)k+=256*w[O]>>>0,w[O]=k%n>>>0,k=k/n>>>0;if(k!==0)throw new Error("Non-zero carry");d=S,h++}let b=m-d;for(;b!==m&&w[b]===0;)b++;let R=r.repeat(u);for(;b<m;++b)R+=t.charAt(w[b]);return R}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const p=(l.length-u)*s+1>>>0,m=new Uint8Array(p);for(;u<l.length;){const k=l.charCodeAt(u);if(k>255)return;let S=e[k];if(S===255)return;let O=0;for(let U=p-1;(S!==0||O<h)&&U!==-1;U--,O++)S+=n*m[U]>>>0,m[U]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");h=O,u++}let w=p-h;for(;w!==p&&m[w]===0;)w++;const b=new Uint8Array(d+(p-w));let R=d;for(;w!==p;)b[R++]=m[w++];return b}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var h7="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const f7=d7(h7),El={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};class p7 extends wv{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new Ev({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async writeSolanaTransaction(){return Promise.resolve({hash:""})}async getAccounts({namespace:e}){const r=this.provider?.session?.namespaces?.[e]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>se.createAccount(e,s,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&Pe.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};const r=v.getAccountData();if(r?.balanceLoading&&e.chainId===v.state.activeCaipNetwork?.id)return{balance:r?.balance||"0.00",symbol:r?.balanceSymbol||""};const i=(await v.fetchTokenBalance()).find(o=>o.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&o.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return v.state.activeCaipNetwork?.chainNamespace===$.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:f7.encode(new TextEncoder().encode(r)),pubkey:s}},v.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},v.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===$.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:Oa(n.id)}]})}catch(s){if(s.code===El.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===El.ERROR_INVALID_CHAIN_ID||s.code===El.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===El.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:Oa(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const g7=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication","headless"],bl={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Pe.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Pe.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Pe.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?Pe.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t},headless:{apiFeatureName:"headless",localFeatureName:"headless",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.headless}},m7={localSettingsOverridden:new Set,getApiConfig(t,e){return e?.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=bl[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=bl[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(t,o):a?.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return bl[t].processApi(e)},processFallbackFeature(t,e){return bl[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await de.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Pe.DEFAULT_REMOTE_FEATURES:Pe.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of g7){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Pe.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;Et.open({debugMessage:mt.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class y7{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=v.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=v.getNetworkData(n)?.caipNetwork;return i||v.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return v.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>v.getCaipNetworks(n),this.getActiveChainNamespace=()=>v.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{v.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>v.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>v.state.activeChain===n||!n?v.state.activeCaipAddress:v.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{_e.setClientId(n)},this.getProvider=n=>it.getProvider(n),this.getProviderType=n=>it.getProviderId(n),this.getPreferredAccountType=n=>zt(n),this.setCaipAddress=(n,r,s=!1)=>{v.setAccountProp("caipAddress",n,r,s),v.setAccountProp("address",se.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{v.setAccountProp("balance",n,s),v.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{v.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{v.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{v.setAccountProp("user",n,r)},this.resetAccount=n=>{v.resetAccount(n)},this.setCaipNetwork=n=>{v.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{v.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{v.setAccountProp("status",n,r),te.isConnected()?J.setConnectionStatus("connected"):J.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>v.getAccountData(n)?.address,this.setConnectors=n=>{const r=[...te.state.allConnectors,...n];te.setConnectors(r)},this.setConnections=(n,r)=>{J.setConnections(n,r),re.setConnections(n,r)},this.fetchIdentity=n=>_e.fetchIdentity(n),this.getReownName=n=>Fa.getNamesForAddress(n),this.getConnectors=()=>te.getConnectors(),this.getConnectorImage=n=>Gl.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?Yl.getConnectionsData(n).connections:(Et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?Yl.getConnectionsData(n).recentConnections:(Et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){Et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await re.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){Et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}J.deleteAddressFromConnection(n),re.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=it.getProviderId(r),i=n?{...n,type:s}:void 0;v.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!v.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{const i=v.getAccountData(s)?.addressLabels||{};v.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{const s=v.getAccountData(r)?.addressLabels||{};v.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{const r=n||v.state.activeChain;return v.getAccountData(r)?.address},this.resetNetwork=n=>{v.resetNetwork(n)},this.addConnector=n=>{te.addConnector(n)},this.resetWcConnection=()=>{re.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{v.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{v.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{v.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{K.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),e.features?.headless&&!gn.hasInjectedConnectors()&&de.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1,fetchRecommendedWallets:!0}),K.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),!e.basic&&!e.manualWCControl&&(this.remoteFeatures=await m7.fetchRemoteFeatures(e)),await de.fetchUsage(),K.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Nh.setOnrampProviders(this.remoteFeatures.onramp),(K.state.remoteFeatures?.email||Array.isArray(K.state.remoteFeatures?.socials)&&K.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),K.state.features?.reownAuthentication||K.state.remoteFeatures?.reownAuthentication){const{ReownAuthentication:n}=await Xt(async()=>{const{ReownAuthentication:s}=await import("./features-DnZOhIfr.js");return{ReownAuthentication:s}},__vite__mapDeps([0,1])),r=K.state.siwx;r instanceof n||(r&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),K.setSIWX(new n))}}async openSend(e){const n=e.namespace||v.state.activeChain,r=this.getCaipAddress(n),s=this.getCaipNetwork(n)?.id;if(!r)throw new Error("openSend: caipAddress not found");if(s?.toString()!==e.chainId.toString()){const i=v.getCaipNetworkById(e.chainId,n);if(!i)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(i,{throwOnFailure:!0})}try{const i=vv.getTokenSymbolByAddress(e.assetAddress);i&&await de.fetchTokenImages([i])}catch{}return await $e.open({view:"WalletSend",data:{send:e}}),new Promise((i,o)=>{const a=Le.subscribeKey("hash",u=>{u&&(l(),i({hash:u}))}),c=$e.subscribe(u=>{u.open||(l(),o(new Error("Modal closed")))}),l=this.createCleanupHandler([a,c])})}toModalOptions(){function e(r){return r?.view==="Swap"}function n(r){return r?.view==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await de.fetchAllowedOrigins();if(!se.isClient())return;const n=window.location.origin;bs.isOriginAllowed(n,e,$.DEFAULT_ALLOWED_ANCESTORS)||Et.open(mt.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":Et.open(mt.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;Et.open({displayMessage:mt.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:mt.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){const{...n}=e;delete n.adapters,delete n.universalProvider,xe.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(r=>r.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){N0.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&Tn.setThemeMode(e.themeMode),e.themeVariables&&Tn.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw new Error("ConnectionControllerClient must be set");v.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});const n=this.getDefaultNetwork();n&&v.setActiveCaipNetwork(n)}initializeConnectionController(e){re.initialize(e.adapters??[]),re.setWcBasic(e.basic??!1)}initializeConnectorController(){te.initialize(this.chainNamespaces)}initializeProjectSettings(e){K.setProjectId(e.projectId),K.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){K.setDebug(e.debug!==!1),K.setEnableWalletGuide(e.enableWalletGuide!==!1),K.setEnableWallets(e.enableWallets!==!1),K.setEIP6963Enabled(e.enableEIP6963!==!1),K.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),K.setEnableReconnect(e.enableReconnect!==!1),K.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),K.setCoinbasePreference(e.coinbasePreference),K.setEnableAuthLogger(e.enableAuthLogger!==!1),K.setCustomRpcUrls(e.customRpcUrls),K.setEnableEmbedded(e.enableEmbedded),K.setAllWallets(e.allWallets),K.setIncludeWalletIds(e.includeWalletIds),K.setExcludeWalletIds(e.excludeWalletIds),K.setFeaturedWalletIds(e.featuredWalletIds),K.setTokens(e.tokens),K.setTermsConditionsUrl(e.termsConditionsUrl),K.setPrivacyPolicyUrl(e.privacyPolicyUrl),K.setCustomWallets(e.customWallets),K.setFeatures(e.features),K.setAllowUnsupportedChain(e.allowUnsupportedChain),K.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),K.setPreferUniversalLinks(e.experimental_preferUniversalLinks),K.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),K.setMetadata(e.metadata),K.setDisableAppend(e.disableAppend),K.setEnableEmbedded(e.enableEmbedded),K.setSIWX(e.siwx),this.features=K.state.features??{},!e.projectId){Et.open(mt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(s=>s.namespace===$.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");K.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return se.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=Fr.getUnsupportedNetwork(`${n}:${e}`);v.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Fr.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return Fr.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return Fr.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>s.id===e.defaultNetwork?.id);return n?Fr.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e);return(v.state.chains.get(e)?.accountState?.caipAddress||!K.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=v.state.activeChain,n=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,s=re.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),J.setConnectedNamespaces([...v.state.chains.keys()]),await this.syncWalletConnectAccount(),await Rn.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{const i=v.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),J.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||v.state.activeChain,o=te.getConnectorId(i),a=n===$.CONNECTOR_ID.AUTH||o===$.CONNECTOR_ID.AUTH,c=n===$.CONNECTOR_ID.WALLET_CONNECT||o===$.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(v.state.chains.keys());let u=r?[r]:l;(c||a)&&(u=l);const d=u.map(async m=>{const w=te.getConnectorId(m),b=n||w,R=await this.disconnectConnector(m,b);R&&(a&&J.deleteConnectedSocialProvider(),R.connections.forEach(k=>{J.addDisconnectedConnectorId(k.connectorId,m)})),s&&this.onDisconnectNamespace({chainNamespace:m,closeModal:!1})}),h=await Promise.allSettled(d);Le.resetSend(),re.resetWcConnection(),Rn.getSIWX()?.signOutOnDisconnect&&await Rn.clearSessions(),te.setFilterByNamespace(void 0),re.syncStorageConnections();const p=h.filter(m=>m.status==="rejected");if(p.length>0)throw new Error(p.map(m=>m.reason.message).join(", "));xe.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async e=>{const n=v.state.activeChain,r=this.getAdapter(v.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");return(await r?.signMessage({message:e,address:s,provider:it.getProvider(n)}))?.signature||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Pe.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=it.getProvider(n);return(await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===$.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=it.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...e,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=v.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");return await this.syncIdentity({address:n,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),v.getAccountData()?.profileImage||!1},getEnsAddress:async e=>await bs.resolveReownName(e),writeContract:async e=>{const n=v.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=it.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},writeSolanaTransaction:async e=>{const n=v.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=it.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeSolanaTransaction({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(e,n)=>{const r=this.getAdapter(v.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:n})??0n},formatUnits:(e,n)=>{const r=this.getAdapter(v.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:n})??"0"},getCapabilities:async e=>{const n=this.getAdapter(v.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(e)},grantPermissions:async e=>{const n=this.getAdapter(v.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(e)},revokePermissions:async e=>{const n=this.getAdapter(v.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(v.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(e)??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r?.id,e)}},re.setClient(this.connectionControllerClient)}async onConnectExternal(e){const n=v.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===mn.CONNECTOR_TYPE_AUTH&&$.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>te.getConnectorId(d)===$.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const l=this.getCaipNetworks().find(u=>u.chainNamespace===e.chain);l&&i&&this.setCaipNetwork(l)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),a=e.caipNetwork||o,c=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return J.addConnectedNamespace(r),this.syncProvider({...c,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),J.removeDisconnectedConnectorId(e.id,r),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,n){const r=e.type===mn.CONNECTOR_TYPE_AUTH,s=ps.getOtherAuthNamespaces(n?.connectedCaipNetwork?.chainNamespace),i=v.state.activeCaipNetwork,o=this.getAdapter(i?.chainNamespace);r&&(await Promise.all(s.map(async a=>{try{const c=it.getProvider(a),l=this.getCaipNetwork(a);await this.getAdapter(a)?.connect({...e,provider:c,socialUri:void 0,chainId:l?.id,rpcUrl:l?.rpcUrls?.default?.http?.[0]})&&(J.addConnectedNamespace(a),J.removeDisconnectedConnectorId(e.id,a),this.setStatus("connected",a),this.syncConnectedWalletInfo(a))}catch(c){Et.warn(mt.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,mt.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(a,c instanceof Error?c.message:void 0),mt.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await o?.switchNetwork({caipNetwork:i}))}getApprovedCaipNetworksData(){if(it.getProviderId(v.state.activeChain)===mn.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=it.getProviderId(n);if(e.chainNamespace===v.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:e});else if(this.setCaipNetwork(e),s===mn.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const i=this.getAddressByChainNamespace(n);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=Lt.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=e?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:i})=>i===r)}),n[r]=s):n[r]=new p7({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);const n=this.getAdapter(e);if(!n)throw new Error("adapter not found");await n.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=J.getConnectionStatus();K.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(J.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=v.state.activeChain===e,c=v.state.chains.get(e)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(re.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=v.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{this.handlePreviousConnectorConnection(o);const a=v.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=v.getNetworkData(e)?.caipNetwork?.id,l=i||c;a&&l?this.syncAccount({address:s,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(s,l,e),this.syncBalance({address:s,chainId:l,chainNamespace:e})):this.syncAccountInfo(s,i,e),J.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){const n=e?.chain,r=e?.id,s=te.getConnectorId(n),i=K.state.remoteFeatures?.multiWallet,a=n&&r&&s&&s!==r&&!i;try{a&&await re.disconnect({id:s,namespace:n})}catch(c){console.warn("Error disconnecting previous connector",c)}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>re.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||J.deleteRecentWallet();const n=J.getRecentWallet();xe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:se.isMobile()?"mobile":"qrcode",name:n?.name||"Unknown",reconnect:!0,view:he.state.view,walletRank:n?.order}})}async syncNamespaceConnection(e){try{e===$.CHAIN.EVM&&se.isSafeApp()&&te.setConnectorId($.CONNECTOR_ID.SAFE,e);const n=te.getConnectorId(e);switch(this.setStatus("connecting",e),n){case $.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case $.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};v.resetAccount(n),v.resetNetwork(n),J.removeConnectedNamespace(n);const s=Array.from(v.state.chains.keys());(n?[n]:s).forEach(o=>J.addDisconnectedConnectorId(te.getConnectorId(o)||"",o)),te.removeConnectorId(n),it.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&$e.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n?.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=te.getConnectorId(e),o=te.getConnectors(e).find(a=>a.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!r?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e),xe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0,view:he.state.view,walletRank:o?.explorerWallet?.order}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=v.state.activeCaipNetwork?.id,a=i.find(l=>{const{chainId:u}=Lt.parseCaipAddress(l);return u===o?.toString()})||i[0];if(a){const l=Lt.validateCaipAddress(a),{chainId:u,address:d}=Lt.parseCaipAddress(l);if(it.setProviderId(r,mn.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&v.state.activeCaipNetwork&&s.namespace!==$.CHAIN.EVM){const h=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:v.state.activeCaipNetwork});it.setProvider(r,h)}else it.setProvider(r,this.universalProvider);te.setConnectorId($.CONNECTOR_ID.WALLET_CONNECT,r),J.addConnectedNamespace(r),await this.syncAccount({address:d,chainId:u,chainNamespace:r})}else e.includes(r)&&this.setStatus("disconnected",r);const c=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(r),v.setApprovedCaipNetworksData(r,{approvedCaipNetworkIds:c.approvedCaipNetworkIds,supportsAllNetworks:c.supportsAllNetworks})});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){it.setProviderId(s,e),it.setProvider(s,n),te.setConnectorId(r,s)}async syncAccount(e){const n=e.chainNamespace===v.state.activeChain,r=v.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=J.getActiveNetworkProps(),c=r?.id||a,l=v.state.activeCaipNetwork?.name===$.UNSUPPORTED_NETWORK_NAME,u=v.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(w=>w.id.toString()===c.toString()),h=this.getCaipNetworks().find(w=>w.chainNamespace===o);if(!u&&!d&&!h){const w=this.getApprovedCaipNetworkIds()||[],b=w.find(k=>Lt.parseCaipNetworkId(k)?.chainId===c.toString()),R=w.find(k=>Lt.parseCaipNetworkId(k)?.chainNamespace===o);d=this.getCaipNetworks().find(k=>k.caipNetworkId===b),h=this.getCaipNetworks().find(k=>k.caipNetworkId===R||"deprecatedCaipNetworkId"in k&&k.deprecatedCaipNetworkId===R)}const p=d||h;p?.chainNamespace===v.state.activeChain?K.state.enableNetworkSwitch&&!K.state.allowUnsupportedChain&&v.state.activeCaipNetwork?.name===$.UNSUPPORTED_NETWORK_NAME?v.showUnsupportedChainUI():this.setCaipNetwork(p):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const m=this.getAddress(o);ps.isLowerCaseMatch(s,m)||this.syncAccountInfo(s,p?.id,o),n?await this.syncBalance({address:s,chainId:p?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){const n=te.getConnectorId(e),r=it.getProviderId(e);if(r===mn.CONNECTOR_TYPE_ANNOUNCED||r===mn.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,l=o.connectors?.some(u=>u.id===n||u.info?.rdns===n);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(r===mn.CONNECTOR_TYPE_WALLET_CONNECT){const s=it.getProvider(e);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},e)}else if(n&&(n===$.CONNECTOR_ID.COINBASE_SDK||n===$.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},e)}}async syncBalance(e){!Ka.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>r.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=v.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const e=T9.createLogger((s,...i)=>{s&&this.handleAlertError(s),console.error(...i)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};K.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await HF.init(n);const r=this.universalProvider.disconnect.bind(this.universalProvider);this.universalProvider.disconnect=async()=>{try{return await r()}catch(s){if(s instanceof Error&&s.message.includes("Missing or invalid. Record was recently deleted"))return;throw s}},K.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{bs.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{re.setUri(n)},onConnect:n=>{const{address:r}=se.getAccount(n[0]);for(const s of this.chainNamespaces)J.removeDisconnectedConnectorId($.CONNECTOR_ID.WALLET_CONNECT,s);re.finalizeWcConnection(r)},onDisconnect:()=>{v.state.noAdapters&&this.resetAccount(e),re.resetWcConnection()},onChainChanged:n=>{const r=v.state.activeChain,s=r&&te.state.activeConnectorIds[r]===$.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(v.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=v.state.activeChain,s=r&&te.state.activeConnectorIds[r]===$.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(v.state.noAdapters||s)){const i=n?.[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&se.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){xe.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}getDisabledCaipNetworks(){const e=v.getAllApprovedCaipNetworkIds(),n=v.getAllRequestedCaipNetworks();return se.sortRequestedNetworks(e,n).filter(s=>v.isCaipNetworkDisabled(s))}handleAlertError(e){const n=Object.entries(mt.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=mt.ALERT_ERRORS[o];a&&(Et.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:s})=>s===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e?.uri&&re.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?$e.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):$e.open(e)}async close(){await this.injectModalUi(),$e.close()}setLoading(e,n){$e.setLoading(e,n)}async disconnect(e){await re.disconnect({namespace:e})}getSIWX(){return K.state.siwx}getError(){return""}getChainId(){return v.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){Et.open(mt.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await v.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return v.state.activeChain?it.state.providers[v.state.activeChain]:null}getWalletProviderType(){return it.getProviderId(v.state.activeChain)}subscribeProviders(e){return it.subscribeProviders(e)}getThemeMode(){return Tn.state.themeMode}getThemeVariables(){return Tn.state.themeVariables}setThemeMode(e){Tn.setThemeMode(e),Rf(Tn.state.themeMode)}setTermsConditionsUrl(e){K.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){K.setPrivacyPolicyUrl(e)}setThemeVariables(e){Tn.setThemeVariables(e),i7(Tn.state.themeVariables)}subscribeTheme(e){return Tn.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?re.subscribe(e):(Et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?v.state.chains.get(e)?.accountState?.connectedWalletInfo:v.getAccountData()?.connectedWalletInfo}getAccount(e){const n=e||v.state.activeChain,r=te.getAuthConnector(n),s=v.getAccountData(n),i=J.getConnectedConnectorId(v.state.activeChain),o=re.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>se.createAccount(n,l,u||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:se.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===$.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:J.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:zt(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=[],s=()=>{const o=this.getAccount(n);o&&e(o)};if(n){const o=v.subscribeChainProp("accountState",s,n);r.push(o)}else{const o=v.subscribe(s);r.push(o)}const i=te.subscribe(s);return r.push(i),()=>{r.forEach(o=>o())}}subscribeNetwork(e){return v.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(e,n){return n?v.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo),n):v.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){return v.subscribeChainProp("accountState",n=>e(n?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){return v.subscribeKey("activeCaipNetwork",e)}getState(){return Gn.state}getRemoteFeatures(){return K.state.remoteFeatures}subscribeState(e){return Gn.subscribe(e)}subscribeRemoteFeatures(e){return K.subscribeKey("remoteFeatures",e)}showErrorMessage(e){pt.showError(e)}showSuccessMessage(e){pt.showSuccess(e)}getEvent(){return{...xe.state}}subscribeEvents(e){return xe.subscribe(e)}replace(e){he.replace(e)}redirect(e){he.push(e)}popTransactionStack(e){he.popTransactionStack(e)}isOpen(){return $e.state.open}isTransactionStackEmpty(){return he.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){K.setFeatures(e)}updateRemoteFeatures(e){K.setRemoteFeatures(e)}updateOptions(e){const r={...K.state||{},...e};K.setOptions(r)}setConnectMethodsOrder(e){K.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){K.setWalletFeaturesOrder(e)}setCollapseWallets(e){K.setCollapseWallets(e)}setSocialsOrder(e){K.setSocialsOrder(e)}getConnectMethodsOrder(){return Zs.getConnectOrderMethod(K.state.features,te.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||v.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&v.removeNetwork(e,n)}}let Gw=!1;class qj extends y7{async onAuthProviderConnected(e){const n=ps.userChainIdToChainNamespace(e?.chainId);if(e.message&&e.signature&&e.siwxMessage&&await Rn.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===$.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=K.state.defaultAccountTypes[n],i=zt(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:l,...u}=e,d=v.getAccountData(n);this.setUser({...d?.user||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),await Promise.all([this.syncAuthConnectorTheme(this.authProvider),this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:n})]),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{Kn.checkIfRequestExists(n)?Kn.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(yt.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(yt.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=Kn.checkIfRequestIsSafe(r),i=this.getAddress(),o=v.state.activeCaipNetwork;s||(i&&o?.id&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=v.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");te.getConnectorId(n)===$.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=v.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=Tn.getSnapshot();await e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Ga(n.themeVariables,n.themeMode)})}async syncAuthConnector(e,n){const r=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===v.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername(),c=v.getAccountData(n)?.user||{};this.setUser({...c,username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:l}=await e.isConnected();if(n&&r&&s)if(l&&this.connectionControllerClient?.connectExternal){await e.init(),await this.syncAuthConnectorTheme(e),await this.connectionControllerClient?.connectExternal({id:$.CONNECTOR_ID.AUTH,info:{name:$.CONNECTOR_ID.AUTH},type:mn.CONNECTOR_TYPE_AUTH,provider:e,chainId:v.getNetworkData(n)?.caipNetwork?.id,chain:n}),this.setStatus("connected",n);const u=J.getConnectedSocialProvider();u?xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:u,reconnect:!0}}):xe.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0,view:he.state.view,walletRank:void 0}})}else te.getConnectorId(n)===$.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),J.removeConnectedNamespace(n));this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){try{if(!se.isTelegram())return;const n=J.getTelegramSocialProvider();if(!n||!se.isClient())return;const s=new URL(window.location.href).searchParams.get("result_uri");if(!s)return;n&&v.setAccountProp("socialProvider",n,e),await this.authProvider?.init();const i=te.getAuthConnector();n&&i&&(this.setLoading(!0,e),await re.connectExternal({id:i.id,type:i.type,socialUri:s},i.chain),J.setConnectedSocialProvider(n),J.removeTelegramSocialProvider(),xe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){if(!$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=this.remoteFeatures?.email,s=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=ps.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&i&&(this.authProvider=Ui.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(a)?.caipNetworkId,abortController:mt.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?Et.open(mt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?Et.open(mt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&Et.open(mt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>hs(l),getCaipNetworks:l=>v.getCaipNetworks(l)}),Gn.subscribeOpen(l=>{!l&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const c=e===v.state.activeChain&&K.state.enableReconnect;K.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&de.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const n=v.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&v.getAccountData(r)?.caipAddress)await this.getAdapter(r)?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e);else{const a=it.getProviderId(n)===mn.CONNECTOR_TYPE_AUTH,c=it.getProviderId(r),l=c===mn.CONNECTOR_TYPE_AUTH,u=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((a&&c===void 0||l)&&u)try{v.state.activeChain=e.chainNamespace,s?await this.getAdapter(r)?.switchNetwork({caipNetwork:e}):await this.connectionControllerClient?.connectExternal?.({id:$.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:mn.CONNECTOR_TYPE_AUTH,caipNetwork:e}),this.setCaipNetwork(e)}catch{await this.getAdapter(r)?.switchNetwork({caipNetwork:e})}else c===mn.CONNECTOR_TYPE_WALLET_CONNECT?(v.state.noAdapters||await this.getAdapter(r)?.switchNetwork({caipNetwork:e}),this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r}))}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(n=>{this.createAuthProviderForAdapter(n)}),await this.injectModalUi(),Gn.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){const s=`${r}:${n}`;if(this.caipNetworks?.find(a=>a.caipNetworkId===s)?.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=te.getConnectorId(r)===$.CONNECTOR_ID.AUTH;try{const{name:a,avatar:c}=await this.fetchIdentity({address:e});!a&&o?await this.syncReownName(e,r):(this.setProfileName(a,r),this.setProfileImage(c,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=it.getProviderId(e);if(n===mn.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=J.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(se.isClient()&&!Gw)try{const e={...Pe.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),se.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!K.state.disableAppend&&!K.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Gw=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!se.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(Xt(()=>import("./embedded-wallet-BAgYpYsg.js"),__vite__mapDeps([2,3,1,4,5,6]))),n.email&&r.push(Xt(()=>import("./email-BQ9Y9oEp.js"),__vite__mapDeps([7,8,3,1,4,5,6]))),n.socials&&r.push(Xt(()=>import("./socials-DK-Ok6GK.js"),__vite__mapDeps([9,3,1,4,5,6]))),n.swaps&&n.swaps.length>0&&r.push(Xt(()=>import("./swaps-cVhc2WJQ.js"),__vite__mapDeps([10,3,1,4,5,6,11]))),e.send&&r.push(Xt(()=>import("./send-D1OYHajq.js"),__vite__mapDeps([12,3,1,4,5,6,13,11]))),e.receive&&r.push(Xt(()=>import("./receive-vNm6C3MY.js"),__vite__mapDeps([14,3,1,4,5,6]))),n.onramp&&n.onramp.length>0&&r.push(Xt(()=>import("./onramp-BetThFTt.js"),__vite__mapDeps([15,3,1,4,5,6]))),n.payWithExchange&&r.push(Xt(()=>import("./pay-with-exchange-DzzdRWgZ.js"),__vite__mapDeps([16,3,1,4,5,6,13]))),n.activity&&r.push(Xt(()=>import("./transactions-D2tFYUel.js"),__vite__mapDeps([17,3,1,4,5,6]))),(e.pay||n.payments)&&r.push(Xt(()=>import("./index-Bk5rgs9c.js"),__vite__mapDeps([18,19,3,1,4,5,6]))),n.emailCapture&&r.push(Xt(()=>import("./data-capture-DIzcF0nK.js"),__vite__mapDeps([20,3,1,4,5,6,8,0]))),await Promise.all([...r,Xt(()=>import("./index-B08Z505Y.js").then(i=>i.i),__vite__mapDeps([3,1,4,5,6])),Xt(()=>import("./w3m-modal-uoSzwKP3.js"),__vite__mapDeps([21,3,1,4,5,6,19]))])}}const zj="1.8.17",w7={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},E7={block:kv({format(t){return{transactions:t.transactions?.map(n=>{if(typeof n=="string")return n;const r=Pv(n);return r.typeHex==="0x7e"&&(r.isSystemTx=n.isSystemTx,r.mint=n.mint?Xo(n.mint):void 0,r.sourceHash=n.sourceHash,r.type="deposit"),r}),stateRoot:t.stateRoot}}}),transaction:Rv({format(t){const e={};return t.type==="0x7e"&&(e.isSystemTx=t.isSystemTx,e.mint=t.mint?Xo(t.mint):void 0,e.sourceHash=t.sourceHash,e.type="deposit"),e}}),transactionReceipt:Ov({format(t){return{l1GasPrice:t.l1GasPrice?Xo(t.l1GasPrice):null,l1GasUsed:t.l1GasUsed?Xo(t.l1GasUsed):null,l1Fee:t.l1Fee?Xo(t.l1Fee):null,l1FeeScalar:t.l1FeeScalar?Number(t.l1FeeScalar):null}}})};function b7(t,e){return _7(t)?v7(t):Dv(t,e)}const C7={transaction:b7};function v7(t){A7(t);const{sourceHash:e,data:n,from:r,gas:s,isSystemTx:i,mint:o,to:a,value:c}=t,l=[e,r,a??"0x",o?Oa(o):"0x",c?Oa(c):"0x",s?Oa(s):"0x",i?"0x1":"0x",n??"0x"];return Uv(["0x7e",$v(l)])}function _7(t){return t.type==="deposit"||typeof t.sourceHash<"u"}function A7(t){const{from:e,to:n}=t;if(e&&!jp(e))throw new Wp({address:e});if(n&&!jp(n))throw new Wp({address:n})}const Yr={blockTime:2e3,contracts:w7,formatters:E7,serializers:C7},Vj=Un({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:250,rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),Kj=Un({id:43114,name:"Avalanche",blockTime:1700,nativeCurrency:{decimals:18,name:"Avalanche",symbol:"AVAX"},rpcUrls:{default:{http:["https://api.avax.network/ext/bc/C/rpc"]}},blockExplorers:{default:{name:"SnowTrace",url:"https://snowtrace.io",apiUrl:"https://api.snowtrace.io"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:11907934}}}),Ea=1,S7=Un({...Yr,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...Yr.contracts,disputeGameFactory:{[Ea]:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{[Ea]:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{[Ea]:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:17482143}},l1StandardBridge:{[Ea]:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:17482143}}},sourceId:Ea});({...S7});const ba=11155111,I7=Un({...Yr,id:84532,network:"base-sepolia",name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}},contracts:{...Yr.contracts,disputeGameFactory:{[ba]:{address:"0xd6E6dBf4F7EA0ac412fD8b65ED297e64BB7a06E1"}},l2OutputOracle:{[ba]:{address:"0x84457ca9D0163FbC4bbfe4Dfbb20ba46e48DF254"}},portal:{[ba]:{address:"0x49f53e41452c74589e85ca1677426ba426459e85",blockCreated:4446677}},l1StandardBridge:{[ba]:{address:"0xfd0Bf71F60660E2f608ed56e1659C450eB113120",blockCreated:4446677}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1059647}},testnet:!0,sourceId:ba});({...I7});const Gj=Un({id:56,name:"BNB Smart Chain",blockTime:750,nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}});async function T7(t,e){const{account:n=t.account}=e;if(!n)throw new Bv;const r=Wv(n);try{const{accessList:s,blockNumber:i,blockTag:o,data:a,gas:c,gasPrice:l,maxFeePerGas:u,maxPriorityFeePerGas:d,nonce:h,to:p,value:m,...w}=e,R=(typeof i=="bigint"?fh(i):void 0)||o;Lv(e);const k=t.chain?.formatters?.transactionRequest?.format,O=(k||Mv)({...Fv(w,{format:k}),account:r,accessList:s,data:a,gas:c,gasPrice:l,maxFeePerGas:u,maxPriorityFeePerGas:d,nonce:h,to:p,value:m},"estimateGas"),{baseFeePerGas:U,gasLimit:F,priorityFeePerGas:q}=await t.request({method:"linea_estimateGas",params:R?[O,R]:[O]});return{baseFeePerGas:BigInt(U),gasLimit:BigInt(F),priorityFeePerGas:BigInt(q)}}catch(s){throw jv(s,{...e,account:r,chain:t.chain})}}const N7={fees:{estimateFeesPerGas:Yw,async maxPriorityFeePerGas({block:t,client:e,request:n}){const r=await Yw({block:t,client:e,multiply:s=>s,request:n,type:"eip1559"});return r?.maxPriorityFeePerGas?r.maxPriorityFeePerGas:null}}};async function Yw({client:t,multiply:e,request:n,type:r}){try{const s=await T7(t,{...n,account:n?.account}),{priorityFeePerGas:i}=s,a=e(BigInt(s.baseFeePerGas))+i;return r==="legacy"?{gasPrice:a}:{maxFeePerGas:a,maxPriorityFeePerGas:i}}catch{return null}}const Yj=Un({...N7,id:59144,name:"Linea Mainnet",blockTime:2e3,nativeCurrency:{name:"Linea Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://rpc.linea.build"],webSocket:["wss://rpc.linea.build"]}},blockExplorers:{default:{name:"Etherscan",url:"https://lineascan.build",apiUrl:"https://api.lineascan.build/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:42},ensRegistry:{address:"0x50130b669B28C339991d8676FA73CF122a121267",blockCreated:6682888},ensUniversalResolver:{address:"0x4D41762915F83c76EcaF6776d9b08076aA32b492",blockCreated:22222151}},ensTlds:[".linea.eth"],testnet:!1}),Zj=Un({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),Ca=1,Jj=Un({...Yr,id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.optimism.io"]}},blockExplorers:{default:{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io/api"}},contracts:{...Yr.contracts,disputeGameFactory:{[Ca]:{address:"0xe5965Ab5962eDc7477C8520243A95517CD252fA9"}},l2OutputOracle:{[Ca]:{address:"0xdfe97868233d1aa22e815a266982f2cf17685a27"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:4286263},portal:{[Ca]:{address:"0xbEb5Fc579115071764c7423A4f12eDde41f106Ed"}},l1StandardBridge:{[Ca]:{address:"0x99C9fc46f92E8a1c0deC1b1747d010903E884bE1"}}},sourceId:Ca}),va=11155111,Xj=Un({...Yr,id:11155420,name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.optimism.io"]}},blockExplorers:{default:{name:"Blockscout",url:"https://optimism-sepolia.blockscout.com",apiUrl:"https://optimism-sepolia.blockscout.com/api"}},contracts:{...Yr.contracts,disputeGameFactory:{[va]:{address:"0x05F9613aDB30026FFd634f38e5C4dFd30a197Fa1"}},l2OutputOracle:{[va]:{address:"0x90E9c4f8a994a250F6aEfd61CAFb4F2e895D458F"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:1620204},portal:{[va]:{address:"0x16Fc5058F25648194471939df75CF27A2fdC48BC"}},l1StandardBridge:{[va]:{address:"0xFBb0621E0B23b5478B630BD55a5f21f67730B0F1"}}},testnet:!0,sourceId:va}),Qj=Un({id:137,name:"Polygon",blockTime:2e3,nativeCurrency:{name:"POL",symbol:"POL",decimals:18},rpcUrls:{default:{http:["https://polygon-rpc.com"]}},blockExplorers:{default:{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.etherscan.io/v2/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:25770160}}}),eW=Un({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://11155111.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:8928790}},testnet:!0}),Cl=1,tW=Un({...Yr,id:7777777,name:"Zora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["https://rpc.zora.energy"],webSocket:["wss://rpc.zora.energy"]}},blockExplorers:{default:{name:"Explorer",url:"https://explorer.zora.energy",apiUrl:"https://explorer.zora.energy/api"}},contracts:{...Yr.contracts,l2OutputOracle:{[Cl]:{address:"0x9E6204F750cD866b299594e2aC9eA824E2e5f95c"}},multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:5882},portal:{[Cl]:{address:"0x1a0ad011913A150f69f6A19DF447A0CfD9551054"}},l1StandardBridge:{[Cl]:{address:"0x3e2Ea9B92B7E48A52296fD261dc26fd995284631"}}},sourceId:Cl});function x7(t){let e=[],n,r;function s(a){const c=v.getCaipNetworks($.CHAIN.EVM);let l=Number(Ka.parseEvmChainId(a));if(!c.some(u=>String(u.id)===String(a))){const u=v.getActiveCaipNetwork($.CHAIN.EVM)?.id||c[0]?.id;u&&Number.isInteger(Number(u))&&(l=Number(u))}if(!l)throw new Error("ChainId not found in networks");return l}function i(){return n||(n=Ui.getInstance({projectId:t.options.projectId,chainId:hs()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:a=>{a==="iframe_load_failed"?Et.open(mt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):a==="iframe_request_timeout"?Et.open(mt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):a==="unverified_domain"&&Et.open(mt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:mt.EmbeddedWalletAbortController,getActiveCaipNetwork:a=>hs(a),getCaipNetworks:a=>v.getCaipNetworks(a)})),n}async function o(a={}){const c=i();let l=a.chainId;if(a.isReconnecting){const w=Ka.parseEvmChainId(c.getLastUsedChainId()||""),b=t.chains?.[0].id;if(l=w||b,!l)throw new Error("ChainId not found in provider")}const u=zt("eip155"),{address:d,chainId:h,accounts:p}=await Rn.authConnectorAuthenticate({authConnector:c,chainId:l,preferredAccountType:u,socialUri:a.socialUri,chainNamespace:$.CHAIN.EVM});e=p?.map(w=>w.address)||[d];const m=s(h);return{accounts:e,account:d,chainId:m,chain:{id:m,unsupported:!1}}}return Xw(a=>({id:$.CONNECTOR_ID.AUTH,name:$.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:$.CHAIN.EVM,async connect(c={}){if(r){const u=await r;return{accounts:c.withCapabilities?u.accounts.map(d=>({address:d,capabilities:{}})):u.accounts,chainId:u.chainId}}r||(r=new Promise(u=>{u(o(c))}));const l=await r;return r=void 0,{accounts:c.withCapabilities?l.accounts.map(u=>({address:u,capabilities:{}})):l.accounts,chainId:l.chainId}},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e?.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){return this.provider||(this.provider=Ui.getInstance({projectId:t.options.projectId,chainId:hs()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:mt.EmbeddedWalletAbortController,onTimeout:c=>{c==="iframe_load_failed"?Et.open(mt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?Et.open(mt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&Et.open(mt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:c=>hs(c),getCaipNetworks:c=>v.getCaipNetworks(c)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:l}=await c.getChainId();return s(l)},async isAuthorized(){const l=v.state.activeChain===$.CHAIN.EVM;if($.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(h=>te.getConnectorId(h)===$.CONNECTOR_ID.AUTH)&&!l)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){try{const l=a.chains.find(p=>p.id===c);if(!l)throw new ph(new Error("chain not found on connector."));const u=await this.getProvider(),d=zt("eip155"),h=await u.connect({chainId:c,preferredAccountType:d});return e=h?.accounts?.map(p=>p.address)||[h.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),l}catch(l){throw l instanceof Error?new ph(l):l}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(Qw)})},onChainChanged(c){const l=Number(c);a.emitter.emit("change",{chainId:l})},async onDisconnect(c){await(await this.getProvider()).disconnect()}}))}Mp.type="walletConnect";function Mp(t){const e=t.isNewChainsStale??!0;let n,r,s,i,o,a,c;return Xw(l=>({id:"walletConnect",name:"WalletConnect",type:Mp.type,provider:t.universalProvider,async setup(){const u=await this.getProvider().catch(()=>null);u&&(i||(i=this.onConnect.bind(this),u.on("connect",i)),a||(a=this.onSessionDelete.bind(this),u.on("session_delete",a)))},async connect({...u}={}){try{const d=v.getCaipNetworks(),h=await this.getProvider();if(!h)throw new Hp;o||(o=this.onDisplayUri,h.on("display_uri",o));const p=await this.isChainsStale();h.session&&p&&await h.disconnect();const m=K.state.universalProviderConfigOverride;if(!h.session||p){const U=bs.createNamespaces(d,m);await h.connect({optionalNamespaces:U,..."pairingTopic"in u?{pairingTopic:u.pairingTopic}:{}}),this.setRequestedChainsIds(d.map(F=>Number(F.id)))}const w=await this.getAccounts(),b=await this.getChainId(),R=h.session?.namespaces?.eip155?.chains,k=R?.some(U=>Number(U.split(":")[1])===b);let S=1;k?S=b:R?.[0]&&(S=Number(R[0].split(":")[1])),o&&(h.removeListener("display_uri",o),o=void 0),i&&(h.removeListener("connect",i),i=void 0),r||(r=this.onAccountsChanged.bind(this),h.on("accountsChanged",r)),s||(s=this.onChainChanged.bind(this),h.on("chainChanged",s)),c||(c=this.onDisconnect.bind(this),h.on("disconnect",c)),a||(a=this.onSessionDelete.bind(this),h.on("session_delete",a));const O=m?.defaultChain;return h.setDefaultChain(O??`eip155:${S}`),{accounts:w,chainId:S}}catch(d){throw/(user rejected|connection request reset)/i.test(d?.message)?new Ra(d):d}},async disconnect(){const u=await this.getProvider();try{await u?.disconnect()}catch(d){if(!/No matching key/i.test(d.message))throw d}finally{s&&(u?.removeListener("chainChanged",s),s=void 0),c&&(u?.removeListener("disconnect",c),c=void 0),i||(i=this.onConnect.bind(this),u?.on("connect",i)),r&&(u?.removeListener("accountsChanged",r),r=void 0),a&&(u?.removeListener("session_delete",a),a=void 0),this.setRequestedChainsIds([])}},async getAccounts(){const u=await this.getProvider();if(!u?.session?.namespaces)return[];const h=u?.session?.namespaces[$.CHAIN.EVM]?.accounts?.map(w=>w.split(":")[2])??[],p=new Set;return h.filter(w=>{const b=w?.toLowerCase();return p.has(b)?!1:(p.add(b),!0)})},async getProvider({chainId:u}={}){n||(n=t.universalProvider,n?.events.setMaxListeners(Number.POSITIVE_INFINITY));const d=J.getActiveNamespace(),h=v.getActiveCaipNetwork()?.id;if(u&&h!==u&&d){const p=J.getStoredActiveCaipNetworkId(),w=(d?v.getCaipNetworks(d):[])?.find(b=>b.id===p);w&&w.chainNamespace===$.CHAIN.EVM&&await this.switchChain?.({chainId:Number(w.id)})}return n},async getChainId(){const u=v.getActiveCaipNetwork($.CHAIN.EVM)?.id;if(u)return u;const h=(await this.getProvider()).session?.namespaces[$.CHAIN.EVM]?.chains?.[0];return v.getCaipNetworks().find(m=>m.id===h)?.id},async isAuthorized(){try{const[u,d]=await Promise.all([this.getAccounts(),this.getProvider()]);return u.length?await this.isChainsStale()&&d.session?(await d.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:u,chainId:d}){const h=await this.getProvider();if(!h)throw new Hp;const p=v.getCaipNetworks().find(m=>m.id===d);if(!p)throw new ph(new Hv);try{await h.request({method:"wallet_switchEthereumChain",params:[{chainId:fh(d)}]}),p?.caipNetworkId&&h.setDefaultChain(p?.caipNetworkId),l.emitter.emit("change",{chainId:Number(d)});const m=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...m,d]),{...p,id:p.id}}catch(m){const w=m;if(/(?:user rejected)/iu.test(w.message))throw new Ra(w);try{let b;u?.blockExplorerUrls?b=u.blockExplorerUrls:b=p.blockExplorers?.default.url?[p.blockExplorers?.default.url]:[];const R=p.rpcUrls?.chainDefault?.http||[],k={blockExplorerUrls:b,chainId:fh(d),chainName:p.name,iconUrls:u?.iconUrls,nativeCurrency:p.nativeCurrency,rpcUrls:R};await h.request({method:"wallet_addEthereumChain",params:[k]});const S=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...S,d]),{...p,id:p.id}}catch(b){throw new Ra(b)}}},onAccountsChanged(u){u.length===0?this.onDisconnect():l.emitter.emit("change",{accounts:u.map(d=>Qw(d))})},onChainChanged(u){const d=Number(u);l.emitter.emit("change",{chainId:d})},onConnect(u){this.setRequestedChainsIds(v.getCaipNetworks().map(d=>Number(d.id)))},async onDisconnect(u){this.setRequestedChainsIds([]),l.emitter.emit("disconnect");const d=await this.getProvider();r&&(d.removeListener("accountsChanged",r),r=void 0),s&&(d.removeListener("chainChanged",s),s=void 0),c&&(d.removeListener("disconnect",c),c=void 0),a&&(d.removeListener("session_delete",a),a=void 0),i||(i=this.onConnect.bind(this),d.on("connect",i))},onDisplayUri(u){l.emitter.emit("message",{type:"display_uri",data:u})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){return n?.session?.namespaces?n?.session?.namespaces[$.CHAIN.EVM]?.accounts?.map(h=>Number.parseInt(h.split(":")[1]??""))??[]:[]},async getRequestedChainsIds(){const u=await l.storage?.getItem(this.requestedChainsStorageKey)??[];return[...new Set(u)]},async isChainsStale(){if(!e)return!1;const u=l.chains.map(p=>p.id),d=this.getNamespaceChainsIds();if(d.length&&!d.some(p=>u.includes(p)))return!1;const h=await this.getRequestedChainsIds();return!u.every(p=>h.includes(Number(p)))},async setRequestedChainsIds(u){await l.storage?.setItem(this.requestedChainsStorageKey,u)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}}))}const _a=tt({pendingTransactions:0}),Zw={state:_a,subscribeKey(t,e){return It(_a,t,e)},increase(t){_a[t]+=1},decrease(t){_a[t]-=1},reset(t){_a[t]=0}};async function O7(t){if(se.isSafeApp()){const{safe:e}=await Xt(async()=>{const{safe:n}=await import("./index-CbJO_9Dw.js");return{safe:n}},__vite__mapDeps([22,1]));if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function R7(t){try{const{baseAccount:e}=await Xt(async()=>{const{baseAccount:n}=await import("./index-CbJO_9Dw.js");return{baseAccount:n}},__vite__mapDeps([22,1]));if(e&&!t.some(n=>n.id==="baseAccount"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const k7={enable:!1,pollingInterval:3e4};class nW extends wv{constructor(e){const n=Fr.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=$.CHAIN.EVM,this.adapterType=$.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...k7,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===$.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!i?.user)return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>se.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=Ju(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>se.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=Ju(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===$.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{const i=e.transports?.[s.id],o=Fr.getCaipNetworkId(s);i?n[s.id]=Fr.extendWagmiTransports(s,e.projectId,i):n[s.id]=Fr.getViemTransport(s,e.projectId,e.customRpcUrls?.[o])}),this.wagmiConfig=qv({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=zv(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),Zw.increase("pendingTransactions")}});const e=Zw.subscribeKey("pendingTransactions",n=>{n>=$.LIMITS.PENDING_TRANSACTIONS&&(this.unwatchPendingTransactions?.(),e())})}setupWatchers(){Vv(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===$.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:this.toChecksummedAddress(i)})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:J.getConnectedSocialProvider(),username:J.getConnectedSocialUsername()}:void 0}}))}}),Kv(this.wagmiConfig,{onChange:(e,n)=>{if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e?.chainId&&e?.chainId!==n?.chainId&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const r=e.address!==n?.address,s=e.connector.id!==n.connector?.id,i=n.status!=="connected";(r||s||i)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}})}async addThirdPartyConnectors(){const e=[],{enableCoinbase:n}=K.state||{};if(n!==!1){const s=await R7(this.wagmiConfig.connectors);s&&e.push(s)}const r=await O7(this.wagmiConfig.connectors);r&&e.push(r),await Promise.all(e.map(s=>{const i=this.configureInternalConnector(s);return this.addWagmiConnector(i)}))}addWagmiConnectors(){const e=[];K.state.enableInjected!==!1&&e.push(Gv({shimDisconnect:!0}));const{features:n,remoteFeatures:r,projectId:s,enableAuthLogger:i}=K.state,o=r?.email??n?.email??!0,a=r?.socials??n?.socials,c=Array.isArray(a)&&a?.length>0;(o||c)&&e.push(x7({chains:this.wagmiChains,options:{projectId:s,enableAuthLogger:i}})),e.forEach(l=>{this.configureInternalConnector(l)})}configureInternalConnector(e){const n=this.wagmiConfig._internal.connectors.setup(e);return this.wagmiConfig._internal.connectors.setState(r=>[...r,n]),n}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:this.toChecksummedAddress(e),chainId:n,connector:{id:r.id,name:pn.ConnectorNamesMap[r.id]??r.name,imageId:pn.ConnectorImageIds[r.id],type:pn.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===$.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async writeSolanaTransaction(){return Promise.resolve({hash:""})}async signMessage(e){try{return{signature:await Yv(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:n,address:r}=Ju(this.wagmiConfig),s=this.wagmiChains?.find(a=>a.id===n),i={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chain:s,type:"legacy",parameters:["nonce"]};await Zv(this.wagmiConfig,i);const o=await Jv(this.wagmiConfig,i);return await Xv(this.wagmiConfig,{hash:o,timeout:25e3}),{hash:o}}async writeContract(e){const{caipNetwork:n,...r}=e,s=Number(Ka.caipNetworkIdToNumber(n.caipNetworkId)),i=this.wagmiChains?.find(a=>a.id===s);return{hash:await Qv(this.wagmiConfig,{chain:i,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await e_(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return t_(e.value,e.decimals)}formatUnits(e){return kf(e.value,e.decimals)}async addWagmiConnector(e){if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");const{enableEIP6963:n}=K.state||{};if(e.type===$.CONNECTOR_ID.INJECTED&&n===!1||e.id===$.CONNECTOR_ID.AUTH||e.id===$.CONNECTOR_ID.WALLET_CONNECT)return;let r;e.id!==$.CONNECTOR_ID.BASE_ACCOUNT&&(r=await e.getProvider().catch(()=>{}));const s=Vn.state.connectorImages;this.addConnector({id:e.id,explorerId:pn.ConnectorExplorerIds[e.id]??pn.ConnectorExplorerIds[e.name],imageUrl:s?.[e.id]??e.icon,name:pn.ConnectorNamesMap[e.id]??e.name,imageId:pn.ConnectorImageIds[e.id],type:pn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===$.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(){n_(this.wagmiConfig,{onChange:e=>{e.forEach(n=>this.addWagmiConnector(n))}}),this.addWagmiConnectors(),await Promise.all(this.wagmiConfig.connectors.map(e=>this.addWagmiConnector(e))),await this.addThirdPartyConnectors()}async syncConnections(){const e=this.connectors.filter(n=>{const{hasDisconnected:r,hasConnected:s}=ps.getConnectorStorageInfo(n.id,this.namespace);return!r&&s}).map(n=>this.getWagmiConnector(n.id)).filter(Boolean);await Xu(this.wagmiConfig,{connectors:e})}async syncConnection(e){const{id:n,chainId:r}=e,i=As(this.wagmiConfig).find(l=>l.connector.id===n),a=await this.getWagmiConnector(n)?.getProvider();if(se.isSafeApp()&&n===$.CONNECTOR_ID.SAFE&&!i?.accounts.length){const l=this.getWagmiConnector("safe");if(l){const u=await Qu(this.wagmiConfig,{connector:l,chainId:Number(r)}),d=await l.getProvider();return{chainId:Number(r),address:this.toChecksummedAddress(u.accounts[0]),provider:d,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}}return{chainId:Number(i?.chainId),address:this.toChecksummedAddress(i?.accounts[0]),provider:a,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}async connectWalletConnect(e){try{const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await Qu(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await qp(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}catch(n){throw n instanceof Ra?new Co(n):br.isUserRejectedRequestError(n)?new Co(n):n}}async connect(e){try{const{id:n,address:r,provider:s,type:i,info:o,chainId:a,socialUri:c}=e,l=this.getWagmiConnector(n);if(!l)throw new Error("connectionControllerClient:connectExternal - connector is undefined");s&&o&&l.id===$.CONNECTOR_ID.EIP6963&&l.setEip6963Wallet?.({provider:s,info:o});const u=this.wagmiConfig.state?.connections?.get(l.uid);if(u){await this.wagmiConfig.storage?.setItem("recentConnectorId",l.id);const p=[...u.accounts].sort((m,w)=>ps.isLowerCaseMatch(m,r)?-1:ps.isLowerCaseMatch(w,r)?1:0);return this.wagmiConfig?.setState(m=>({...m,connections:new Map(m.connections).set(l.uid,{accounts:p,chainId:u.chainId,connector:u.connector}),current:l.uid,status:"connected"})),{address:this.toChecksummedAddress(p[0]),chainId:u.chainId,provider:s,type:i,id:n}}const d=await Qu(this.wagmiConfig,{connector:l,chainId:a?Number(a):void 0,socialUri:c}),h=s??await l.getProvider();return{address:this.toChecksummedAddress(d.accounts[0]),chainId:d.chainId,provider:h,type:i,id:n}}catch(n){throw n instanceof Ra?new Co(n):br.isUserRejectedRequestError(n)?new Co(n):n}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:this.toChecksummedAddress(n)})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await Xu(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=J.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{try{const c=Number(e.chainId),l=await r_(this.wagmiConfig,{address:e.address,chainId:c,token:e.tokens?.[r.caipNetworkId]?.address});J.updateNativeBalanceCache({caipAddress:s,balance:l.formatted,symbol:l.symbol,timestamp:Date.now()}),a({balance:l.formatted,symbol:l.symbol})}catch(c){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",c),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){return this.getWagmiConnector("walletConnect")?.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=As(this.wagmiConfig).find(i=>ps.isLowerCaseMatch(i.connector.id,e.id));return await zp(this.wagmiConfig,{connector:n}),K.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:this.toChecksummedAddress(i)})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=As(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await zp(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:this.toChecksummedAddress(s)})),connectorId:r.connector.id}))}}async switchNetwork(e){const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(p=>p.id.toString()===n.id.toString());if(!r)throw new Error("connectionControllerClient:switchNetwork - wagmiChain is undefined");const{name:s,nativeCurrency:i,rpcUrls:o,blockExplorers:a,id:c}=r,l=n.rpcUrls?.chainDefault?.http?.[0]??o.default.http[0]??"",u=a?.default.url??n.blockExplorers?.default?.url??"",d=i??n.nativeCurrency,h=s??n.name;await qp(this.wagmiConfig,{chainId:c,addEthereumChainParameter:{chainName:h,nativeCurrency:d,rpcUrls:[l],blockExplorerUrls:[u]}}),await super.switchNetwork(e)}async getCapabilities(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=As(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=As(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=As(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=As(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:$.CONNECTOR_ID.AUTH,type:"AUTH",name:$.CONNECTOR_NAMES.AUTH,provider:e,imageId:pn.ConnectorImageIds[$.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){e.on("connect",()=>{const r=As(this.wagmiConfig),s=this.getWagmiConnector("walletConnect");if(s&&!r.find(i=>i.connector.id===s.id)){if(v.state.activeChain==="eip155")return;Xu(this.wagmiConfig,{connectors:[s]})}});const n=Mp({universalProvider:e});return this.configureInternalConnector(n),this.addConnector(new Ev({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}toChecksummedAddress(e){return s_(e.toLowerCase())}}export{N0 as $,Gl as A,Ga as B,v as C,$t as D,wi as E,Le as F,Fa as G,Nh as H,Vn as I,Ne as J,bt as K,$7 as L,$e as M,B7 as N,K as O,Dj as P,Su as Q,he as R,pt as S,Tn as T,Vw as U,Fi as V,yt as W,br as X,Pj as Y,Fj as Z,Rn as _,Hj as a,it as a0,Q_ as a1,Lt as a2,Ac as a3,ps as a4,H7 as a5,It as a6,xt as a7,tt as a8,S7 as a9,Kw as aA,Yp as aB,Rj as aC,gn as aD,Yl as aE,Zs as aF,Fr as aG,MI as aH,qj as aI,zj as aJ,nW as aK,Yj as aL,Ka as aM,hs as aN,_e as aO,Kj as aa,Vj as ab,Qj as ac,Zj as ad,Gj as ae,tW as af,Jj as ag,I7 as ah,eW as ai,Xj as aj,j0 as ak,HT as al,qT as am,Og as an,i_ as ao,za as ap,C_ as aq,E_ as ar,U7 as as,Va as at,Av as au,xf as av,qt as aw,Lj as ax,Ho as ay,Al as az,Bj as b,Mj as c,Ks as d,Wj as e,se as f,zt as g,Kn as h,$l as i,te as j,re as k,be as l,Ce as m,lr as n,xe as o,mn as p,$ as q,jj as r,de as s,Pe as t,pI as u,s7 as v,Et as w,kj as x,J as y,mt as z};
